/* SCEditor v1.5.4 | (C) 2017, Sam Clarke | sceditor.com/license */

!function(n){var o={};function i(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=7)}([function(e,t){e.exports=jQuery},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";var o=/^(https?|s?ftp|mailto|spotify|skype|ssh|teamspeak|tel):|(\/\/)|data:image\/(png|bmp|gif|p?jpe?g);/i;t.regex=function(e){return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},t.entities=function(e,t){if(!e)return e;var n={"&":"&amp;","<":"&lt;",">":"&gt;","  ":"&nbsp; ","\r\n":"<br />","\r":"<br />","\n":"<br />"};return!1!==t&&(n['"']="&#34;",n["'"]="&#39;",n["`"]="&#96;"),e.replace(/ {2}|\r\n|[&<>\r\n'"`]/g,function(e){return n[e]||e})},t.uriScheme=function(e){var t,n=window.location;return e&&/^[^\/]*:/i.test(e)&&!o.test(e)?((t=n.pathname.split("/")).pop(),n.protocol+"//"+n.host+t.join("/")+"/"+e):e}}.call(t,n,t,e))||(e.exports=o)},function(e,t,s){var n;void 0===(n=function(e,t){"use strict";var n,o,i,r=s(0),a=navigator.userAgent;t.ie=function(){for(var e=3,t=document,n=t.createElement("div"),o=n.getElementsByTagName("i");n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",o[0];);return t.documentMode&&t.all&&window.atob&&(e=10),4===e&&t.documentMode&&(e=11),4<e?e:void 0}(),t.edge="-ms-ime-align"in document.documentElement.style,t.ios=/iPhone|iPod|iPad| wosbrowser\//i.test(a),t.isWysiwygSupported=void 0!==(i=r('<p contenteditable="true">')[0].contentEditable)&&"inherit"!==i&&(o=/Opera Mobi|Opera Mini/i.test(a),/Android/i.test(a)&&(o=!0,/Safari/.test(a)&&(o=!(n=/Safari\/(\d+)/.exec(a))||!n[1]||n[1]<534)),/ Silk\//i.test(a)&&(o=!(n=/AppleWebKit\/(\d+)/.exec(a))||!n[1]||n[1]<534),t.ios&&(o=/OS [0-4](_\d)+ like Mac/i.test(a)),/Firefox/i.test(a)&&(o=!1),/OneBrowser/i.test(a)&&(o=!1),"UCWEB"===navigator.vendor&&(o=!1),t.ie<9&&(o=!0),!o)}.call(t,s,t,e))||(e.exports=n)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var p=n(0),a={},h={traverse:function(e,t,n,o,i){if(e)for(e=i?e.lastChild:e.firstChild;e;){var r=i?e.previousSibling:e.nextSibling;if(!n&&!1===t(e)||!o&&!1===h.traverse(e,t,n,o,i)||n&&!1===t(e))return!1;e=r}},rTraverse:function(e,t,n,o){this.traverse(e,t,n,o,!0)},parseHTML:function(e,t){var n=[],o=(t||document).createElement("div");return o.innerHTML=e,p.merge(n,o.childNodes),n},hasStyling:function(e){var t=p(e);return e&&(!t.is("p,div")||e.className||t.attr("style")||!p.isEmptyObject(t.data()))},convertElement:function(e,t){for(var n,o,i=e.attributes,r=i.length,a=e.ownerDocument.createElement(t);r--;){o=i[r];try{a.setAttribute(o.name,o.value)}catch(e){}}for(;n=e.firstChild;)a.appendChild(n);return e.parentNode.replaceChild(a,e),a},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",canHaveChildren:function(e){return!!/11?|9/.test(e.nodeType)&&"|iframe|area|base|basefont|br|col|frame|hr|img|input|wbr|isindex|link|meta|param|command|embed|keygen|source|track|object|".indexOf("|"+e.nodeName.toLowerCase()+"|")<0},isInline:function(e,t){var n,o=(e||{}).nodeType||3;return 1!==o?3===o:"code"===(n=e.tagName.toLowerCase())?!t:h.blockLevelList.indexOf("|"+n+"|")<0},copyCSS:function(e,t){t.style.cssText=e.style.cssText+t.style.cssText},fixNesting:function(e){h.traverse(e,function(e){var t=!h.isInline(e,!0),n=p(e);if(t&&h.isInline(e.parentNode,!0)){var o=function(e){for(;h.isInline(e.parentNode,!0);)e=e.parentNode;return e}(e),i=o.parentNode,r=h.extractContents(o,e),a=e;h.copyCSS(o,a),i.insertBefore(r,o),i.insertBefore(a,o)}if(t&&n.is("ul,ol")&&n.parent().is("ul,ol")){var s=n.prev("li");s.length?s.append(n):n.wrap("<li />")}})},findCommonAncestor:function(e,t){return p(e).parents().has(p(t)).first()},getSibling:function(e,t){return e?(t?e.previousSibling:e.nextSibling)||h.getSibling(e.parentNode,t):null},removeWhiteSpace:function(e,t){for(var n,o,i,r,a,s,l,c,u=h.getSibling,d=h.isInline,f=e.firstChild;f;){if(l=f.nextSibling,n=f.nodeValue,1===(o=f.nodeType)&&f.firstChild&&(s=p(f).css("whiteSpace"),/pre(\-wrap)?$/i.test(s)||h.removeWhiteSpace(f,/line$/i.test(s))),3===o){for(i=u(f),r=u(f,!0),c=!1;p(r).hasClass("sceditor-ignore");)r=u(r,!0);if(d(f)&&r){for(a=r;a.lastChild;)a=a.lastChild;c=3===a.nodeType?/[\t\n\r ]$/.test(a.nodeValue):!d(a)}n=n.replace(/\u200B/g,""),r&&d(r)&&!c||(n=n.replace(t?/^[\t ]+/:/^[\t\n\r ]+/,"")),i&&d(i)||(n=n.replace(t?/[\t ]+$/:/[\t\n\r ]+$/,"")),n.length?f.nodeValue=n.replace(t?/[\t ]+/g:/[\t\n\r ]+/g," "):e.removeChild(f)}f=l}},extractContents:function(o,i){var r,e=h.findCommonAncestor(o,i).get(0),a=!1,s=!1;return(r=function(e){var t,n=o.ownerDocument.createDocumentFragment();return h.traverse(e,function(e){if(s||e===i)return!(s=!0);e===o&&(a=!0),p.contains(e,o)||a&&p.contains(e,i)?((t=e.cloneNode(!1)).appendChild(r(e)),n.appendChild(t)):a&&!p.contains(n,e)&&n.appendChild(e)},!1),n})(e)},getOffset:function(e){for(var t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}},getStyle:function(e,t){var n,o,i,r=e.style;if(!r)return"";if(a[t]||(a[t]=p.camelCase(t)),i=r[t=a[t]],"textAlign"===t){if(n=p(e),o=r.direction,i=i||n.css(t),n.parent().css(t)===i||"block"!==n.css("display")||n.is("hr")||n.is("th"))return"";if(/right/i.test(i)&&"rtl"===o||/left/i.test(i)&&"ltr"===o)return""}return i},hasStyle:function(e,t,n){var o=h.getStyle(e,t);return!!o&&(!n||o===n||p.isArray(n)&&-1<p.inArray(o,n))}};return h}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){"use strict";var l={},e=function(r){var i=this,a=[],s=function(e){return"signal"+e.charAt(0).toUpperCase()+e.slice(1)},e=function(e,t){e=[].slice.call(e);var n,o,i=s(e.shift());for(n=0;n<a.length;n++)if(i in a[n]&&(o=a[n][i].apply(r,e),t))return o};i.call=function(){e(arguments,!1)},i.callOnlyFirst=function(){return e(arguments,!0)},i.hasHandler=function(e){var t=a.length;for(e=s(e);t--;)if(e in a[t])return!0;return!1},i.exists=function(e){return e in l&&"function"==typeof(e=l[e])&&"object"==typeof e.prototype},i.isRegistered=function(e){if(i.exists(e))for(var t=a.length;t--;)if(a[t]instanceof l[e])return!0;return!1},i.register=function(e){return!(!i.exists(e)||i.isRegistered(e)||(e=new l[e],a.push(e),"init"in e&&e.init.call(r),0))},i.deregister=function(e){var t,n=a.length,o=!1;if(!i.isRegistered(e))return o;for(;n--;)a[n]instanceof l[e]&&(o=!0,"destroy"in(t=a.splice(n,1)[0])&&t.destroy.call(r));return o},i.destroy=function(){for(var e=a.length;e--;)"destroy"in a[e]&&a[e].destroy.call(r);a=[],r=null}};return e.plugins=l,e}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var d=n(0),f=n(3),b=n(1),t=n(2).ie,p=t&&t<11,h=function(e,t,n){var o,i,r,a,s,l="",c=e.startContainer,u=e.startOffset;for(c&&3!==c.nodeType&&(c=c.childNodes[u],u=0),r=a=u;n>l.length&&c&&3===c.nodeType;)o=c.nodeValue,i=n-l.length,s&&(a=o.length,r=0),s=c,c=t?(u=r=Math.max(a-i,0),l=o.substr(r,a-r)+l,s.previousSibling):(u=r+(a=Math.min(i,o.length)),l+=o.substr(r,a),s.nextSibling);return{node:s||c,offset:u,text:l}};return function(r,e){var s,a,l=e||r.contentDocument||r.document,c="sceditor-start-marker",u="sceditor-end-marker",v=this;v.insertHTML=function(e,t){var n,o;if(!v.selectedRange())return!1;for(t&&(e+=v.selectedHtml()+t),o=l.createElement("p"),n=l.createDocumentFragment(),o.innerHTML=e;o.firstChild;)n.appendChild(o.firstChild);v.insertNode(n)},a=function(e,t,n){var o,i,r=l.createElement("div"),a=d(r);if("string"==typeof e?(t&&(e+=v.selectedHtml()+t),a.html(e)):(a.append(e),t&&a.append(v.selectedRange().extractContents()).append(t)),o=r.lastChild){for(;!f.isInline(o.lastChild,!0);)o=o.lastChild;return f.canHaveChildren(o)&&(i=d(o),o.lastChild||i.append("​")),v.removeMarkers(),(i||a).append(s(c)).append(s(u)),n?a.html():d(l.createDocumentFragment()).append(a.contents())[0]}},v.insertNode=function(e,t){var n=a(e,t),o=v.selectedRange(),i=o.commonAncestorContainer;if(!n)return!1;o.deleteContents(),i&&3!==i.nodeType&&!f.canHaveChildren(i)?i.parentNode.insertBefore(n,i):o.insertNode(n),v.restoreRange()},v.cloneSelected=function(){var e=v.selectedRange();if(e)return e.cloneRange()},v.selectedRange=function(){var e,t,n=r.getSelection();if(n){if(n.getRangeAt&&n.rangeCount<=0){for(t=l.body;t.firstChild;)t=t.firstChild;(e=l.createRange()).setStartBefore(t),n.addRange(e)}return 0<n.rangeCount&&(e=n.getRangeAt(0)),e}},v.hasSelection=function(){var e=r.getSelection();return e&&0<e.rangeCount},v.selectedHtml=function(){var e,t=v.selectedRange();return t?((e=l.createElement("p")).appendChild(t.cloneContents()),e.innerHTML):""},v.parentNode=function(){var e=v.selectedRange();if(e)return e.parentElement?e.parentElement():e.commonAncestorContainer},v.getFirstBlockParent=function(e){var t=function(e){return f.isInline(e,!0)&&(e=e?e.parentNode:null)?t(e):e};return t(e||v.parentNode())},v.insertNodeAt=function(e,t){var n=v.selectedRange(),o=v.cloneSelected();if(!o)return!1;o.collapse(e),o.insertNode(t),v.selectRange(n)},s=function(e){v.removeMarker(e);var t=l.createElement("span");return t.id=e,t.style.lineHeight="0",t.style.display="none",t.className="sceditor-selection sceditor-ignore",t.innerHTML=" ",t},v.insertMarkers=function(){var e=v.selectedRange();v.insertNodeAt(!0,s(c)),e&&e.collapsed?d(v.getMarker(c)).after(s(u)):v.insertNodeAt(!1,s(u))},v.getMarker=function(e){return l.getElementById(e)},v.removeMarker=function(e){var t=v.getMarker(e);t&&t.parentNode.removeChild(t)},v.removeMarkers=function(){v.removeMarker(c),v.removeMarker(u)},v.saveRange=function(){v.insertMarkers()},v.selectRange=function(e){var t,n=r.getSelection(),o=e.endContainer;if(!p&&e.collapsed&&o&&!f.isInline(o,!0)){for(t=o.lastChild;t&&d(t).is(".sceditor-ignore");)t=t.previousSibling;if(d(t).is("br")){var i=l.createRange();i.setEndAfter(t),i.collapse(!1),v.compare(e,i)&&(e.setStartBefore(t),e.collapse(!0))}}n&&(v.clear(),n.addRange(e))},v.restoreRange=function(){var e,t=v.selectedRange(),n=v.getMarker(c),o=v.getMarker(u);if(!n||!o||!t)return!1;e=n.nextSibling===o,(t=l.createRange()).setStartBefore(n),t.setEndAfter(o),e&&t.collapse(!0),v.selectRange(t),v.removeMarkers()},v.selectOuterText=function(e,t){var n,o,i=v.cloneSelected();if(!i)return!1;i.collapse(!1),n=h(i,!0,e),o=h(i,!1,t),i.setStart(n.node,n.offset),i.setEnd(o.node,o.offset),v.selectRange(i)},v.getOuterText=function(e,t){var n=v.cloneSelected();return n?(n.collapse(!e),h(n,e,t).text):""},v.replaceKeyword=function(e,t,n,o,i,r){n||e.sort(function(e,t){return e[0].length-t[0].length});var a,s,l,c,u,d,f,p,h=e.length,m=i?1:0,g=o||e[h-1][0].length;for(i&&g++,r=r||"",u=(a=v.getOuterText(!0,g)).length,a+=r,t&&(a+=v.getOuterText(!1,g));h--;)if(p=(f=e[h][0]).length,c=Math.max(0,u-p-m),l=-1,i?(s=a.substr(c).match(new RegExp("(^|[\\s    ])"+b.regex(f)+"(^|[\\s    ])")))&&(l=s.index+c+s[1].length):l=a.indexOf(f,c),-1<l&&l<=u&&u<=l+p+m)return d=u-l,v.selectOuterText(d,p-d-(/^\S/.test(r)?1:0)),v.insertHTML(e[h][1]),!0;return!1},v.compare=function(e,t){return t||(t=v.selectedRange()),e&&t?0===e.compareBoundaryPoints(Range.END_TO_END,t)&&0===e.compareBoundaryPoints(Range.START_TO_START,t):!e&&!t},v.clear=function(){var e=r.getSelection();e&&(e.removeAllRanges?e.removeAllRanges():e.empty&&e.empty())}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var i=n(0),r={html:'<!DOCTYPE html><html{attrs}><head><style>.ie * {min-height: auto !important} .ie table td {height:15px} @supports (-ms-ime-align:auto) { * { min-height: auto !important; } }</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}><p></p></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" placeholder="https://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" placeholder="https://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" placeholder="https://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" frameborder="0" allowfullscreensrc="https://www.youtube.com/embed/{id}?wmode=opaque&start={time}" data-youtube-id="{id}"></iframe>'};return function(e,t,n){var o=r[e];return i.each(t,function(e,t){o=o.replace(new RegExp("\\{"+e+"\\}","g"),t)}),n&&(o=i(o)),o}}.call(t,n,t,e))||(e.exports=o)},function(e,t,o){var n;void 0===(n=function(e){"use strict";var i=o(0),r=o(8),t=o(4),a=o(2),n=o(1);(i.sceditor=r).commands=o(9),r.defaultOptions=o(10),r.RangeHelper=o(5),r.dom=o(3),r.ie=a.ie,r.ios=a.ios,r.isWysiwygSupported=a.isWysiwygSupported,r.regexEscape=n.regex,r.escapeEntities=n.entities,r.escapeUriScheme=n.uriScheme,r.PluginManager=t,r.plugins=t.plugins,i.fn.sceditor=function(e){var t,n,o=[];if((e=e||{}).runWithoutWysiwygSupport||a.isWysiwygSupported)return this.each(function(){t=this.jquery?this:i(this),n=t.data("sceditor"),0<t.parents(".sceditor-container").length||("state"===e?o.push(!!n):"instance"===e?o.push(n):n||new r(this,e))}),o.length?1===o.length?o[0]:i(o):this}}.call(t,o,t,e))||(e.exports=n)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var ye=n(0),xe=n(4),we=n(5),Ce=n(3),ke=n(1),Se=n(2),Ee=n(6),Te=window,De=document,Me=ye(Te),Be=ye(De),Re=Se.ie,He=Re&&Re<11,Ie=/^image\/(p?jpe?g|gif|png|bmp)$/i,Fe=function(e,y){var x,u,s,r,m,d,i,l,c,a,f,p,t,h,g,n,v,b,w,o,C,k,S,E,T,D,M,B,R,H,I,F,N,O,z,A,_,L,W,P,j,q,V,$,Q,U,Y,K,X,G,J,Z,ee,te,ne,oe,ie,re,ae,se,le,ce,ue,de=this,fe=e.get?e.get(0):e,pe=ye(fe),he=[],me=[],ge={},ve=[],be={};de.commands=ye.extend(!0,{},y.commands||Fe.commands),de.opts=y=ye.extend({},Fe.defaultOptions,y),de.opts.emoticons=y.emoticons||Fe.defaultOptions.emoticons,D=function(){pe.data("sceditor",de),ye.each(y,function(e,t){ye.isPlainObject(t)&&(y[e]=ye.extend(!0,{},t))}),y.locale&&"en"!==y.locale&&F(),x=ye('<div class="sceditor-container" />').insertAfter(pe).css("z-index",y.zIndex),Re&&x.addClass("ie ie"+Re),o=!!pe.attr("required"),pe.prop("required",!1),I(),_(),N(),H(!!y.startInSourceMode),O(),z(),Se.isWysiwygSupported||de.toggleSourceMode(),G();var e=function(){Me.off("load",e),y.autofocus&&ne(),ue(),Z(),K(),g.call("ready")};Me.on("load",e),De.readyState&&"complete"===De.readyState&&e()},I=function(){var e=y.plugins;e=e?e.toString().split(","):[],g=new xe(de),ye.each(e,function(e,t){g.register(ye.trim(t))})},F=function(){var e;(t=Fe.locale[y.locale])||(e=y.locale.split("-"),t=Fe.locale[e[0]]),t&&t.dateFormat&&(y.dateFormat=t.dateFormat)},H=function(e){var t;i=ye("<textarea></textarea>"),s=ye('<iframe frameborder="0" allowfullscreen="true"></iframe>'),e?(x.addClass("sourceMode"),s.hide()):(x.addClass("wysiwygMode"),i.hide()),y.spellcheck||i.attr("spellcheck","false"),"https:"===Te.location.protocol&&s.attr("src","javascript:false"),x.append(s).append(i),r=s[0],l=i[0],de.dimensions(y.width||pe.width(),y.height||pe.height()),(t=r.contentDocument).open(),t.write(Ee("html",{attrs:Re?' class="ie ie'+Re+'"':"",spellcheck:y.spellcheck?"":'spellcheck="false"',charset:y.charset,style:y.style})),t.close(),d=ye(t),m=ye(t.body),de.readOnly(!!y.readOnly),(Se.ios||Se.edge||Re)&&(m.height("100%"),Re||m.on("touchend",de.focus));var n=pe.attr("tabindex");i.attr("tabindex",n),s.attr("tabindex",n),h=new we(r.contentWindow),de.val(pe.hide().val());var o=y.placeholder||pe.attr("placeholder");o&&(i.placeholder=o,m.attr("placeholder",o))},O=function(){y.autoUpdate&&(m.on("blur",ce),i.on("blur",ce)),null===y.rtl&&(y.rtl="rtl"===i.css("direction")),de.rtl(!!y.rtl),y.autoExpand&&(m[0].addEventListener("load",ue,!0),d.on("input keyup",ue)),y.resizeEnabled&&A(),x.attr("id",y.id),de.emoticons(y.emoticonsEnabled)},z=function(){var e="onselectionchange"in d?"selectionchange":"keyup focus blur contextmenu mouseup touchend click";Be.click(Y),ye(fe.form).on("reset",V).submit(de.updateOriginal),Be.on("unload",de.updateOriginal),Me.on("resize orientationChanged",K),m.keypress(q).keydown(P).keydown(j).keyup(Z).blur(se).keyup(le).on("paste",L).on("compositionstart compositionend",Q).on(e,ee).on("keydown keyup keypress focus blur contextmenu",U),y.emoticonsCompat&&Te.getSelection&&m.keyup(ie),m.on("blur",function(){de.val()||m.addClass("placeholder")}),m.on("focus",function(){m.removeClass("placeholder")}),i.blur(se).keyup(le).keydown(P).on("compositionstart compositionend",Q).on("keydown keyup keypress focus blur contextmenu",U),d.mousedown($).on(e,ee).on("beforedeactivate keyup mouseup",R).keyup(Z).focus(function(){a=null}),x.on("selectionchanged",te).on("selectionchanged",G).on("selectionchanged valuechanged nodechanged",U)},N=function(){var r,a=de.commands,s=(y.toolbarExclude||"").split(","),e=y.toolbar.split("|");u=ye('<div class="sceditor-toolbar" unselectable="on" />'),ye.each(e,function(e,t){r=ye('<div class="sceditor-group" />'),ye.each(t.split(","),function(e,t){var n,o,i=a[t];!i||-1<ye.inArray(t,s)||(o=i.shortcut,(n=Ee("toolbarButton",{name:t,dispName:de._(i.name||i.tooltip||t)},!0)).data("sceditor-txtmode",!!i.txtExec).data("sceditor-wysiwygmode",!!i.exec).toggleClass("disabled",!i.exec).on("mousedown",function(e){var t=ye(this);return t.hasClass("disabled")||1!==e.which||B(t,i),G(),!1}),i.tooltip&&n.attr("title",de._(i.tooltip)+(o?" ("+o+")":"")),o&&de.addShortcut(o,t),i.state?me.push({name:t,state:i.state}):"string"==typeof i.exec&&me.push({name:t,state:i.exec}),r.append(n),be[t]=n)}),r[0].firstChild&&u.append(r)}),ye(y.toolbarContainer||x).append(u)},A=function(){var o,i,r,a,t,n,e=ye('<div class="sceditor-grip" />'),s=ye('<div class="sceditor-resize-cover" />'),l="touchcancel touchend mouseup",c=0,u=0,d=0,f=0,p=0,h=0,m=x.width(),g=x.height(),v=!1,b=de.rtl();o=y.resizeMinHeight||g/1.5,i=y.resizeMaxHeight||2.5*g,r=y.resizeMinWidth||m/1.25,a=y.resizeMaxWidth||1.25*m,t=function(e){f="touchmove"===e.type?(e=Te.event,d=e.changedTouches[0].pageX,e.changedTouches[0].pageY):(d=e.pageX,e.pageY);var t=h+(f-u),n=b?p-(d-c):p+(d-c);0<a&&a<n&&(n=a),0<r&&n<r&&(n=r),y.resizeWidth||(n=!1),0<i&&i<t&&(t=i),0<o&&t<o&&(t=o),y.resizeHeight||(t=!1),(n||t)&&(de.dimensions(n,t),Re<7&&x.height(t)),e.preventDefault()},n=function(e){v&&(v=!1,s.hide(),x.removeClass("resizing").height("auto"),Be.off("touchmove mousemove",t),Be.off(l,n),e.preventDefault())},x.append(e),x.append(s.hide()),e.on("touchstart mousedown",function(e){u="touchstart"===e.type?(e=Te.event,c=e.touches[0].pageX,e.touches[0].pageY):(c=e.pageX,e.pageY),p=x.width(),h=x.height(),v=!0,x.addClass("resizing"),s.show(),Be.on("touchmove mousemove",t),Be.on(l,n),Re<7&&x.height(h),e.preventDefault()})},_=function(){var o,i=y.emoticons,r=y.emoticonsRoot;ye.isPlainObject(i)&&y.emoticonsEnabled&&ye.each(i,function(n,e){ye.each(e,function(e,t){r&&(t={url:r+(t.url||t),tooltip:t.tooltip||e},i[n][e]=t),(o=De.createElement("img")).src=t.url||t,he.push(o)})})},ne=function(){var e,t,n=d[0],o=m[0],i=o.firstChild,r=!!y.autofocusEnd;if(x.is(":visible")){if(de.sourceMode())return t=r?l.value.length:0,void(l.setSelectionRange?l.setSelectionRange(t,t):((e=l.createTextRange()).moveEnd("character",t),e.collapse(!1),e.select()));if(Ce.removeWhiteSpace(o),r)for((i=o.lastChild)||(i=n.createElement("p"),m.append(i));i.lastChild;)i=i.lastChild,!He&&ye(i).is("br")&&i.previousSibling&&(i=i.previousSibling);n.createRange?(e=n.createRange(),Ce.canHaveChildren(i)?e.selectNodeContents(i):(e.setStartBefore(i),r&&e.setStartAfter(i))):(e=o.createTextRange()).moveToElementText(3!==i.nodeType?i:i.parentNode),e.collapse(!r),h.selectRange(e),b=e,r&&(d.scrollTop(o.scrollHeight),m.scrollTop(o.scrollHeight)),de.focus()}},de.readOnly=function(e){return"boolean"!=typeof e?"readonly"===i.attr("readonly"):(m[0].contentEditable=!e,e?i.attr("readonly","readonly"):i.prop("readonly",!1),X(e),de)},de.rtl=function(e){var t=e?"rtl":"ltr";return"boolean"!=typeof e?"rtl"===i.attr("dir"):(m.attr("dir",t),i.attr("dir",t),x.removeClass("rtl").removeClass("ltr").addClass(t),de)},X=function(n){var o=de.inSourceMode()?"txtmode":"wysiwygmode";ye.each(be,function(e,t){!0!==n&&t.data("sceditor-"+o)?t.removeClass("disabled"):t.addClass("disabled")})},de.width=function(e,t){return e||0===e?(de.dimensions(e,null,t),de):x.width()},de.dimensions=function(e,t,n){var o=Re<8||De.documentMode<8?2:0;return t=!(!t&&0!==t)&&t,!1===(e=!(!e&&0!==e)&&e)&&!1===t?{width:de.width(),height:de.height()}:(void 0===s.data("outerWidthOffset")&&de.updateStyleCache(),!1!==e&&(!1!==n&&(y.width=e),!1===t&&(t=x.height(),n=!1),x.width(e),e&&-1<e.toString().indexOf("%")&&(e=x.width()),s.width(e-s.data("outerWidthOffset")),i.width(e-i.data("outerWidthOffset")),Se.ios&&m&&m.width(e-s.data("outerWidthOffset")-(m.outerWidth(!0)-m.width()))),!1!==t&&(!1!==n&&(y.height=t),t&&-1<t.toString().indexOf("%")&&(t=x.height(t).height(),x.height("auto")),t-=y.toolbarContainer?0:u.outerHeight(!0),s.height(t-s.data("outerHeightOffset")),i.height(t-o-i.data("outerHeightOffset"))),de)},de.updateStyleCache=function(){s.data("outerWidthOffset",s.outerWidth(!0)-s.width()),i.data("outerWidthOffset",i.outerWidth(!0)-i.width()),s.data("outerHeightOffset",s.outerHeight(!0)-s.height()),i.data("outerHeightOffset",i.outerHeight(!0)-i.height())},de.height=function(e,t){return e||0===e?(de.dimensions(null,e,t),de):x.height()},de.maximize=function(e){return void 0===e?x.is(".sceditor-maximize"):((e=!!e)&&(E=Me.scrollTop()),ye("html, body").toggleClass("sceditor-maximize",e),x.toggleClass("sceditor-maximize",e),de.width(e?"100%":y.width,!1),de.height(e?"100%":y.height,!1),e||Me.scrollTop(E),ue(),de)},ue=function(){y.autoExpand&&!S&&setTimeout(de.expandToContent,200)},de.expandToContent=function(e){if(!de.maximize()){if(S=!1,!k){var t=y.resizeMinHeight||y.height||pe.height();k={min:t,max:y.resizeMaxHeight||2*t}}var n=document.createRange();n.selectNodeContents(m[0]);var o=n.getBoundingClientRect(),i=d[0].documentElement.clientHeight,r=o.bottom-o.top,a=de.height()+(r-i);e||-1===k.max||(a=Math.min(a,k.max)),de.height(Math.ceil(Math.max(a,k.min)))}},de.destroy=function(){g&&(g.destroy(),g=a=h=null,c&&c.off().remove(),Be.off("click",Y),Me.off("resize orientationChanged",K),ye(fe.form).off("reset",V).off("submit",de.updateOriginal),Be.off("unload",de.updateOriginal),m.off(),d.off().find("*").remove(),i.off().remove(),u.remove(),x.off().find("*").off().remove(),x.remove(),pe.removeData("sceditor").removeData("sceditorbbcode").show(),o&&pe.attr("required","required"))},de.createDropDown=function(e,t,n,o){var i,r="sceditor-"+t,a=c&&c.is("."+r);de.closeDropDown(!0),a||(!1!==o&&ye(n).find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"),i={top:e.offset().top,left:e.offset().left,marginTop:e.outerHeight()},ye.extend(i,y.dropDownCss),c=ye('<div class="sceditor-dropdown '+r+'" />').css(i).append(n).appendTo(ye("body")).on("click focusin",function(e){e.stopPropagation()}),setTimeout(function(){c&&c.find("input,textarea").first().focus()}))},Y=function(e){3!==e.which&&c&&(ce(),void 0===ye(e.target).parent().data("sceditorCommand")&&de.closeDropDown())},L=function(e){var t,n,o=Re||Se.edge,i=m[0],r=e.originalEvent.clipboardData;if(r&&!o){var a={},s=r.types,l=r.items;e.preventDefault();for(var c=0;c<s.length;c++){if(window.FileReader&&l&&Ie.test(l[c].type))return t=r.items[c].getAsFile(),n=void 0,(n=new FileReader).onload=function(e){W({html:'<img src="'+e.target.result+'" />'})},void n.readAsDataURL(t);a[s[c]]=r.getData(s[c])}a.text=a["text/plain"],a.html=ke.entities(a["text/html"]),W(a)}else if(!T){var u=i.scrollTop;for(h.saveRange(),T=document.createDocumentFragment();i.firstChild;)T.appendChild(i.firstChild);setTimeout(function(){var e=i.innerHTML;i.innerHTML="",i.appendChild(T),i.scrollTop=u,T=!1,h.restoreRange(),W({html:ke.entities(e)})},0)}},W=function(e){var t=d[0].createElement("div");g.call("pasteRaw",e),e.html?(t.innerHTML=ke.entities(e.html),Ce.fixNesting(t)):t.innerHTML=ke.entities(e.text||"");var n={val:t.innerHTML};g.hasHandler("toSource")&&(m.append(t),n.val=g.callOnlyFirst("toSource",n.val,ye(t)),ye(t).remove()),g.call("paste",n),g.hasHandler("toWysiwyg")&&(n.val=g.callOnlyFirst("toWysiwyg",n.val,!0)),g.call("pasteHtml",n),de.wysiwygEditorInsertHtml(n.val,null,!0)},de.closeDropDown=function(e){c&&(c.off().remove(),c=null),!0===e&&de.focus()},de.wysiwygEditorInsertHtml=function(e,t,n){var o,i,r,a=s.height();de.focus(),(n||!ye(v).is("code")&&0===ye(v).parents("code").length)&&(h.insertHTML(e,t),h.saveRange(),M(m[0]),o=m.find("#sceditor-end-marker").show(),i=m.scrollTop()||d.scrollTop(),r=Ce.getOffset(o[0]).top+1.5*o.outerHeight(!0)-a,o.hide(),(i<r||r+a<i)&&(m.scrollTop(r),d.scrollTop(r)),ae(!1),h.restoreRange(),Z())},de.wysiwygEditorInsertText=function(e,t){de.wysiwygEditorInsertHtml(ke.entities(e),ke.entities(t))},de.insertText=function(e,t){return de.inSourceMode()?de.sourceEditorInsertText(e,t):de.wysiwygEditorInsertText(e,t),de},de.sourceEditorInsertText=function(e,t){var n,o,i,r=l.selectionStart,a=l.selectionEnd;o=l.scrollTop,l.focus(),void 0!==r?(i=l.value,t&&(e+=i.substring(r,a)+t),l.value=i.substring(0,r)+e+i.substring(a,i.length),l.selectionStart=r+e.length-(t?t.length:0),l.selectionEnd=l.selectionStart):(n=De.selection.createRange(),t&&(e+=n.text+t),n.text=e,t&&n.moveEnd("character",0-t.length),n.moveStart("character",n.End-n.Start),n.select()),l.scrollTop=o,l.focus(),ae()},de.getRangeHelper=function(){return h},de.sourceEditorCaret=function(e){var t={};return l.focus(),e?(l.selectionStart=e.start,l.selectionEnd=e.end):(t.start=l.selectionStart,t.end=l.selectionEnd),e?this:t},de.val=function(e,t){return"string"!=typeof e?de.inSourceMode()?de.getSourceEditorValue(!1):de.getWysiwygEditorValue(t):(de.inSourceMode()?de.setSourceEditorValue(e):(!1!==t&&g.hasHandler("toWysiwyg")&&(e=g.callOnlyFirst("toWysiwyg",e)),de.setWysiwygEditorValue(e)),de)},de.insert=function(e,t,n,o,i){if(de.inSourceMode())return de.sourceEditorInsertText(e,t),de;if(t){var r=h.selectedHtml(),a=ye("<div>").appendTo(ye("body")).hide().html(r);!1!==n&&g.hasHandler("toSource")&&(r=g.callOnlyFirst("toSource",r,a)),a.remove(),e+=r+t}return!1!==n&&g.hasHandler("toWysiwyg")&&(e=g.callOnlyFirst("toWysiwyg",e,!0)),!1!==n&&!0===i&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),de.wysiwygEditorInsertHtml(e),de},de.getWysiwygEditorValue=function(e){var t,n=ye("<div>",d[0]).append(ye(m[0].childNodes).clone()).appendTo(m);return Ce.fixNesting(n[0]),t=n.html(),!1!==e&&g.hasHandler("toSource")&&(t=g.callOnlyFirst("toSource",t,n)),n.remove(),t},de.getBody=function(){return m},de.getContentAreaContainer=function(){return s},de.getSourceEditorValue=function(e){var t=i.val();return!1!==e&&g.hasHandler("toWysiwyg")&&(t=g.callOnlyFirst("toWysiwyg",t)),t},de.setWysiwygEditorValue=function(e){e||(e="<p>"+(Re?"":"<br />")+"</p>"),m[0].innerHTML=e,M(m[0]),Z(),ae(),ue()},de.setSourceEditorValue=function(e){i.val(e),ae()},de.updateOriginal=function(){pe.val(de.val())},M=function(e){if(y.emoticonsEnabled&&!ye(e).parents("code").length){var u=e.ownerDocument,d=[],f={},p=ye.extend({},y.emoticons.more,y.emoticons.dropdown,y.emoticons.hidden);ye.each(p,function(e){y.emoticonsCompat&&(f[e]=new RegExp("(>|^|\\s| | | | |&nbsp;)"+ke.regex(e)+"($|<|\\s| | | | |&nbsp;)")),d.push(e)}),d.sort(function(e,t){return e.length-t.length});var h=function(e){for(e=e.firstChild;e;){var t,n,o,i,r,a,s,l=e.parentNode,c=e.nodeValue;if(3!==e.nodeType)ye(e).is("code")||h(e);else if(c)for(r=d.length;r--;)n=d[r],-1<(s=y.emoticonsCompat?c.search(f[n]):c.indexOf(n))&&(a=e.nextSibling,o=p[n],t=c.substr(s).split(n),c=c.substr(0,s)+t.shift(),e.nodeValue=c,i=Ce.parseHTML(Ee("emoticon",{key:n,url:o.url||o,tooltip:o.tooltip||n}),u),l.insertBefore(i[0],a),l.insertBefore(u.createTextNode(t.join(n)),a));e=e.nextSibling}};h(e),y.emoticonsCompat&&(ve=m.find("img[data-sceditor-emoticon]"))}},de.inSourceMode=function(){return x.hasClass("sourceMode")},de.sourceMode=function(e){var t=de.inSourceMode();return"boolean"!=typeof e?t:((t&&!e||!t&&e)&&de.toggleSourceMode(),de)},de.toggleSourceMode=function(){var e=de.inSourceMode();!Se.isWysiwygSupported&&e||(e||(h.saveRange(),h.clear()),de.blur(),e?de.setWysiwygEditorValue(de.getSourceEditorValue()):de.setSourceEditorValue(de.getWysiwygEditorValue()),a=null,i.toggle(),s.toggle(),x.toggleClass("wysiwygMode",e).toggleClass("sourceMode",!e),X(),G())},J=function(){return l.focus(),void 0!==l.selectionStart?l.value.substring(l.selectionStart,l.selectionEnd):De.selection.createRange().text},B=function(e,t){de.inSourceMode()?t.txtExec&&(ye.isArray(t.txtExec)?de.sourceEditorInsertText.apply(de,t.txtExec):t.txtExec.call(de,e,J())):t.exec&&(ye.isFunction(t.exec)?t.exec.call(de,e):de.execCommand(t.exec,t.hasOwnProperty("execParam")?t.execParam:null))},R=function(){Re&&(a=h.selectedRange())},de.execCommand=function(e,t){var n=!1,o=de.commands[e],i=ye(h.parentNode());if(de.focus(),!i.is("code")&&0===i.parents("code").length){try{n=d[0].execCommand(e,!1,t)}catch(e){}!n&&o&&o.errorMessage&&alert(de._(o.errorMessage)),G()}},ee=function(){function e(){if(h&&!h.compare(b)){if((b=h.cloneSelected())&&b.collapsed){var e=b.startContainer,t=b.startOffset;for(t&&3!==e.nodeType&&(e=e.childNodes[t]);e&&e.parentNode!==m;)e=e.parentNode;e&&Ce.isInline(e,!0)&&(h.saveRange(),n=m,o=d,Ce.traverse(n,function(e){Ce.isInline(e,!0)?(i||(i=o[0].createElement("p"),e.insertBefore(i)),3===e.nodeType&&""===e.nodeValue||e.appendChild(i)):i=null},!1,!0),h.restoreRange())}x.trigger(ye.Event("selectionchanged"))}var n,o,i;w=!1}w||(w=!0,"onselectionchange"in d?e():setTimeout(e,100))},te=function(){var e,t=h.parentNode();n!==t&&(e=n,n=t,v=h.getFirstBlockParent(t),x.trigger(ye.Event("nodechanged",{oldNode:e,newNode:n})))},de.currentNode=function(){return n},de.currentBlockNode=function(){return v},G=function(e){var t,n,o=d[0],i=de.sourceMode();if(de.readOnly())u.find("active").removeClass("active");else{i||(n=e?e.newNode:h.parentNode(),t=h.getFirstBlockParent(n));for(var r=0;r<me.length;r++){var a=0,s=be[me[r].name],l=me[r].state,c=i&&!s.data("sceditor-txtmode")||!i&&!s.data("sceditor-wysiwygmode");if("string"==typeof l){if(!i)try{-1<(a=o.queryCommandEnabled(l)?0:-1)&&(a=o.queryCommandState(l)?1:0)}catch(e){}}else c||(a=l.call(de,n,t));s.toggleClass("disabled",c||a<0).toggleClass("active",0<a)}}},q=function(e){if(!e.originalEvent.defaultPrevented&&(de.closeDropDown(),13===e.which)){var t=ye(v);if(t.length&&!t.is("li,ul,ol")){a=null;var n=d[0].createElement("br");if(h.insertNode(n),!He){var o=n.parentNode,i=o.lastChild;i&&3===i.nodeType&&""===i.nodeValue&&(o.removeChild(i),i=o.lastChild),!Ce.isInline(o,!0)&&i===n&&Ce.isInline(n.previousSibling)&&h.insertHTML("<br>")}e.preventDefault()}}},Z=function(){var n,o=m[0];Ce.rTraverse(o,function(e){if(n=e.nodeName.toLowerCase(),1===e.nodeType&&!/inline/.test(Ce.getStyle(e,"display"))&&ye(e).hasClass("sceditor-nlf")&&Ce.hasStyling(e)){var t=d[0].createElement("p");return t.className="sceditor-nlf",t.innerHTML=He?"":"<br />",o.appendChild(t),!1}if(3===e.nodeType&&!/^\s*$/.test(e.nodeValue)||"br"===n)return!1})},V=function(){de.val(pe.val())},$=function(){de.closeDropDown(),a=null},K=function(){var e=y.height,t=y.width;de.maximize()?de.dimensions("100%","100%",!1):(e&&-1<e.toString().indexOf("%")||t&&-1<t.toString().indexOf("%"))&&de.dimensions(t,e)},de._=function(){var n=arguments;return t&&t[n[0]]&&(n[0]=t[n[0]]),n[0].replace(/\{(\d+)\}/g,function(e,t){return void 0!==n[t-0+1]?n[t-0+1]:"{"+t+"}"})},U=function(e){g.call(e.type+"Event",e,de);var t=e.target===l?"scesrc":"scewys",n=ye.Event(e);n.type=t+e.type,x.trigger(n,de)},de.bind=function(e,t,n,o){for(var i=(e=e.split(" ")).length;i--;)ye.isFunction(t)&&(n||x.on("scewys"+e[i],t),o||x.on("scesrc"+e[i],t),"valuechanged"===e[i]&&(ae.hasHandler=!0));return de},de.unbind=function(e,t,n,o){for(var i=(e=e.split(" ")).length;i--;)ye.isFunction(t)&&(n||x.off("scewys"+e[i],t),o||x.off("scesrc"+e[i],t));return de},de.blur=function(e,t,n){return ye.isFunction(e)?de.bind("blur",e,t,n):de.sourceMode()?i.blur():m.blur(),de},de.focus=function(e,t,n){if(ye.isFunction(e))de.bind("focus",e,t,n);else if(de.inSourceMode())l.focus();else{var o,i=h.selectedRange();b||ne(),!He&&i&&1===i.endOffset&&i.collapsed&&(o=i.endContainer)&&1===o.childNodes.length&&ye(o.firstChild).is("br")&&(i.setStartBefore(o.firstChild),i.collapse(!0),h.selectRange(i)),r.contentWindow.focus(),m[0].focus(),a&&(h.selectRange(a),a=null)}return G(),de},de.keyDown=function(e,t,n){return de.bind("keydown",e,t,n)},de.keyPress=function(e,t,n){return de.bind("keypress",e,t,n)},de.keyUp=function(e,t,n){return de.bind("keyup",e,t,n)},de.nodeChanged=function(e){return de.bind("nodechanged",e,!1,!0)},de.selectionChanged=function(e){return de.bind("selectionchanged",e,!1,!0)},de.valueChanged=function(e,t,n){return de.bind("valuechanged",e,t,n)},oe=function(e){var t,n=0,o=de.emoticonsCache,i=String.fromCharCode(e.which);if(!ye(v).is("code")&&!ye(v).parents("code").length)return o||(o=[],ye.each(ye.extend({},y.emoticons.more,y.emoticons.dropdown,y.emoticons.hidden),function(e,t){o[n++]=[e,Ee("emoticon",{key:e,url:t.url||t,tooltip:t.tooltip||e})]}),o.sort(function(e,t){return e[0].length-t[0].length}),de.emoticonsCache=o,de.longestEmoticonCode=o[o.length-1][0].length),(t=h.replaceKeyword(de.emoticonsCache,!0,!0,de.longestEmoticonCode,y.emoticonsCompat,i))&&y.emoticonsCompat?(ve=m.find("img[data-sceditor-emoticon]"),/^\s$/.test(i)):!t},ie=function(){if(ve.length){var t,n,o,i,r,a,s=de.currentBlockNode(),l=!1,c=/[^\s\xA0\u2002\u2003\u2009\u00a0]+/;ve=ye.map(ve,function(e){return e&&e.parentNode?ye.contains(s,e)?(t=e.previousSibling,n=e.nextSibling,null===(r=t?t.nodeValue:null)&&(r=t&&t.innerText||""),t&&c.test(t.nodeValue.slice(-1))||n&&c.test((n.nodeValue||"")[0])?(o=e.parentNode,i=h.cloneSelected(),a=i.startContainer,r+=ye(e).data("sceditor-emoticon"),a===n?l=r.length+i.startOffset:a===s&&s.childNodes[i.startOffset]===n?l=r.length:a===t&&(l=i.startOffset),n&&3===n.nodeType||(n=o.insertBefore(o.ownerDocument.createTextNode(""),n)),n.insertData(0,r),o.removeChild(t),o.removeChild(e),!1!==l&&(i.setStart(n,l),i.collapse(!0),h.selectRange(i)),null):e):e:null})}},de.emoticons=function(e){return e||!1===e?((y.emoticonsEnabled=e)?(m.keypress(oe),de.sourceMode()||(h.saveRange(),M(m[0]),ve=m.find("img[data-sceditor-emoticon]"),ae(!1),h.restoreRange())):(m.find("img[data-sceditor-emoticon]").replaceWith(function(){return ye(this).data("sceditor-emoticon")}),ve=[],m.off("keypress",oe),ae()),de):y.emoticonsEnabled},de.css=function(e){return C||(C=ye('<style id="#inline" />',d[0]).appendTo(d.find("head"))[0]),"string"!=typeof e?C.styleSheet?C.styleSheet.cssText:C.innerHTML:(C.styleSheet?C.styleSheet.cssText=e:C.innerHTML=e,de)},P=function(e){var t=[],n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},o={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},i=e.which,r={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[i]||String.fromCharCode(i).toLowerCase();if((e.ctrlKey||e.metaKey)&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&(t.push("shift"),o[i]?r=o[i]:n[r]&&(r=n[r])),r&&(i<16||18<i)&&t.push(r),t=t.join("+"),ge[t])return ge[t].call(de)},de.addShortcut=function(e,t){return e=e.toLowerCase(),ge[e]="string"==typeof t?function(){return B(be[t],de.commands[t]),!1}:t,de},de.removeShortcut=function(e){return delete ge[e.toLowerCase()],de},j=function(e){var t,n,o,i;if(!y.disableBlockRemove&&8===e.which&&(o=h.selectedRange())&&0===(Te.getSelection?(t=o.startContainer,o.startOffset):(t=o.parentElement(),(n=d[0].selection.createRange()).moveToElementText(t),n.setEndPoint("EndToStart",o),n.text.length))&&(i=re())){for(;t!==i;){for(;t.previousSibling;)if(3!==(t=t.previousSibling).nodeType||t.nodeValue)return;if(!(t=t.parentNode))return}if(i&&!ye(i).is("body"))return de.clearBlockFormatting(i),!1}},re=function(){for(var e=v;!Ce.hasStyling(e)||Ce.isInline(e,!0);)if(!(e=e.parentNode)||ye(e).is("body"))return;return e},de.clearBlockFormatting=function(e){return!(e=e||re())||ye(e).is("body")||(h.saveRange(),e.className="",a=null,ye(e).attr("style",""),ye(e).is("p,div,td")||Ce.convertElement(e,"p"),h.restoreRange()),de},ae=function(e){if(g&&(g.hasHandler("valuechangedEvent")||ae.hasHandler)){var t,n=de.sourceMode(),o=!n&&h.hasSelection();e=(f=!1)!==e&&!d[0].getElementById("sceditor-start-marker"),p&&(clearTimeout(p),p=!1),o&&e&&h.saveRange(),(t=n?i.val():m.html())!==ae.lastVal&&(ae.lastVal=t,x.trigger(ye.Event("valuechanged",{rawValue:n?de.val():t}))),o&&e&&h.removeMarkers()}},se=function(){p&&ae()},le=function(e){var t=e.which,n=le.lastChar,o=13===n||32===n,i=8===n||46===n;le.lastChar=t,f||(13===t||32===t?o?le.triggerNext=!0:ae():8===t||46===t?i?le.triggerNext=!0:ae():le.triggerNext&&(ae(),le.triggerNext=!1),p&&clearTimeout(p),p=setTimeout(function(){f||ae()},1500))},Q=function(e){(f=/start/i.test(e.type))||ae()},ce=function(){de.updateOriginal()},D()};return Fe.locale={},Fe.command={get:function(e){return Fe.commands[e]||null},set:function(e,t){return!(!e||!t)&&((t=ye.extend(Fe.commands[e]||{},t)).remove=function(){Fe.command.remove(e)},Fe.commands[e]=t,this)},remove:function(e){return Fe.commands[e]&&delete Fe.commands[e],this}},Fe}.call(t,n,t,e))||(e.exports=o)},function(e,t,o){var n;void 0===(n=function(e){"use strict";var p=o(0),t=o(2).ie,l=o(6),r=o(1),c=t&&t<11;function n(e){if("mozHidden"in document)for(var t,n=e.getBody()[0];n;){if((t=n).firstChild)t=t.firstChild;else{for(;t&&!t.nextSibling;)t=t.parentNode;t&&(t=t.nextSibling)}3===n.nodeType&&/[\n\r\t]+/.test(n.nodeValue)&&(/^pre/.test(p(n.parentNode).css("white-space"))||p(n).remove()),n=t}}var a={bold:{exec:"bold",tooltip:"Bold",shortcut:"Ctrl+B"},italic:{exec:"italic",tooltip:"Italic",shortcut:"Ctrl+I"},underline:{exec:"underline",tooltip:"Underline",shortcut:"Ctrl+U"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{state:function(e){if(e&&3===e.nodeType&&(e=e.parentNode),e){var t=p(e),n="ltr"===t.css("direction"),o=t.css("textAlign");return"left"===o||o===(n?"start":"end")}},exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{state:function(e){if(e&&3===e.nodeType&&(e=e.parentNode),e){var t=p(e),n="ltr"===t.css("direction"),o=t.css("textAlign");return"right"===o||o===(n?"end":"start")}},exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(e,t,n){for(var o=0,i=e.opts.fonts.split(","),r=p("<div />"),a=function(){return n(p(this).data("font")),e.closeDropDown(!0),!1};o<i.length;o++)r.append(l("fontOpt",{font:i[o]},!0).click(a));e.createDropDown(t,"font-picker",r)},exec:function(e){var t=this;a.font._dropDown(t,e,function(e){t.execCommand("fontname",e)})},tooltip:"Font Name"},size:{_dropDown:function(t,e,n){for(var o=p("<div />"),i=function(e){n(p(this).data("size")),t.closeDropDown(!0),e.preventDefault()},r=1;r<=7;r++)o.append(l("sizeOpt",{size:r},!0).click(i));t.createDropDown(e,"fontsize-picker",o)},exec:function(e){var t=this;a.size._dropDown(t,e,function(e){t.execCommand("fontsize",e)})},tooltip:"Font Size"},color:{_dropDown:function(t,e,n){var o=p("<div />"),i="",r=a.color;r._htmlCache||(t.opts.colors.split("|").forEach(function(e){i+='<div class="sceditor-color-column">',e.split(",").forEach(function(e){i+='<a href="#" class="sceditor-color-option" style="background-color: '+e+'" data-color="'+e+'"></a>'}),i+="</div>"}),r._htmlCache=i),o.html(r._htmlCache).find("a").click(function(e){n(p(this).attr("data-color")),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"color-picker",o)},exec:function(e){var t=this;a.color._dropDown(t,e,function(e){t.execCommand("forecolor",e)})},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(e){var t,n,o=this;(n=l("pastetext",{label:o._("Paste your text inside the following box:"),insert:o._("Insert")},!0)).find(".button").click(function(e){(t=n.find("#txt").val())&&o.wysiwygEditorInsertText(t),o.closeDropDown(!0),e.preventDefault()}),o.createDropDown(e,"pastetext",n)},tooltip:"Paste Text"},bulletlist:{exec:function(){n(this),this.execCommand("insertunorderedlist")},tooltip:"Bullet list"},orderedlist:{exec:function(){n(this),this.execCommand("insertorderedlist")},tooltip:"Numbered list"},indent:{state:function(e,t){var n,o,i,r=p(t),a=r.parents("ul,ol,menu"),s=a.first();if(1<a.length||1<s.children().length)return 0;if(r.is("ul,ol,menu")){if(n=this.getRangeHelper().selectedRange(),!(window.Range&&n instanceof Range))return r.is("li,ul,ol,menu")?0:-1;if(o=n.startContainer.parentNode,i=n.endContainer.parentNode,o!==o.parentNode.firstElementChild||p(i).is("li")&&i!==i.parentNode.lastElementChild)return 0}return-1},exec:function(){var e=p(this.getRangeHelper().getFirstBlockParent());this.focus(),e.parents("ul,ol,menu")&&this.execCommand("indent")},tooltip:"Add indent"},outdent:{state:function(e,t){return p(t).is("ul,ol,menu")||0<p(t).parents("ul,ol,menu").length?0:-1},exec:function(){p(this.getRangeHelper().getFirstBlockParent()).parents("ul,ol,menu")&&this.execCommand("outdent")},tooltip:"Remove one indent"},table:{exec:function(e){var a=this,s=l("table",{rows:a._("Rows:"),cols:a._("Cols:"),insert:a._("Insert")},!0);s.find(".button").click(function(e){var t,n,o=s.find("#rows").val()-0,i=s.find("#cols").val()-0,r="<table>";if(!(o<1||i<1)){for(t=0;t<o;t++){for(r+="<tr>",n=0;n<i;n++)r+="<td>"+(c?"":"<br />")+"</td>";r+="</tr>"}r+="</table>",a.wysiwygEditorInsertHtml(r),a.closeDropDown(!0),e.preventDefault()}}),a.createDropDown(e,"inserttable",s)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{exec:function(){this.wysiwygEditorInsertHtml("<code>",(c?"":"<br />")+"</code>")},tooltip:"Code"},image:{_dropDown:function(t,e,n){var o=l("image",{url:t._("URL:"),width:t._("Width (optional):"),height:t._("Height (optional):"),insert:t._("Insert")},!0),i=o.find("#image");o.find(".button").click(function(e){i.val()&&n(i.val(),o.find("#width").val(),o.find("#height").val()),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertimage",o)},exec:function(e){var i=this;a.image._dropDown(i,e,function(e,t,n){var o="";t&&(o+=' width="'+parseInt(t,10)+'"'),n&&(o+=' height="'+parseInt(n,10)+'"'),o+=' src="'+r.uriScheme(r.entities(e,!0))+'"',i.wysiwygEditorInsertHtml("<img"+o+" />")})},tooltip:"Insert an image"},email:{_dropDown:function(t,e,n){var o=l("email",{label:t._("E-mail:"),desc:t._("Description (optional):"),insert:t._("Insert")},!0),i=o.find("#email");function r(e){i.val()&&n(i.val(),o.find("#des").val()),t.closeDropDown(!0),e.preventDefault()}o.find(".button").click(r),i.add(o.find("#des")).keypress(function(e){13===e.which&&i.val()&&r(e)}),t.createDropDown(e,"insertemail",o)},exec:function(e){var n=this;a.email._dropDown(n,e,function(e,t){n.focus(),!n.getRangeHelper().selectedHtml()||t?n.wysiwygEditorInsertHtml('<a href="mailto:'+r.entities(e,!0)+'">'+r.entities(t||e)+"</a>"):n.execCommand("createlink","mailto:"+e)})},tooltip:"Insert an email"},link:{_dropDown:function(t,e,n){var o=l("link",{url:t._("URL:"),desc:t._("Description (optional):"),ins:t._("Insert")},!0),i=o.find("#link");function r(e){i.val()&&n(i.val(),o.find("#des").val()),t.closeDropDown(!0),e.preventDefault()}o.find(".button").click(r),i.add(o.find("#des")).keypress(function(e){13===e.which&&i.val()&&r(e)}),t.createDropDown(e,"insertlink",o)},exec:function(e){var n=this;a.link._dropDown(n,e,function(e,t){n.focus(),!n.getRangeHelper().selectedHtml()||t?(t=t||e,e=r.uriScheme(r.entities(e,!0)),n.wysiwygEditorInsertHtml('<a href="'+e+'">'+r.entities(t)+"</a>")):n.execCommand("createlink",e)})},tooltip:"Insert a link"},unlink:{state:function(){var e=p(this.currentNode());return e.is("a")||0<e.parents("a").length?0:-1},exec:function(){var e=p(this.currentNode()),t=e.is("a")?e:e.parents("a").first();t.length&&t.replaceWith(t.contents())},tooltip:"Unlink"},quote:{exec:function(e,t,n){var o="<blockquote>",i="</blockquote>";t?(o=o+(n=n?"<cite>"+r.entities(n)+"</cite>":"")+t+i,i=null):""===this.getRangeHelper().selectedHtml()&&(i=(c?"":"<br />")+i),this.wysiwygEditorInsertHtml(o,i)},tooltip:"Insert a Quote"},emoticon:{exec:function(u){var d=this,f=function(e){var t,n=d.opts.emoticonsCompat,o=d.getRangeHelper(),i=n&&" "!==o.getOuterText(!0,1)?" ":"",r=n&&" "!==o.getOuterText(!1,1)?" ":"",a=p("<div />"),s=p("<div />").appendTo(a),l=0,c=p.extend({},d.opts.emoticons.dropdown,e?d.opts.emoticons.more:{});return p.each(c,function(){l++}),l=Math.sqrt(l),p.each(c,function(e,t){s.append(p("<img />").attr({src:t.url||t,alt:e,title:t.tooltip||e}).click(function(){return d.insert(i+p(this).attr("alt")+r,null,!1).closeDropDown(!0),!1})),s.children().length>=l&&(s=p("<div />").appendTo(a))}),!e&&d.opts.emoticons.more&&(t=p('<a class="sceditor-more">'+d._("More")+"</a>").click(function(){return d.createDropDown(u,"more-emoticons",f(!0)),!1}),a.append(t)),a};d.createDropDown(u,"emoticons",f(!1))},txtExec:function(e){a.emoticon.exec.call(this,e)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(r,e,a){var s=l("youtubeMenu",{label:r._("Video URL:"),insert:r._("Insert")},!0);s.find(".button").click(function(e){var t=s.find(s,"#link").val(),n=t.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),o=t.match(/[&|?](?:star)?t=((\d+[hms]?){1,3})/),i=0;o&&p.each(o[1].split(/[hms]/),function(e,t){""!==t&&(i=60*i+Number(t))}),n&&/^[a-zA-Z0-9_\-]{11}$/.test(n[1])&&a(n[1],i),r.closeDropDown(!0),e.preventDefault()}),r.createDropDown(e,"insertlink",s)},exec:function(e){var t=this;a.youtube._dropDown(t,e,function(e){t.wysiwygEditorInsertHtml(l("youtube",{id:e}))})},tooltip:"Insert a YouTube video"},date:{_date:function(e){var t=new Date,n=t.getYear(),o=t.getMonth()+1,i=t.getDate();return n<2e3&&(n=1900+n),o<10&&(o="0"+o),i<10&&(i="0"+i),e.opts.dateFormat.replace(/year/i,n).replace(/month/i,o).replace(/day/i,i)},exec:function(){this.insertText(a.date._date(this))},txtExec:function(){this.insertText(a.date._date(this))},tooltip:"Insert current date"},time:{_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),o<10&&(o="0"+o),t+":"+n+":"+o},exec:function(){this.insertText(a.time._time())},txtExec:function(){this.insertText(a.time._time())},tooltip:"Insert current time"},ltr:{state:function(e,t){return t&&"ltr"===t.style.direction},exec:function(){var e=this.getRangeHelper().getFirstBlockParent(),t=p(e);this.focus(),(e&&!t.is("body")||(this.execCommand("formatBlock","p"),e=this.getRangeHelper().getFirstBlockParent(),t=p(e),e&&!t.is("body")))&&("ltr"===t.css("direction")?t.css("direction",""):t.css("direction","ltr"))},tooltip:"Left-to-Right"},rtl:{state:function(e,t){return t&&"rtl"===t.style.direction},exec:function(){var e=this.getRangeHelper().getFirstBlockParent(),t=p(e);this.focus(),(e&&!t.is("body")||(this.execCommand("formatBlock","p"),e=this.getRangeHelper().getFirstBlockParent(),t=p(e),e&&!t.is("body")))&&("rtl"===t.css("direction")?t.css("direction",""):t.css("direction","rtl"))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize",shortcut:"Ctrl+Shift+M"},source:{state:function(){return this.sourceMode()},exec:function(){this.toggleSourceMode()},txtExec:function(){this.toggleSourceMode()},tooltip:"View source",shortcut:"Ctrl+Shift+S"},ignore:{}};return a}.call(t,o,t,e))||(e.exports=n)},function(e,t,n){var o;void 0===(o=function(e){"use strict";return{toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist,indent,outdent|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:"#000,#44B8FF,#1E92F7,#0074D9,#005DC2,#00369B,#b3d5f4|#444,#C3FFFF,#9DF9FF,#7FDBFF,#68C4E8,#419DC1,#d9f4ff|#666,#72FF84,#4CEA5E,#2ECC40,#17B529,#008E02,#c0f0c6|#888,#FFFF44,#FFFA1E,#FFDC00,#E8C500,#C19E00,#fff5b3|#aaa,#FFC95F,#FFA339,#FF851B,#E86E04,#C14700,#ffdbbb|#ccc,#FF857A,#FF5F54,#FF4136,#E82A1F,#C10300,#ffc6c3|#eee,#FF56FF,#FF30DC,#F012BE,#D900A7,#B20080,#fbb8ec|#fff,#F551FF,#CF2BE7,#B10DC9,#9A00B2,#9A00B2,#e8b6ef",locale:n(0)("html").attr("lang")||"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,startInSourceMode:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,parserOptions:{},dropDownCss:{}}}.call(t,n,t,e))||(e.exports=o)}]),function(x,e,a){"use strict";var g=x.sceditor,w=g.plugins,C=g.escapeEntities,s=g.escapeUriScheme,t=g.ie,k=t&&t<11,r=g.command.get,n={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(e){var t=this;r("font")._dropDown(t,e,function(e){t.insertText("[font="+e+"]","[/font]")})}},size:{txtExec:function(e){var t=this;r("size")._dropDown(t,e,function(e){t.insertText("[size="+e+"]","[/size]")})}},color:{txtExec:function(e){var t=this;r("color")._dropDown(t,e,function(e){t.insertText("[color="+e+"]","[/color]")})}},bulletlist:{txtExec:function(e,t){var n="";x.each(t.split(/\r?\n/),function(){n+=(n?"\n":"")+"[li]"+this+"[/li]"}),this.insertText("[ul]\n"+n+"\n[/ul]")}},orderedlist:{txtExec:function(e,t){var n="";x.each(t.split(/\r?\n/),function(){n+=(n?"\n":"")+"[li]"+this+"[/li]"}),w.bbcode.bbcode.get(""),this.insertText("[ol]\n"+n+"\n[/ol]")}},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(e){var i=this;r("image")._dropDown(i,e,function(e,t,n){var o="";t&&(o+=" width="+t),n&&(o+=" height="+n),i.insertText("[img"+o+"]"+e+"[/img]")})}},email:{txtExec:function(e,n){var o=this;r("email")._dropDown(o,e,function(e,t){o.insertText("[email="+e+"]"+(t||n||e)+"[/email]")})}},link:{txtExec:function(e,n){var o=this;r("link")._dropDown(o,e,function(e,t){o.insertText("[url="+e+"]"+(t||n||e)+"[/url]")})}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(e){var t=this;r("youtube")._dropDown(t,e,function(e){t.insertText("[youtube]"+e+"[/youtube]")})}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}},c=function(e){return e?e.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2"):e},v=function(){var n=arguments;return n[0].replace(/\{(\d+)\}/g,function(e,t){return void 0!==n[t-0+1]?n[t-0+1]:"{"+t+"}"})},S="open",E="content",T="newline",D="close",u=function(e,t,n,o,i,r){var a=this;a.type=e,a.name=t,a.val=n,a.attrs=x.extend({},o),a.children=i||[],a.closing=r||null};u.prototype={clone:function(){var e=this;return new u(e.type,e.name,e.val,e.attrs,[],e.closing?e.closing.clone():null)},splitAt:function(e){var t,n=this.clone(),o=this.children.indexOf(e);return-1<o&&(t=this.children.length-o,n.children=this.children.splice(o,t)),n}};var M=function(e){if(!(this instanceof M))return new M(e);var t,a,r,i,p,h,m,s,d,f,g,v,l,b,y=this;t=function(){y.bbcodes=w.bbcode.bbcodes,y.opts=x.extend({},M.defaults,e)},y.tokenize=function(e){var t,n,o,i=[],r=[{type:D,regex:/^\[\/[^\[\]]+\]/},{type:S,regex:/^\[[^\[\]]+\]/},{type:T,regex:/^(\r\n|\r|\n)/},{type:E,regex:/^([^\[\r\n]+|\[)/}];r.reverse();e:for(;e.length;){for(o=r.length;o--;)if(n=r[o].type,(t=e.match(r[o].regex))&&t[0]){i.push(a(n,t[0])),e=e.substr(t[0].length);continue e}e.length&&i.push(a(E,e)),e=""}return i},a=function(e,t){var n,o,i;return e===S&&(n=t.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/))&&(i=l(n[1]),n[2]&&(n[2]=x.trim(n[2]))&&(o=r(n[2]))),e===D&&(n=t.match(/\[\/([^\[\]]+)\]/))&&(i=l(n[1])),e===T&&(i="#newline"),i&&(e!==S&&e!==D||w.bbcode.bbcodes[i])||(e=E,i="#"),new u(e,i,t,o)},r=function(e){var t,n=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,o={};if("="===e.charAt(0)&&e.indexOf("=",1)<0)o.defaultattr=c(e.substr(1));else for("="===e.charAt(0)&&(e="defaultattr"+e);t=n.exec(e);)o[l(t[1])]=c(t[3])||t[4];return o},y.parse=function(e,t){var n=i(y.tokenize(e)),o=y.opts;return o.fixInvalidNesting&&h(n),p(n,null,t),o.removeEmptyTags&&s(n),n},g=function(e,t,n){for(var o=n.length;o--;)if(n[o].type===t&&n[o].name===e)return!0;return!1},m=function(e,t){var n=(e?y.bbcodes[e.name]:{}).allowedChildren;return!y.opts.fixInvalidChildren||!n||-1<x.inArray(t.name||"#",n)},i=function(e){for(var t,n,o,i,r,a,s=[],l=[],c=[],u=function(){return b(c)},d=function(e){u()?u().children.push(e):l.push(e)},f=function(e){return u()&&(n=y.bbcodes[u().name])&&n.closedBy&&-1<x.inArray(e,n.closedBy)};t=e.shift();)switch(a=e[0],m(u(),t)||t.type===D&&u()&&t.name===u().name||(t.name="#",t.type=E),t.type){case S:f(t.name)&&c.pop(),d(t),(n=y.bbcodes[t.name])&&!n.isSelfClosing&&(n.closedBy||g(t.name,D,e))?c.push(t):n&&n.isSelfClosing||(t.type=E);break;case D:if(u()&&t.name!==u().name&&f("/"+t.name)&&c.pop(),u()&&t.name===u().name)u().closing=t,c.pop();else if(g(t.name,S,c)){for(;o=c.pop();){if(o.name===t.name){o.closing=t;break}i=o.clone(),1<s.length&&i.children.push(b(s)),s.push(i)}for(a&&a.type===T&&(n=y.bbcodes[t.name])&&!1===n.isInline&&(d(a),e.shift()),d(b(s)),r=s.length;r--;)c.push(s[r]);s.length=0}else t.type=E,d(t);break;case T:u()&&a&&f((a.type===D?"/":"")+a.name)&&(a.type===D&&a.name===u().name||((n=y.bbcodes[u().name])&&n.breakAfter?c.pop():n&&!1===n.isInline&&y.opts.breakAfterBlock&&!1!==n.breakAfter&&c.pop())),d(t);break;default:d(t)}return l},p=function(e,t,n){var o,i,r,a,s,l,c,u,d=e.length;t&&(a=y.bbcodes[t.name]);for(var f=d;f--;)if(o=e[f])if(o.type===T){if(i=0<f?e[f-1]:null,r=f<d-1?e[f+1]:null,u=!1,!n&&a&&!0!==a.isSelfClosing&&(i?l||r||(!1===a.isInline&&y.opts.breakEndBlock&&!1!==a.breakEnd&&(u=!0),a.breakEnd&&(u=!0),l=u):(!1===a.isInline&&y.opts.breakStartBlock&&!1!==a.breakStart&&(u=!0),a.breakStart&&(u=!0))),i&&i.type===S&&(s=y.bbcodes[i.name])&&(n?!1===s.isInline&&(u=!0):(!1===s.isInline&&y.opts.breakAfterBlock&&!1!==s.breakAfter&&(u=!0),s.breakAfter&&(u=!0))),!n&&!c&&r&&r.type===S&&(s=y.bbcodes[r.name])&&(!1===s.isInline&&y.opts.breakBeforeBlock&&!1!==s.breakBefore&&(u=!0),s.breakBefore&&(u=!0),c=u)){e.splice(f,1);continue}u&&e.splice(f,1),c=!1}else o.type===S&&p(o.children,o,n)},h=function(e,t,n,o){var i,r,a,s,l,c,u=function(e){var t=y.bbcodes[e.name];return!t||!1!==t.isInline};for(t=t||[],o=o||e,r=0;r<e.length;r++)if((i=e[r])&&i.type===S){if(n&&!u(i)){if(c=(a=b(t)).splitAt(i),l=1<t.length?t[t.length-2].children:o,m(i,a)){var d=a.clone();d.children=i.children,i.children=[d]}if(-1<(s=x.inArray(a,l))){c.children.splice(0,1),l.splice(s+1,0,i,c);var f=c.children[0];return void(f&&f.type===T&&(u(i)||(c.children.splice(0,1),l.splice(s+2,0,f))))}}t.push(i),h(i.children,t,n||u(i),o),t.pop(i)}},s=function(e){for(var t,n,o=function(e){for(var t=e.length;t--;){var n=e[t].type;if(n===S||n===D)return!1;if(n===E&&/\S|\u00A0/.test(e[t].val))return!1}return!0},i=e.length;i--;)(t=e[i])&&t.type===S&&(n=y.bbcodes[t.name],s(t.children),o(t.children)&&n&&!n.isSelfClosing&&!n.allowsEmpty&&e.splice.apply(e,x.merge([i,1],t.children)))},y.toHTML=function(e,t){return d(y.parse(e,t),!0)},d=function(e,t){var n,o,i,r,a,s,l,c,u=[];for(l=function(e){return!1!==(!e||(void 0!==e.isHtmlInline?e.isHtmlInline:e.isInline))};0<e.length;)if(n=e.shift()){if(n.type===S)c=n.children[n.children.length-1]||{},o=y.bbcodes[n.name],a=t&&l(o),i=d(n.children,!1),r=o&&o.html?(l(o)||!l(y.bbcodes[c.name])||o.isPreFormatted||o.skipLastLineBreak||k||(i+="<br />"),x.isFunction(o.html)?o.html.call(y,n,n.attrs,i):(n.attrs[0]=i,w.bbcode.formatBBCodeString(o.html,n.attrs))):n.val+i+(n.closing?n.closing.val:"");else{if(n.type===T){if(!t){u.push("<br />");continue}s||u.push("<div>"),k||u.push("<br />"),e.length||u.push("<br />"),u.push("</div>\n"),s=!1;continue}a=t,r=C(n.val,!0)}a&&!s?(u.push("<div>"),s=!0):!a&&s&&(u.push("</div>\n"),s=!1),u.push(r)}return s&&u.push("</div>\n"),u.join("")},y.toBBCode=function(e,t){return f(y.parse(e,t))},f=function(e){for(var t,n,o,i,r,a,s,l,c,u,d=[];0<e.length;)if(t=e.shift())if(i=!(!(o=y.bbcodes[t.name])||!1!==o.isInline),r=o&&o.isSelfClosing,s=i&&y.opts.breakBeforeBlock&&!1!==o.breakBefore||o&&o.breakBefore,l=i&&!r&&y.opts.breakStartBlock&&!1!==o.breakStart||o&&o.breakStart,c=i&&y.opts.breakEndBlock&&!1!==o.breakEnd||o&&o.breakEnd,u=i&&y.opts.breakAfterBlock&&!1!==o.breakAfter||o&&o.breakAfter,a=(o?o.quoteType:null)||y.opts.quoteType||M.QuoteType.auto,o||t.type!==S)if(t.type===S){if(s&&d.push("\n"),d.push("["+t.name),t.attrs)for(n in t.attrs.defaultattr&&(d.push("=",v(t.attrs.defaultattr,a,"defaultattr")),delete t.attrs.defaultattr),t.attrs)t.attrs.hasOwnProperty(n)&&d.push(" ",n,"=",v(t.attrs[n],a,n));d.push("]"),l&&d.push("\n"),t.children&&d.push(f(t.children)),r||o.excludeClosing||(c&&d.push("\n"),d.push("[/"+t.name+"]")),u&&d.push("\n"),t.closing&&r&&d.push(t.closing.val)}else d.push(t.val);else d.push(t.val),t.children&&d.push(f(t.children)),t.closing&&d.push(t.closing.val);return d.join("")},v=function(e,t,n){var o=M.QuoteType,i=/\s|=/.test(e);return x.isFunction(t)?t(e,n):t===o.never||t===o.auto&&!i?e:'"'+e.replace("\\","\\\\").replace('"','\\"')+'"'},b=function(e){return e.length?e[e.length-1]:null},l=function(e){return e.toLowerCase()},t()};M.QuoteType={always:1,never:2,auto:3},M.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:M.QuoteType.auto},x.sceditorBBCodePlugin=w.bbcode=function(){var e,d,f,o,p=this;p.bbcodes=w.bbcode.bbcodes,p.stripQuotes=c;var h={},s={},m={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]};p.init=function(){p.opts=this.opts,e(),this.commands=x.extend(!0,{},n,this.commands),this.toBBCode=p.signalToSource,this.fromBBCode=p.signalToWysiwyg},e=function(){x.each(p.bbcodes,function(n){var o,e=p.bbcodes[n].tags,t=p.bbcodes[n].styles;e&&x.each(e,function(e,t){o=!1===p.bbcodes[n].isInline,h[e]=h[e]||{},h[e][o]=h[e][o]||{},h[e][o][n]=t}),t&&x.each(t,function(e,t){o=!1===p.bbcodes[n].isInline,s[o]=s[o]||{},s[o][e]=s[o][e]||{},s[o][e][n]=t})})},d=function(n,o,e){var i,r,a=g.dom.getStyle;return s[e=!!e]&&x.each(s[e],function(e,t){(i=a(n[0],e))&&a(n.parent()[0],e)!==i&&x.each(t,function(e,t){(!t||-1<x.inArray(i.toString(),t))&&(r=p.bbcodes[e].format,o=x.isFunction(r)?r.call(p,n,o):v(r,o))})}),o},f=function(n,o,e){var i,r,t=n[0],a=t.nodeName.toLowerCase();e=!!e,h[a]&&h[a][e]&&x.each(h[a][e],function(e,t){t&&(i=!1,x.each(t,function(e,t){if(n.attr(e)&&!(t&&x.inArray(n.attr(e),t)<0))return!(i=!0)}),!i)||(r=p.bbcodes[e].format,o=x.isFunction(r)?r.call(p,n,o):v(r,o))});var s=g.dom.isInline;if(e&&(!s(t,!0)||"br"===a)){for(var l,c,u=t.previousSibling;u&&1===u.nodeType&&!x(u).is("br")&&s(u,!0)&&!u.firstChild;)u=u.previousSibling;for(;l=(c=t.parentNode).lastChild===t,(t=c)&&l&&s(c,!0););(!l||"li"===a||"br"===a&&k)&&(o+="\n"),"br"!==a&&u&&!x(u).is("br")&&s(u,!0)&&(o="\n"+o)}return o},p.signalToSource=function(e,t){var n,o,i=new M(p.opts.parserOptions);return t||(t="string"==typeof e?n=x("<div />").css("visibility","hidden").appendTo(a.body).html(e):x(e)),t&&t.jquery?(g.dom.removeWhiteSpace(t[0]),x(".sceditor-ignore",t).remove(),o=p.elementToBbcode(t),n&&n.remove(),o=i.toBBCode(o,!0),p.opts.bbcodeTrim&&(o=x.trim(o)),o):""},p.elementToBbcode=function(e){var u=function(e,l){var c="";return g.dom.traverse(e,function(e){var t=x(e),n="",o=e.nodeType,i=e.nodeName.toLowerCase(),r=m[i],a=e.firstChild,s=!0;if("object"==typeof l&&(s=-1<x.inArray(i,l),t.is("img")&&t.data("sceditor-emoticon")&&(s=!0),s||(r=l)),3===o||1===o)if(1===o){if(t.hasClass("sceditor-nlf")&&(!a||!k&&1===e.childNodes.length&&/br/i.test(a.nodeName)))return;"iframe"!==i&&(n=u(e,r)),s?("code"!==i&&(n=d(t,n),n=f(t,n),n=d(t,n,!0)),c+=f(t,n,!0)):c+=n}else c+=e.nodeValue},!1,!0),c};return u(e[0])},p.signalToWysiwyg=function(e,t){var n=new M(p.opts.parserOptions).toHTML(p.opts.bbcodeTrim?x.trim(e):e);return t?o(n):n},o=function(e){var t,o,n,i=x("<div />").hide().appendTo(a.body),r=i[0];return n=function(e,t){if(!g.dom.hasStyling(e)){if(k||1!==e.childNodes.length||!x(e.firstChild).is("br"))for(;o=e.firstChild;)r.insertBefore(o,e);if(t){var n=r.lastChild;e!==n&&x(n).is("div")&&e.nextSibling===n&&r.insertBefore(a.createElement("br"),e)}r.removeChild(e)}},r.innerHTML=e.replace(/<\/div>\n/g,"</div>"),(t=r.firstChild)&&x(t).is("div")&&n(t,!0),(t=r.lastChild)&&x(t).is("div")&&n(t),r=r.innerHTML,i.remove(),r}},w.bbcode.formatBBCodeString=function(e,o){return e.replace(/\{([^}]+)\}/g,function(e,t){var n=!0;return"!"===t.charAt(0)&&(n=!1,t=t.substring(1)),"0"===t&&(n=!1),void 0===o[t]?e:n?C(o[t],!0):o[t]})};var o=function(e){return e=parseInt(e,10),isNaN(e)?"00":(e=Math.max(0,Math.min(e,255)).toString(16)).length<2?"0"+e:e},i=function(e){var t;return(t=(e=e||"#000").match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+o(t[1])+o(t[2]-0)+o(t[3]-0):(t=e.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:e},l={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:M.QuoteType.never,format:function(e,t){var n;return e.is("font")&&(n=e.attr("face"))||(n=e.css("font-family")),"[font="+c(n)+"]"+t+"[/font]"},html:'<font face="{defaultattr}">{0}</font>'},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(e,t){var n=e.attr("size"),o=2;return n||(n=e.css("fontSize")),-1<n.indexOf("px")?((n=n.replace("px","")-0)<12&&(o=1),15<n&&(o=3),17<n&&(o=4),23<n&&(o=5),31<n&&(o=6),47<n&&(o=7)):o=n,"[size="+o+"]"+t+"[/size]"},html:'<font size="{defaultattr}">{!0}</font>'},color:{tags:{font:{color:null}},styles:{color:null},quoteType:M.QuoteType.never,format:function(e,t){var n;return e.is("font")&&(n=e.attr("color"))||(n=e[0].style.color||e.css("color")),"[color="+i(n)+"]"+t+"[/color]"},html:function(e,t,n){return'<font color="'+C(i(t.defaultattr),!0)+'">'+n+"</font>"}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(e,t){return e.data("sceditor-emoticon")+t},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},allowedChildren:["#"],quoteType:M.QuoteType.never,format:function(e,t){var n,o,i="",r=e[0],a=function(e){return r.style?r.style[e]:null};return e.attr("data-sceditor-emoticon")?t:(n=e.attr("width")||a("width"),o=e.attr("height")||a("height"),(r.complete&&(n||o)||n&&o)&&(i="="+e.width()+"x"+e.height()),"[img"+i+"]"+e.attr("src")+"[/img]")},html:function(e,t,n){var o,i,r,a="";return o=t.width,i=t.height,t.defaultattr&&(o=(r=t.defaultattr.split(/x/i))[0],i=2===r.length?r[1]:r[0]),void 0!==o&&(a+=' width="'+C(o,!0)+'"'),void 0!==i&&(a+=' height="'+C(i,!0)+'"'),"<img"+a+' src="'+s(n)+'" />'}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:M.QuoteType.never,format:function(e,t){var n=e.attr("href");return"mailto:"===n.substr(0,7)?'[email="'+n.substr(7)+'"]'+t+"[/email]":"[url="+n+"]"+t+"[/url]"},html:function(e,t,n){return t.defaultattr=C(t.defaultattr,!0)||n,'<a href="'+s(t.defaultattr)+'">'+n+"</a>"}},email:{quoteType:M.QuoteType.never,html:function(e,t,n){return'<a href="mailto:'+(C(t.defaultattr,!0)||n)+'">'+n+"</a>"}},quote:{tags:{blockquote:null},isInline:!1,quoteType:M.QuoteType.never,format:function(e,t){var n="",o=x(e),i=o.children("cite").first();return(1===i.length||o.data("author"))&&(n=i.text()||o.data("author"),o.data("author",n),i.remove(),t=this.elementToBbcode(x(e)),n="="+n.replace(/(^\s+|\s+$)/g,""),o.prepend(i)),"[quote"+n+"]"+t+"[/quote]"},html:function(e,t,n){return t.defaultattr&&(n="<cite>"+C(t.defaultattr)+"</cite>"+n),"<blockquote>"+n+"</blockquote>"}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},allowsEmpty:!0,isInline:!1,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},allowsEmpty:!0,isInline:!1,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},allowsEmpty:!0,isInline:!1,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},allowsEmpty:!0,isInline:!1,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(e,t){return(e=e.attr("data-youtube-id"))?"[youtube]"+e+"[/youtube]":t},html:'<iframe width="560" height="315" frameborder="0" src="https://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},isInline:!1,format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},isInline:!1,format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}};w.bbcode.bbcode={get:function(e){return l[e]||null},set:function(e,t){return!(!e||!t)&&((t=x.extend(l[e]||{},t)).remove=function(){delete l[e]},l[e]=t,this)},rename:function(e,t){return e in l&&(l[t]=l[e],delete l[e],this)},remove:function(e){return e in l&&delete l[e],this}},x.fn.sceditorBBCodePlugin=function(e){return e=e||{},x.isPlainObject(e)&&(e.plugins=(e.plugins||"")+"bbcode"),this.sceditor(e)},w.bbcode.normaliseColour=i,w.bbcode.formatString=v,w.bbcode.stripQuotes=c,w.bbcode.bbcodes=l,g.BBCodeParser=M}(jQuery,window,document);