/* SCEditor v1.4.5 | (C) 2011-2013, Sam Clarke | sceditor.com/license */
!function(a,b,c){"use strict";var d={html:'<!DOCTYPE html><html><head><style>.ie * {min-height: auto !important}</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" value="http://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" value="http://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{id}?wmode=opaque" data-youtube-id="{id}" frameborder="0" allowfullscreen></iframe>'},e=function(b,c,e){var f=d[b];return a.each(c,function(a,b){f=f.replace(new RegExp("\\{"+a+"\\}","g"),b)}),e&&(f=a(f)),f};a.sceditor=function(d,f){var j,k,l,m,n,o,p,q,r,t,u,w,z,A,B,C,D,E,F,G,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,g=this,h=d.get?d.get(0):d,i=a(h),s=[],v=[],x=[],y=[],H={},I=[];g.commands=a.extend(!0,{},f.commands||a.sceditor.commands),g.opts=f=a.extend({},a.sceditor.defaultOptions,f),J=function(){i.data("sceditor",g),a.each(f,function(b,c){a.isPlainObject(c)&&(f[b]=a.extend(!0,{},c))}),f.locale&&"en"!==f.locale&&P(),j=a('<div class="sceditor-container" />').insertAfter(i).css("z-index",f.zIndex),a.sceditor.ie&&j.addClass("ie ie"+a.sceditor.ie),F=!!i.attr("required"),i.removeAttr("required"),O(),V(),Q(),N(),T(),R(),S(),a.sceditor.isWysiwygSupported||g.toggleSourceMode(),gb();var d=function(){a(b).unbind("load",d),f.autofocus&&lb(),f.autoExpand&&g.expandToContent(),eb(),A.call("ready")};a(b).load(d),c.readyState&&"complete"===c.readyState&&d()},O=function(){var b=f.plugins;b=b?b.toString().split(","):[],A=new a.sceditor.PluginManager(g),a.each(b,function(b,c){A.register(a.trim(c))})},P=function(){var b;u=a.sceditor.locale[f.locale],u||(b=f.locale.split("-"),u=a.sceditor.locale[b[0]]),u&&u.dateFormat&&(f.dateFormat=u.dateFormat)},N=function(){var c,d;p=a("<textarea></textarea>").hide(),l=a('<iframe frameborder="0"></iframe>'),f.spellcheck||p.attr("spellcheck","false"),"https:"===b.location.protocol&&l.attr("src","javascript:false"),j.append(l).append(p),m=l[0],q=p[0],g.dimensions(f.width||i.width(),f.height||i.height()),c=W(),c.open(),c.write(e("html",{spellcheck:f.spellcheck?"":'spellcheck="false"',charset:f.charset,style:f.style})),c.close(),o=a(c),n=a(c.body),g.readOnly(!!f.readOnly),a.sceditor.ie&&o.find("html").addClass("ie ie"+a.sceditor.ie),(a.sceditor.ios||a.sceditor.ie)&&(n.height("100%"),a.sceditor.ie||n.bind("touchend",g.focus)),w=new a.sceditor.rangeHelper(m.contentWindow),g.val(i.hide().val()),d=i.attr("tabindex"),p.attr("tabindex",d),l.attr("tabindex",d)},R=function(){f.autoUpdate&&(n.bind("blur",g.updateOriginal),p.bind("blur",g.updateOriginal)),null===f.rtl&&(f.rtl="rtl"===p.css("direction")),g.rtl(!!f.rtl),f.autoExpand&&o.bind("keyup",g.expandToContent),f.resizeEnabled&&U(),j.attr("id",f.id),g.emoticons(f.emoticonsEnabled)},S=function(){a(c).click(db),a(h.form).bind("reset",ab).submit(g.updateOriginal),a(b).bind("resize orientationChanged",eb),n.keypress(_).keydown(Z).keydown($).keyup(ib).bind("blur",qb).keyup(rb).bind("paste",X).bind(a.sceditor.ie?"selectionchange":"keyup focus blur contextmenu mouseup touchend click",jb).bind("keydown keyup keypress focus blur contextmenu",cb),f.emoticonsCompat&&b.getSelection&&n.keyup(nb),p.bind("blur",qb).keyup(rb).bind("keydown keyup keypress focus blur contextmenu",cb).keydown(Z),o.mousedown(bb).bind("blur",qb).bind(a.sceditor.ie?"selectionchange":"focus blur contextmenu mouseup click",jb).bind("beforedeactivate keyup",M).keyup(ib).focus(function(){t=null}),j.bind("selectionchanged",kb).bind("selectionchanged",gb).bind("selectionchanged valuechanged",cb).bind("nodechanged",cb)},Q=function(){var b,c,d,h=g.commands,i=(f.toolbarExclude||"").split(","),l=f.toolbar.split("|");k=a('<div class="sceditor-toolbar" unselectable="on" />'),a.each(l,function(f,j){b=a('<div class="sceditor-group" />'),a.each(j.split(","),function(f,j){!h[j]||a.inArray(j,i)>-1||(d=h[j].shortcut?" ("+h[j].shortcut+")":"",c=e("toolbarButton",{name:j,dispName:g._(h[j].tooltip||j)+d},!0),c.data("sceditor-txtmode",!!h[j].txtExec),c.data("sceditor-wysiwygmode",!!h[j].exec),c.click(function(){var b=a(this);return b.hasClass("disabled")||L(b,h[j]),gb(),!1}),h[j].tooltip&&c.attr("title",g._(h[j].tooltip)),h[j].exec||c.addClass("disabled"),h[j].shortcut&&(g.addShortcut(h[j].shortcut,j),c.attr("title",c.attr("title")+d)),b.append(c))}),b[0].firstChild&&k.append(b)}),a(f.toolbarContainer||j).append(k)},T=function(){a.each(g.commands,function(b,c){c.keyPress&&s.push(c.keyPress),c.forceNewLineAfter&&a.isArray(c.forceNewLineAfter)&&(x=a.merge(x,c.forceNewLineAfter)),c.state?y.push({name:b,state:c.state}):"string"==typeof c.exec&&y.push({name:b,state:c.exec})}),ib()},U=function(){var d,e,h,i,k,l,m=a('<div class="sceditor-grip" />'),n=a('<div class="sceditor-resize-cover" />'),o=0,p=0,q=0,r=0,s=j.width(),t=j.height(),u=!1,v=g.rtl();d=f.resizeMinHeight||t/1.5,e=f.resizeMaxHeight||2.5*t,h=f.resizeMinWidth||s/1.25,i=f.resizeMaxWidth||1.25*s,k=function(c){"touchmove"===c.type&&(c=b.event);var k=r+(c.pageY-p),l=v?q-(c.pageX-o):q+(c.pageX-o);i>0&&l>i&&(l=i),e>0&&k>e&&(k=e),(!f.resizeWidth||h>l||i>0&&l>i)&&(l=!1),(!f.resizeHeight||d>k||e>0&&k>e)&&(k=!1),(l||k)&&(g.dimensions(l,k),a.sceditor.ie<7&&j.height(k)),c.preventDefault()},l=function(b){u&&(u=!1,n.hide(),j.removeClass("resizing").height("auto"),a(c).unbind("touchmove mousemove",k),a(c).unbind("touchend mouseup",l),b.preventDefault())},j.append(m),j.append(n.hide()),m.bind("touchstart mousedown",function(d){"touchstart"===d.type&&(d=b.event),o=d.pageX,p=d.pageY,q=j.width(),r=j.height(),u=!0,j.addClass("resizing"),n.show(),a(c).bind("touchmove mousemove",k),a(c).bind("touchend mouseup",l),a.sceditor.ie<7&&j.height(r),d.preventDefault()})},V=function(){var b,d=f.emoticons,e=f.emoticonsRoot;a.isPlainObject(d)&&f.emoticonsEnabled&&a.each(d,function(f,g){a.each(g,function(a,g){e&&(g={url:e+(g.url||g),tooltip:g.tooltip||a},d[f][a]=g),b=c.createElement("img"),b.src=g.url||g,v.push(b)})})},lb=function(){var b,c,d,e=o[0],h=n[0],i=!!f.autofocusEnd;if(j.is(":visible")){if(g.sourceMode())d=q.value.length,q.setSelectionRange?q.setSelectionRange(d,d):q.createTextRange&&(b=q.createTextRange(),b.moveEnd("character",d),b.moveStart("character",d),w.selectRange(b));else{if(a.sceditor.dom.removeWhiteSpace(h),i)for((c=h.lastChild)||n.append(c=e.createElement("div"));c.lastChild;)c=c.lastChild,/br/i.test(c.nodeName)&&c.previousSibling&&(c=c.previousSibling);else c=h.firstChild;e.createRange?(b=e.createRange(),/br/i.test(c.nodeName)?b.setStartBefore(c):b.selectNodeContents(c),b.collapse(!1)):(b=h.createTextRange(),b.moveToElementText(3!==c.nodeType?c:c.parentNode),b.collapse(!1)),w.selectRange(b),i&&(o.scrollTop(h.scrollHeight),n.scrollTop(h.scrollHeight))}g.focus()}},g.readOnly=function(a){return"boolean"!=typeof a?"readonly"===p.attr("readonly"):(n[0].contentEditable=!a,a?p.attr("readonly","readonly"):p.removeAttr("readonly"),fb(a),this)},g.rtl=function(a){var b=a?"rtl":"ltr";return"boolean"!=typeof a?"rtl"===p.attr("dir"):(n.attr("dir",b),p.attr("dir",b),j.removeClass("rtl").removeClass("ltr").addClass(b),this)},fb=function(b){var c=g.inSourceMode();k.find(".sceditor-button").removeClass("disabled").each(function(){var d=a(this);b===!0||c&&!d.data("sceditor-txtmode")?d.addClass("disabled"):c||d.data("sceditor-wysiwygmode")||d.addClass("disabled")})},g.width=function(a,b){return a||0===a?(g.dimensions(a,null,b),this):j.width()},g.dimensions=function(b,d,e){var h=a.sceditor.ie<8||c.documentMode<8?2:0;return b=b||0===b?b:!1,d=d||0===d?d:!1,b===!1&&d===!1?{width:g.width(),height:g.height()}:("undefined"==typeof l.data("outerWidthOffset")&&g.updateStyleCache(),b!==!1&&(e!==!1&&(f.width=b),d===!1&&(d=j.height(),e=!1),j.width(b),b&&b.toString().indexOf("%")>-1&&(b=j.width()),l.width(b-l.data("outerWidthOffset")),p.width(b-p.data("outerWidthOffset")),a.sceditor.ios&&n&&n.width(b-l.data("outerWidthOffset")-(n.outerWidth(!0)-n.width()))),d!==!1&&(e!==!1&&(f.height=d),d&&d.toString().indexOf("%")>-1&&(d=j.height(d).height(),j.height("auto")),d-=f.toolbarContainer?0:k.outerHeight(!0),l.height(d-l.data("outerHeightOffset")),p.height(d-h-p.data("outerHeightOffset"))),this)},g.updateStyleCache=function(){l.data("outerWidthOffset",l.outerWidth(!0)-l.width()),p.data("outerWidthOffset",p.outerWidth(!0)-p.width()),l.data("outerHeightOffset",l.outerHeight(!0)-l.height()),p.data("outerHeightOffset",p.outerHeight(!0)-p.height())},g.height=function(a,b){return a||0===a?(g.dimensions(null,a,b),this):j.height()},g.maximize=function(b){return"undefined"==typeof b?j.is(".sceditor-maximize"):(b=!!b,a.sceditor.ie<7&&a("html, body").toggleClass("sceditor-maximize",b),j.toggleClass("sceditor-maximize",b),g.width(b?"100%":f.width,!1),g.height(b?"100%":f.height,!1),this)},g.expandToContent=function(a){var b=j.height(),c=n[0].scrollHeight||o[0].documentElement.scrollHeight,d=b-l.height(),e=f.resizeMaxHeight||2*(f.height||i.height());c+=d,a!==!0&&c>e&&(c=e),c>b&&g.height(c)},g.destroy=function(){A&&(A.destroy(),w=null,t=null,A=null,a(c).unbind("click",db),a(b).unbind("resize orientationChanged",eb),a(h.form).unbind("reset",ab).unbind("submit",g.updateOriginal),n.unbind(),o.unbind().find("*").remove(),p.unbind().remove(),k.remove(),j.unbind().find("*").unbind().remove(),j.remove(),i.removeData("sceditor").removeData("sceditorbbcode").show(),F&&i.attr("required","required"))},g.createDropDown=function(b,c,d,e){var h,i=r&&r.is(".sceditor-"+c);g.closeDropDown(),i||(e!==!1&&a(d).find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"),h={top:b.offset().top,left:b.offset().left,marginTop:b.outerHeight()},a.extend(h,f.dropDownCss),r=a('<div class="sceditor-dropdown sceditor-'+c+'" />').css(h).append(d).appendTo(a("body")).on("click focusin",function(a){a.stopPropagation()}))},db=function(a){3!==a.which&&g.closeDropDown()},X=function(a){var b,d,e,h=n[0],i=o[0],j=0,k=c.createElement("div"),l=i.createDocumentFragment();if(f.disablePasting)return!1;if(f.enablePasteFiltering){if(w.saveRange(),c.body.appendChild(k),a&&a.clipboardData&&a.clipboardData.getData&&((b=a.clipboardData.getData("text/html"))||(b=a.clipboardData.getData("text/plain"))))return k.innerHTML=b,Y(h,k),!1;for(e=n.scrollTop()||o.scrollTop();h.firstChild;)l.appendChild(h.firstChild);return d=function(a,b){if(a.childNodes.length>0||j>25){for(;a.firstChild;)b.appendChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild);n.scrollTop(e),o.scrollTop(e),b.childNodes.length>0?Y(a,b):w.restoreRange()}else j++,setTimeout(function(){d(a,b)},20)},d(h,k),g.focus(),!0}},Y=function(b,c){a.sceditor.dom.fixNesting(c);var d=c.innerHTML;A.hasHandler("toSource")&&(d=A.callOnlyFirst("toSource",d,a(c))),c.parentNode.removeChild(c),A.hasHandler("toWysiwyg")&&(d=A.callOnlyFirst("toWysiwyg",d,!0)),w.restoreRange(),g.wysiwygEditorInsertHtml(d,null,!0)},g.closeDropDown=function(a){r&&(r.unbind().remove(),r=null),a===!0&&g.focus()},W=function(){return m.contentDocument?m.contentDocument:m.contentWindow&&m.contentWindow.document?m.contentWindow.document:m.document?m.document:null},g.wysiwygEditorInsertHtml=function(b,c,d){var e,f,h,i=l.height();g.focus(),(d||!a(C).is("code")&&0===a(C).parents("code").length)&&(w.insertHTML(b,c),w.saveRange(),K(n[0]),e=n.find("#sceditor-end-marker").show(),f=n.scrollTop()||o.scrollTop(),h=a.sceditor.dom.getOffset(e[0]).top+1.5*e.outerHeight(!0)-i,e.hide(),(h>f||f>h+i)&&(n.scrollTop(h),o.scrollTop(h)),pb(!1),w.restoreRange(),ib())},g.wysiwygEditorInsertText=function(b,c){g.wysiwygEditorInsertHtml(a.sceditor.escapeEntities(b),a.sceditor.escapeEntities(c))},g.insertText=function(a,b){return g.inSourceMode()?g.sourceEditorInsertText(a,b):g.wysiwygEditorInsertText(a,b),this},g.sourceEditorInsertText=function(a,b){var d,e,f,g,h;h=q.scrollTop,q.focus(),"undefined"!=typeof q.selectionStart?(e=q.selectionStart,f=q.selectionEnd,g=a.length,b&&(a+=q.value.substring(e,f)+b),q.value=q.value.substring(0,e)+a+q.value.substring(f,q.value.length),q.selectionStart=e+a.length-(b?b.length:0),q.selectionEnd=q.selectionStart):"undefined"!=typeof c.selection.createRange?(d=c.selection.createRange(),b&&(a+=d.text+b),d.text=a,b&&d.moveEnd("character",0-b.length),d.moveStart("character",d.End-d.Start),d.select()):q.value+=a+b,q.scrollTop=h,q.focus(),pb()},g.getRangeHelper=function(){return w},g.sourceEditorCaret=function(a){var b={};return"undefined"!=typeof q.selectionStart?a?(q.selectionStart=a.start,q.selectionEnd=a.end):(b.start=q.selectionStart,b.end=q.selectionEnd):(range=c.selection.createRange(),a?(range.moveStart("character",a.start),range.moveEnd("character",a.end),range.select()):(b.start=range.Start,b.end=range.End)),a?this:b},g.val=function(a,b){return"string"==typeof a?(g.inSourceMode()?g.setSourceEditorValue(a):(b!==!1&&A.hasHandler("toWysiwyg")&&(a=A.callOnlyFirst("toWysiwyg",a)),g.setWysiwygEditorValue(a)),this):g.inSourceMode()?g.getSourceEditorValue(!1):g.getWysiwygEditorValue()},g.insert=function(b,c,d,e,f){if(g.inSourceMode())g.sourceEditorInsertText(b,c);else{if(c){var h=g.getRangeHelper().selectedHtml(),i=a("<div>").appendTo(a("body")).hide().html(h);d!==!1&&A.hasHandler("toSource")&&(h=A.callOnlyFirst("toSource",h,i)),i.remove(),b+=h+c}d!==!1&&A.hasHandler("toWysiwyg")&&(b=A.callOnlyFirst("toWysiwyg",b,!0)),d!==!1&&f===!0&&(b=b.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),g.wysiwygEditorInsertHtml(b)}return this},g.getWysiwygEditorValue=function(b){var c,d,e=w.hasSelection();return e?w.saveRange():t&&t.getBookmark&&(d=t.getBookmark()),a.sceditor.dom.fixNesting(n[0]),c=n.html(),b!==!1&&A.hasHandler("toSource")&&(c=A.callOnlyFirst("toSource",c,n)),e?(w.restoreRange(),t=null):d&&(t.moveToBookmark(d),t=null),c},g.getBody=function(){return n},g.getContentAreaContainer=function(){return l},g.getSourceEditorValue=function(a){var b=p.val();return a!==!1&&A.hasHandler("toWysiwyg")&&(b=A.callOnlyFirst("toWysiwyg",b)),b},g.setWysiwygEditorValue=function(b){b||(b="<p>"+(a.sceditor.ie?"":"<br />")+"</p>"),n[0].innerHTML=b,K(n[0]),ib(),pb()},g.setSourceEditorValue=function(a){p.val(a),pb()},g.updateOriginal=function(){i.val(g.val())},K=function(b){if(f.emoticonsEnabled&&!a(b).parents("code").length){var c=b.ownerDocument,d=[],g=[],h=a.extend({},f.emoticons.more,f.emoticons.dropdown,f.emoticons.hidden);a.each(h,function(b){f.emoticonsCompat&&(g[b]=new RegExp("(>|^|\\s|\xa0|\u2002|\u2003|\u2009|&nbsp;)"+a.sceditor.regexEscape(b)+"(\\s|$|<|\xa0|\u2002|\u2003|\u2009|&nbsp;)")),d.push(b)}),function i(b){for(b=b.firstChild;null!=b;){var j,k,l,m,n,o,p,q=b.parentNode,r=b.nodeValue;if(3!==b.nodeType)a(b).is("code")||i(b);else if(r)for(n=d.length;n--;)k=d[n],p=f.emoticonsCompat?r.search(g[k]):r.indexOf(k),p>-1&&(o=b.nextSibling,l=h[k],j=r.substr(p).split(k),r=r.substr(0,p)+j.shift(),b.nodeValue=r,m=a.sceditor.dom.parseHTML(e("emoticon",{key:k,url:l.url||l,tooltip:l.tooltip||k}),c),q.insertBefore(m[0],o),q.insertBefore(c.createTextNode(j.join(k)),o));b=b.nextSibling}}(b),f.emoticonsCompat&&(I=n.find("img[data-sceditor-emoticon]"))}},g.inSourceMode=function(){return j.hasClass("sourceMode")},g.sourceMode=function(a){return"boolean"!=typeof a?g.inSourceMode():((g.inSourceMode()&&!a||!g.inSourceMode()&&a)&&g.toggleSourceMode(),this)},g.toggleSourceMode=function(){(a.sceditor.isWysiwygSupported||!g.inSourceMode())&&(g.blur(),g.inSourceMode()?g.setWysiwygEditorValue(g.getSourceEditorValue()):g.setSourceEditorValue(g.getWysiwygEditorValue()),t=null,p.toggle(),l.toggle(),g.inSourceMode()?j.removeClass("sourceMode").addClass("wysiwygMode"):j.removeClass("wysiwygMode").addClass("sourceMode"),fb(),gb())},hb=function(){return q.focus(),null!=q.selectionStart?q.value.substring(q.selectionStart,q.selectionEnd):c.selection.createRange?c.selection.createRange().text:void 0},L=function(b,c){return g.inSourceMode()?(c.txtExec&&(a.isArray(c.txtExec)?g.sourceEditorInsertText.apply(g,c.txtExec):c.txtExec.call(g,b,hb())),void 0):(c.exec&&(a.isFunction(c.exec)?c.exec.call(g,b):g.execCommand(c.exec,c.hasOwnProperty("execParam")?c.execParam:null)),void 0)},M=function(){a.sceditor.ie&&(t=w.selectedRange())},g.execCommand=function(b,c){var d=!1,e=a(w.parentNode());if(g.focus(),!e.is("code")&&0===e.parents("code").length){try{d=o[0].execCommand(b,!1,c)}catch(f){}!d&&g.commands[b]&&g.commands[b].errorMessage&&alert(g._(g.commands[b].errorMessage))}},jb=function(){var b=function(){w&&!w.compare(D)&&(D=w.cloneSelected(),j.trigger(a.Event("selectionchanged"))),E=!1};E||(E=!0,a.sceditor.ie?b():setTimeout(b,100))},kb=function(){var b,c=w.parentNode();B!==c&&(b=B,B=c,C=w.getFirstBlockParent(c),j.trigger(a.Event("nodechanged",{oldNode:b,newNode:B})))},g.currentNode=function(){return B},g.currentBlockNode=function(){return C},gb=function(a){var b,c,d,e,f,h=o[0],i=y.length,j=g.sourceMode();if(g.sourceMode()||g.readOnly())k.find(".sceditor-button").removeClass("active");else for(f=a?a.newNode:w.parentNode(),d=w.getFirstBlockParent(f);i--;)if(b=0,c=y[i],e=k.find(".sceditor-button-"+c.name),j&&!e.data("sceditor-txtmode"))e.addClass("disabled");else if(j||e.data("sceditor-wysiwygmode")){if("string"==typeof c.state)try{b=h.queryCommandEnabled(c.state)?0:-1,b>-1&&(b=h.queryCommandState(c.state)?1:0)}catch(l){}else b=c.state.call(g,f,d);0>b?e.addClass("disabled"):e.removeClass("disabled"),b>0?e.addClass("active"):e.removeClass("active")}else e.addClass("disabled")},_=function(b){var c,d;if(!b.originalEvent.defaultPrevented){if(g.closeDropDown(),c=a(B),13===b.which&&(c.is("code,blockquote,pre")||0!==c.parents("code,blockquote,pre").length))return t=null,g.wysiwygEditorInsertHtml("<br />",null,!0),!1;if(!c.is("code")&&0===c.parents("code").length)for(d=s.length;d--;)s[d].call(g,b,m,p)}},ib=function(){var b,c,d;a.sceditor.dom.rTraverse(n[0],function(e){return b=e.nodeName.toLowerCase(),a.inArray(b,x)>-1&&(c=!0),3===e.nodeType&&!/^\s*$/.test(e.nodeValue)||"br"===b||a.sceditor.ie&&!e.firstChild&&!a.sceditor.dom.isInline(e,!1)?(c&&(d=n[0].ownerDocument.createElement("div"),d.className="sceditor-nlf",d.innerHTML=a.sceditor.ie?"":"<br />",n[0].appendChild(d)),!1):void 0})},ab=function(){g.val(i.val())},bb=function(){g.closeDropDown(),t=null},eb=function(){var a=f.height,b=f.width;g.maximize()?g.dimensions("100%","100%",!1):(a&&a.toString().indexOf("%")>-1||b&&b.toString().indexOf("%")>-1)&&g.dimensions(b,a)},g._=function(){var a=arguments;return u&&u[a[0]]&&(a[0]=u[a[0]]),a[0].replace(/\{(\d+)\}/g,function(b,c){return"undefined"!=typeof a[c-0+1]?a[c-0+1]:"{"+c+"}"})},cb=function(b){var c,d=a.extend({},b);A.call(d.type+"Event",b,g),delete d.type,c=a.Event((b.target===q?"scesrc":"scewys")+b.type,d),j.trigger(c,g),c.isDefaultPrevented()&&b.preventDefault(),c.isImmediatePropagationStopped()&&c.stopImmediatePropagation(),c.isPropagationStopped()&&c.stopPropagation()},g.bind=function(b,c,d,e){b=b.split(" ");for(var f=b.length;f--;)a.isFunction(c)&&(d||j.bind("scewys"+b[f],c),e||j.bind("scesrc"+b[f],c),"valuechanged"===b[f]&&(pb.hasHandler=!0));return this},g.unbind=function(b,c,d,e){b=b.split(" ");for(var f=b.length;f--;)a.isFunction(c)&&(d||j.unbind("scewys"+b[f],c),e||j.unbind("scesrc"+b[f],c));return this},g.blur=function(b,c,d){return a.isFunction(b)?g.bind("blur",b,c,d):g.sourceMode()?p.blur():z?z.removeAttr("disabled").show().focus().blur().hide().attr("disabled","disabled"):(z=a('<input style="position:absolute;width:0;height:0;opacity:0;border:0;padding:0;filter:alpha(opacity=0)" type="text" />').appendTo(j),z.removeAttr("disabled").show().triggerHandler("focus"),z.blur().hide().attr("disabled","disabled")),this},g.focus=function(b,c,d){return a.isFunction(b)?g.bind("focus",b,c,d):g.inSourceMode()?q.focus():(m.contentWindow.focus(),n[0].focus(),t&&(w.selectRange(t),t=null)),this},g.keyDown=function(a,b,c){return g.bind("keydown",a,b,c)},g.keyPress=function(a,b,c){return g.bind("keypress",a,b,c)},g.keyUp=function(a,b,c){return g.bind("keyup",a,b,c)},g.nodeChanged=function(a){return g.bind("nodechanged",a,!1,!0)},g.selectionChanged=function(a){return g.bind("selectionchanged",a,!1,!0)},g.valueChanged=function(a,b,c){return g.bind("valuechanged",a,b,c)},mb=function(b){var c=0,d=String.fromCharCode(b.which);if(!a(C).is("code")&&!a(C).parents("code").length)return g.emoticonsCache||(g.emoticonsCache=[],a.each(a.extend({},f.emoticons.more,f.emoticons.dropdown,f.emoticons.hidden),function(a,b){g.emoticonsCache[c++]=[a,e("emoticon",{key:a,url:b.url||b,tooltip:b.tooltip||a})]}),g.emoticonsCache.sort(function(a,b){return a[0].length-b[0].length}),g.longestEmoticonCode=g.emoticonsCache[g.emoticonsCache.length-1][0].length),g.getRangeHelper().raplaceKeyword(g.emoticonsCache,!0,!0,g.longestEmoticonCode,f.emoticonsCompat,d)?(f.emoticonsCompat&&(I=n.find("img[data-sceditor-emoticon]")),/^\s$/.test(d)&&f.emoticonsCompat):void 0},nb=function(){if(I.length){var b,c,d,e,f,h,i=g.currentBlockNode(),j=!1,k=/[^\s\xA0\u2002\u2003\u2009\u00a0]+/;I=a.map(I,function(g){return g&&g.parentNode?a.contains(i,g)?(b=g.previousSibling,c=g.nextSibling,f=b.nodeValue,null===f&&(f=b.innerText||""),b&&k.test(b.nodeValue.slice(-1))||c&&k.test((c.nodeValue||"")[0])?(d=g.parentNode,e=w.cloneSelected(),h=e.startContainer,f+=a(g).data("sceditor-emoticon"),h===c?j=f.length+e.startOffset:h===i&&i.childNodes[e.startOffset]===c?j=f.length:h===b&&(j=e.startOffset),c&&3===c.nodeType||(c=d.insertBefore(d.ownerDocument.createTextNode(""),c)),c.insertData(0,f),d.removeChild(b),d.removeChild(g),j!==!1&&(e.setStart(c,j),e.collapse(!0),w.selectRange(e)),null):g):g:null})}},g.emoticons=function(b){return b||b===!1?(f.emoticonsEnabled=b,b?(n.keypress(mb),g.sourceMode()||(w.saveRange(),K(n[0]),I=n.find("img[data-sceditor-emoticon]"),pb(!1),w.restoreRange())):(n.find("img[data-sceditor-emoticon]").replaceWith(function(){return a(this).data("sceditor-emoticon")}),I=[],n.unbind("keypress",mb),pb()),this):f.emoticonsEnabled},g.css=function(b){return G||(G=a('<style id="#inline" />').appendTo(o.find("head"))[0]),"string"!=typeof b?G.styleSheet?G.styleSheet.cssText:G.innerHTML:(G.styleSheet?G.styleSheet.cssText=b:G.innerHTML=b,this)},Z=function(a){var b=[],c={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},d={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},e={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},f=a.which,h=d[f]||String.fromCharCode(f).toLowerCase();return a.ctrlKey&&b.push("ctrl"),a.altKey&&b.push("alt"),a.shiftKey&&(b.push("shift"),e[f]?h=e[f]:c[h]&&(h=c[h])),h&&(16>f||f>18)&&b.push(h),b=b.join("+"),H[b]?H[b].call(g):void 0},g.addShortcut=function(a,b){return a=a.toLowerCase(),H[a]="string"==typeof b?function(){return L(k.find(".sceditor-button-"+b),g.commands[b]),!1}:b,this},g.removeShortcut=function(a){return delete H[a.toLowerCase()],this},$=function(c){var d,e,h,i,j;if(!a.sceditor.ie&&!f.disableBlockRemove&&8===c.which&&(i=w.selectedRange())&&(b.getSelection?(d=i.startContainer,e=i.startOffset):(d=i.parentElement(),h=o[0].selection.createRange(),h.moveToElementText(d),h.setEndPoint("EndToStart",i),e=h.text.length),0===e&&(j=ob()))){for(;d!==j;){for(;d.previousSibling;)if(d=d.previousSibling,3!==d.nodeType||d.nodeValue)return;if(!(d=d.parentNode))return}if(j&&!a(j).is("body"))return g.clearBlockFormatting(j),!1}},ob=function(){for(var b=C;!a.sceditor.dom.hasStyling(b);)if(!(b=b.parentNode)||a(b).is("body"))return;return b},g.clearBlockFormatting=function(b){return b=b||ob(),!b||a(b).is("body")?this:(w.saveRange(),t=null,b.className="",a(b).attr("style",""),a(b).is("p,div")||a.sceditor.dom.convertElement(b,"p"),w.restoreRange(),this)},pb=function(b){if(A.hasHandler("valuechangedEvent")||pb.hasHandler){var c,d=g.sourceMode(),e=!d&&w.hasSelection();b=b!==!1&&!o[0].getElementById("sceditor-start-marker"),rb.timer&&(clearTimeout(rb.timer),rb.timer=!1),e&&b&&w.saveRange(),c=n.html(),c===pb.lastHtmlValue&&(pb.lastHtmlValue=c,j.trigger(a.Event("valuechanged",{rawValue:d?g.val():c}))),e&&b&&w.removeMarkers()}},qb=function(){rb.timer&&pb()},rb=function(a){var b=a.which,c=rb.lastChar,d=13===c||32===c,e=8===c||46===c;rb.lastChar=b,13===b||32===b?d?rb.triggerNextChar=!0:pb():8===b||46===b?e?rb.triggerNextChar=!0:pb():rb.triggerNextChar&&(pb(),rb.triggerNextChar=!1),rb.timer&&clearTimeout(rb.timer),rb.timer=setTimeout(function(){pb()},1500)},J()},a.sceditor.ie=function(){var a,d=3,e=c.createElement("div"),f=e.getElementsByTagName("i");do e.innerHTML="<!--[if gt IE "+ ++d+"]><i></i><![endif]-->";while(f[0]);return c.documentMode&&c.all&&b.atob&&(d=10),4===d&&c.documentMode&&(d=11),d>4?d:a}(),a.sceditor.ios=/iPhone|iPod|iPad| wosbrowser\//i.test(navigator.userAgent),a.sceditor.isWysiwygSupported=function(){var b,c,d=a('<div contenteditable="true">')[0].contentEditable,e="undefined"!=typeof d&&"inherit"!==d,f=navigator.userAgent;return e?(c=/Opera Mobi|Opera Mini/i.test(f),/Android/i.test(f)&&(c=!0,/Safari/.test(f)&&(b=/Safari\/(\d+)/.exec(f),c=b&&b[1]?b[1]<534:!0)),/ Silk\//i.test(f)&&(b=/AppleWebKit\/(\d+)/.exec(f),c=b&&b[1]?b[1]<534:!0),a.sceditor.ios&&(c=!/OS [5-9](_\d)+ like Mac OS X/i.test(f)),/fennec/i.test(f)&&(c=!1),/OneBrowser/i.test(f)&&(c=!1),"UCWEB"===navigator.vendor&&(c=!1),!c):!1}(),a.sceditor.regexEscape=function(a){return a.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},a.sceditor.escapeEntities=function(a){return a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ {2}/g," &nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />"):a},a.sceditor.locale={},a.sceditor.commands={bold:{exec:"bold",tooltip:"Bold",shortcut:"ctrl+b"},italic:{exec:"italic",tooltip:"Italic",shortcut:"ctrl+i"},underline:{exec:"underline",tooltip:"Underline",shortcut:"ctrl+u"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(b,c,d){for(var f=b.opts.fonts.split(","),g=a("<div />"),h=function(){return d(a(this).data("font")),b.closeDropDown(!0),!1},i=0;i<f.length;i++)g.append(e("fontOpt",{font:f[i]},!0).click(h));b.createDropDown(c,"font-picker",g)},exec:function(b){var c=this;a.sceditor.command.get("font")._dropDown(c,b,function(a){c.execCommand("fontname",a)})},tooltip:"Font Name"},size:{_dropDown:function(b,c,d){for(var f=a("<div />"),g=function(c){d(a(this).data("size")),b.closeDropDown(!0),c.preventDefault()},h=1;7>=h;h++)f.append(e("sizeOpt",{size:h},!0).click(g));b.createDropDown(c,"fontsize-picker",f)},exec:function(b){var c=this;a.sceditor.command.get("size")._dropDown(c,b,function(a){c.execCommand("fontsize",a)})},tooltip:"Font Size"},color:{_dropDown:function(b,c,d){var e,f,g,h,i={r:255,g:255,b:255},j=a("<div />"),k=b.opts.colors?b.opts.colors.split("|"):new Array(21),l=[],m=a.sceditor.command.get("color");if(!m._htmlCache){for(e=0;e<k.length;++e){for(h=k[e]?k[e].split(","):new Array(21),l.push('<div class="sceditor-color-column">'),f=0;f<h.length;++f)g=h[f]||"#"+i.r.toString(16)+i.g.toString(16)+i.b.toString(16),l.push('<a href="#" class="sceditor-color-option" style="background-color: '+g+'" data-color="'+g+'"></a>'),0===f%5?(i.g-=51,i.b=255):i.b-=51;l.push("</div>"),0===e%5?(i.r-=51,i.g=255,i.b=255):(i.g=255,i.b=255)}m._htmlCache=l.join("")}j.append(m._htmlCache).find("a").click(function(c){d(a(this).attr("data-color")),b.closeDropDown(!0),c.preventDefault()}),b.createDropDown(c,"color-picker",j)},exec:function(b){var c=this;a.sceditor.command.get("color")._dropDown(c,b,function(a){c.execCommand("forecolor",a)})},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(a){var b,c=this,d=e("pastetext",{label:c._("Paste your text inside the following box:"),insert:c._("Insert")},!0);d.find(".button").click(function(a){b=d.find("#txt").val(),b&&c.wysiwygEditorInsertText(b),c.closeDropDown(!0),a.preventDefault()}),c.createDropDown(a,"pastetext",d)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},indent:{state:function(b,c){var d,e,f,g=a(c),h=g.parents("ul,ol,menu").length;if(h>1||h>0&&c.parentNode.children.length>1)return 0;if(g.is("ul,ol,menu")){if(d=this.getRangeHelper().selectedRange(),!(d instanceof Range))return g.is("li")?0:-1;if(e=d.startContainer.parentNode,f=d.endContainer.parentNode,e!==e.parentNode.firstElementChild||a(f).is("li")&&f!==f.parentNode.lastElementChild)return 0}return-1},exec:function(){var b=this,c=a(b.getRangeHelper().getFirstBlockParent());b.focus(),c.parents("ul,ol,menu")&&b.execCommand("indent")},tooltip:"Add indent"},outdent:{state:function(b,c){return a(c).is("ul,ol,menu")||a(c).parents("ul,ol,menu").length>0?0:-1},exec:function(){var b=this,c=a(b.getRangeHelper().getFirstBlockParent());c.parents("ul,ol,menu")&&b.execCommand("outdent")},tooltip:"Remove one indent"},table:{exec:function(b){var c=this,d=e("table",{rows:c._("Rows:"),cols:c._("Cols:"),insert:c._("Insert")},!0);d.find(".button").click(function(b){var e=d.find("#rows").val()-0,f=d.find("#cols").val()-0,g="<table>";
if(!(1>e||1>f)){for(var h=0;e>h;h++){g+="<tr>";for(var i=0;f>i;i++)g+="<td>"+(a.sceditor.ie?"":"<br />")+"</td>";g+="</tr>"}g+="</table>",c.wysiwygEditorInsertHtml(g),c.closeDropDown(!0),b.preventDefault()}}),c.createDropDown(b,"inserttable",d)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{forceNewLineAfter:["code"],exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(a){var b=this,c=e("image",{url:b._("URL:"),width:b._("Width (optional):"),height:b._("Height (optional):"),insert:b._("Insert")},!0);c.find(".button").click(function(a){var d=c.find("#image").val(),e=c.find("#width").val(),f=c.find("#height").val(),g="";e&&(g+=' width="'+e+'"'),f&&(g+=' height="'+f+'"'),d&&"http://"!==d&&b.wysiwygEditorInsertHtml("<img"+g+' src="'+d+'" />'),b.closeDropDown(!0),a.preventDefault()}),b.createDropDown(a,"insertimage",c)},tooltip:"Insert an image"},email:{exec:function(a){var b=this,c=e("email",{label:b._("E-mail:"),insert:b._("Insert")},!0);c.find(".button").click(function(a){var d=c.find("#email").val();d&&(b.focus(),b.getRangeHelper().selectedHtml()?b.execCommand("createlink","mailto:"+d):b.wysiwygEditorInsertHtml('<a href="mailto:'+d+'">'+d+"</a>")),b.closeDropDown(!0),a.preventDefault()}),b.createDropDown(a,"insertemail",c)},tooltip:"Insert an email"},link:{exec:function(a){var b=this,c=e("link",{url:b._("URL:"),desc:b._("Description (optional):"),ins:b._("Insert")},!0);c.find(".button").click(function(a){var d=c.find("#link").val(),e=c.find("#des").val();d&&"http://"!==d&&(b.focus(),!b.getRangeHelper().selectedHtml()||e?(e||(e=d),b.wysiwygEditorInsertHtml('<a href="'+d+'">'+e+"</a>")):b.execCommand("createlink",d)),b.closeDropDown(!0),a.preventDefault()}),b.createDropDown(a,"insertlink",c)},tooltip:"Insert a link"},unlink:{state:function(){var b=a(this.currentNode());return b.is("a")||b.parents("a").length>0?0:-1},exec:function(){var b=a(this.currentNode()),c=b.is("a")?b:b.parents("a").first();c.length&&c.replaceWith(c.contents())},tooltip:"Unlink"},quote:{forceNewLineAfter:["blockquote"],exec:function(b,c,d){var e="<blockquote>",f="</blockquote>";c?(d=d?"<cite>"+d+"</cite>":"",e=e+d+c+f,f=null):""===this.getRangeHelper().selectedHtml()&&(f=a.sceditor.ie?"":"<br />"+f),this.wysiwygEditorInsertHtml(e,f)},tooltip:"Insert a Quote"},emoticon:{exec:function(b){var c=this,d=function(e){var f=c.opts.emoticonsCompat,g=c.getRangeHelper(),h=f&&" "!==g.getOuterText(!0,1)?" ":"",i=f&&" "!==g.getOuterText(!1,1)?" ":"",j=a("<div />"),k=a("<div />").appendTo(j),l=a.extend({},c.opts.emoticons.dropdown,e?c.opts.emoticons.more:{}),m=0;return a.each(l,function(){m++}),m=Math.sqrt(m),a.each(l,function(b,d){k.append(a("<img />").attr({src:d.url||d,alt:b,title:d.tooltip||b}).click(function(){return c.insert(h+a(this).attr("alt")+i,null,!1).closeDropDown(!0),!1})),k.children().length>=m&&(k=a("<div />").appendTo(j))}),e||j.append(a(c._('<a class="sceditor-more">{0}</a>',c._("More"))).click(function(){return c.createDropDown(b,"more-emoticons",d(!0)),!1})),j};c.createDropDown(b,"emoticons",d(!1))},txtExec:function(b){a.sceditor.command.get("emoticon").exec.call(this,b)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(a,b,c){var d,f=e("youtubeMenu",{label:a._("Video URL:"),insert:a._("Insert")},!0);f.find(".button").click(function(b){var e=f.find("#link").val().replace("http://","");""!==e&&(d=e.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),d&&(e=d[1]),/^[a-zA-Z0-9_\-]{11}$/.test(e)?c(e):alert("Invalid YouTube video")),a.closeDropDown(!0),b.preventDefault()}),a.createDropDown(b,"insertlink",f)},exec:function(b){var c=this;a.sceditor.command.get("youtube")._dropDown(c,b,function(a){c.wysiwygEditorInsertHtml(e("youtube",{id:a}))})},tooltip:"Insert a YouTube video"},date:{_date:function(a){var b=new Date,c=b.getYear(),d=b.getMonth()+1,e=b.getDate();return 2e3>c&&(c=1900+c),10>d&&(d="0"+d),10>e&&(e="0"+e),a.opts.dateFormat.replace(/year/i,c).replace(/month/i,d).replace(/day/i,e)},exec:function(){this.insertText(a.sceditor.command.get("date")._date(this))},txtExec:function(){this.insertText(a.sceditor.command.get("date")._date(this))},tooltip:"Insert current date"},time:{_time:function(){var a=new Date,b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();return 10>b&&(b="0"+b),10>c&&(c="0"+c),10>d&&(d="0"+d),b+":"+c+":"+d},exec:function(){this.insertText(a.sceditor.command.get("time")._time())},txtExec:function(){this.insertText(a.sceditor.command.get("time")._time())},tooltip:"Insert current time"},ltr:{state:function(a,b){return b&&"ltr"===b.style.direction},exec:function(){var b=this,c=b.getRangeHelper().getFirstBlockParent(),d=a(c);b.focus(),(c&&!d.is("body")||(b.execCommand("formatBlock","p"),c=b.getRangeHelper().getFirstBlockParent(),d=a(c),c&&!d.is("body")))&&("ltr"===d.css("direction")?d.css("direction",""):d.css("direction","ltr"))},tooltip:"Left-to-Right"},rtl:{state:function(a,b){return b&&"rtl"===b.style.direction},exec:function(){var b=this,c=b.getRangeHelper().getFirstBlockParent(),d=a(c);b.focus(),(c&&!d.is("body")||(b.execCommand("formatBlock","p"),c=b.getRangeHelper().getFirstBlockParent(),d=a(c),c&&!d.is("body")))&&("rtl"===d.css("direction")?d.css("direction",""):d.css("direction","rtl"))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize",shortcut:"ctrl+shift+m"},source:{exec:function(){this.toggleSourceMode()},txtExec:function(){this.toggleSourceMode()},tooltip:"View source",shortcut:"ctrl+shift+s"},ignore:{}},a.sceditor.rangeHelper=function(b,c){var d,e,f,g=c||b.contentDocument||b.document,h=b,i=!!b.getSelection,j="sceditor-start-marker",k="sceditor-end-marker",l="character",m=this;m.insertHTML=function(a,b){var c,d,e=m.selectedRange();if(i){for(b&&(a+=m.selectedHtml()+b),d=g.createElement("div"),c=g.createDocumentFragment(),d.innerHTML=a;d.firstChild;)c.appendChild(d.firstChild);m.insertNode(c)}else{if(!e)return!1;e.pasteHTML(f(a,b,!0))}},f=function(b,c,e){var f,h,i,l=g.createElement("div");if("string"==typeof b?(c&&(b+=m.selectedHtml()+c),l.innerHTML=b):(l.appendChild(b),c&&(l.appendChild(range.extractContents()),l.appendChild(c))),f=l.lastChild){if(m.removeMarkers(),h=a(f),1===f.nodeType?(f.lastChild||h.append(g.createTextNode("\u200b")),h.append(d(k)).append(d(j))):h.after(d(j)).after(d(k)),e)return l.innerHTML;for(i=g.createDocumentFragment();l.firstChild;)i.appendChild(l.firstChild);return i}},m.insertNode=function(a,b){if(i){var c=f(a,b),d=m.selectedRange(),e=d.commonAncestorContainer;if(!c)return!1;d.deleteContents(),e&&/^(br|hr)$/i.test(e.nodeName)?e.parentNode.insertBefore(c,e):d.insertNode(c),m.restoreRange()}else m.insertHTML(a.outerHTML,b?b.outerHTML:null)},m.cloneSelected=function(){var a=m.selectedRange();return a?i?a.cloneRange():a.duplicate():void 0},m.selectedRange=function(){var a,b,c=i?h.getSelection():g.selection;if(c){if(c.getRangeAt&&c.rangeCount<=0){for(b=g.body;b.firstChild;)b=b.firstChild;a=g.createRange(),a.setStart(b,0),c.addRange(a)}return i&&(a=c.getRangeAt(0)),i||"Control"===c.type||(a=c.createRange()),e(a)?a:null}},e=function(a){var b;return a&&a.parentElement&&(b=a.parentElement())?b.ownerDocument===g:!0},m.hasSelection=function(){var a,b=i?h.getSelection():g.selection;return i||!b?b&&b.rangeCount>0:(a=b.createRange(),a&&e(a))},m.selectedHtml=function(){var a,b=m.selectedRange();return b?!i&&""!==b.text&&b.htmlText?b.htmlText:i?(a=g.createElement("div"),a.appendChild(b.cloneContents()),a.innerHTML):"":""},m.parentNode=function(){var a=m.selectedRange();return a?a.parentElement?a.parentElement():a.commonAncestorContainer:void 0},m.getFirstBlockParent=function(b){var c=function(b){return a.sceditor.dom.isInline(b,!0)?(b=b?b.parentNode:null,b?c(b):null):b};return c(b||m.parentNode())},m.insertNodeAt=function(a,b){var c=m.selectedRange(),d=m.cloneSelected();return d?(d.collapse(a),d.insertNode?d.insertNode(b):d.pasteHTML(b.outerHTML),m.selectRange(c),void 0):!1},d=function(a){m.removeMarker(a);var b=g.createElement("span");return b.id=a,b.style.lineHeight="0",b.style.display="none",b.className="sceditor-selection sceditor-ignore",b.innerHTML=" ",b},m.insertMarkers=function(){m.insertNodeAt(!0,d(j)),m.insertNodeAt(!1,d(k))},m.getMarker=function(a){return g.getElementById(a)},m.removeMarker=function(a){var b=m.getMarker(a);b&&b.parentNode.removeChild(b)},m.removeMarkers=function(){m.removeMarker(j),m.removeMarker(k)},m.saveRange=function(){m.insertMarkers()},m.selectRange=function(a){i?(h.getSelection().removeAllRanges(),h.getSelection().addRange(a)):a.select()},m.restoreRange=function(){var a,b=m.selectedRange(),c=m.getMarker(j),d=m.getMarker(k);return c&&d&&b?(i?(b=g.createRange(),b.setStartBefore(c),b.setEndAfter(d)):(b=g.body.createTextRange(),a=g.body.createTextRange(),a.moveToElementText(c),b.setEndPoint("StartToStart",a),b.moveStart(l,0),a.moveToElementText(d),b.setEndPoint("EndToStart",a),b.moveEnd(l,0)),m.selectRange(b),m.removeMarkers(),void 0):!1},m.selectOuterText=function(a,b){var c=m.cloneSelected();return c?(c.collapse(!1),i?(c.setStart(c.startContainer,c.startOffset-a),c.setEnd(c.endContainer,c.endOffset+b)):(c.moveStart(l,0-a),c.moveEnd(l,b)),m.selectRange(c),void 0):!1},m.getOuterText=function(a,b){var c="",d=m.cloneSelected();return d?(d.collapse(!1),a?i?(c=d.startContainer.textContent.substr(0,d.startOffset),c=c.substr(Math.max(0,c.length-b))):(d.moveStart(l,0-b),c=d.text):i?c=d.startContainer.textContent.substr(d.startOffset,b):(d.moveEnd(l,b),c=d.text),c):""},m.raplaceKeyword=function(b,c,d,e,f,g){d||b.sort(function(a,b){return a.length-b.length});var h,j,k,l,n,o,p,q=b.length,r=e||b[q-1][0].length;if(f){if(!i)return!1;++r}for(h=m.getOuterText(!0,r),j=h+(null!=g?g:""),c&&(j+=m.getOuterText(!1,r));q--;)if(p=b[q][0],n=new RegExp("(?:[\\s\xa0\u2002\u2003\u2009])"+a.sceditor.regexEscape(p)+"(?=[\\s\xa0\u2002\u2003\u2009])"),o=h.length-1-p.length,f&&--o,o=Math.max(0,o),(k=f?j.substr(o).search(n):j.indexOf(p,o))>-1){if(f&&(k+=o+1),k>h.length||k+p.length+(f?1:0)<h.length)continue;return l=h.length-k,m.selectOuterText(l,p.length-l-(null!=g&&/^\S/.test(g)?1:0)),m.insertHTML(b[q][1]),!0}return!1},m.compare=function(a,b){return b||(b=m.selectedRange()),a&&b?i?0===a.compareBoundaryPoints(Range.END_TO_END,b)&&0===a.compareBoundaryPoints(Range.START_TO_START,b):e(a)&&e(b)&&0===a.compareEndPoints("EndToEnd",b)&&0===a.compareEndPoints("StartToStart",b):!a&&!b}},a.sceditor.dom={traverse:function(a,b,c,d,e){if(a)for(a=e?a.lastChild:a.firstChild;null!=a;){var f=e?a.previousSibling:a.nextSibling;if(!c&&b(a)===!1)return!1;if(!d&&this.traverse(a,b,c,d,e)===!1)return!1;if(c&&b(a)===!1)return!1;a=f}},rTraverse:function(a,b,c,d){this.traverse(a,b,c,d,!0)},parseHTML:function(b,d){var e=[],f=(d||c).createElement("div");return f.innerHTML=b,a.merge(e,f.childNodes),e},hasStyling:function(b){var c=a(b);return b&&(!c.is("p,div")||b.className||c.attr("style")||!a.isEmptyObject(c.data()))},convertElement:function(b,c){for(var d,e,f=b.attributes.length,g=b.ownerDocument.createElement(c);f--;)e=b.attributes[f],(!a.sceditor.ie||e.specified)&&(a.sceditor.ie<8&&/style/i.test(e.name)?b.style.cssText=b.style.cssText:g.setAttribute(e.name,e.value));for(;d=b.firstChild;)g.appendChild(d);return b.parentNode.replaceChild(g,b),g},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",isInline:function(b,c){return b&&1===b.nodeType?(b=b.tagName.toLowerCase(),"code"===b?!c:a.sceditor.dom.blockLevelList.indexOf("|"+b+"|")<0):!0},copyCSS:function(a,b){b.style.cssText=a.style.cssText+b.style.cssText},fixNesting:function(a){var b=this,c=function(a){for(;b.isInline(a.parentNode,!0);)a=a.parentNode;return a};b.traverse(a,function(a){if(1===a.nodeType&&!b.isInline(a,!0)&&b.isInline(a.parentNode,!0)){var d=c(a),e=d.parentNode,f=b.extractContents(d,a),g=a;b.copyCSS(d,g),e.insertBefore(f,d),e.insertBefore(g,d)}})},findCommonAncestor:function(b,c){return a(b).parents().has(a(c)).first()},getSibling:function(b,c){var d;return b?(d=b[c?"previousSibling":"nextSibling"])?d:a.sceditor.dom.getSibling(b.parentNode,c):null},removeWhiteSpace:function(b,c){for(var d,e,f,g,h,i,j,k,l=a.sceditor.dom.getSibling,m=a.sceditor.dom.isInline,n=b.firstChild,o=/[\t ]+/g,p=/[\t\n\r ]+/g;n;){if(i=n.nextSibling,d=n.nodeValue,e=n.nodeType,1===e&&n.firstChild&&(h=a(n).css("whiteSpace"),/pre(?:\-wrap)?$/i.test(h)||a.sceditor.dom.removeWhiteSpace(n,/line$/i.test(h))),3===e&&d){for(f=l(n),g=l(n,!0),k=g,j=!1;a(k).hasClass("sceditor-ignore");)k=l(k,!0);if(m(n)&&k){for(;k.lastChild;)k=k.lastChild;j=3===k.nodeType?/[\t\n\r ]$/.test(k.nodeValue):!m(k)}m(n)&&g&&m(g)&&!j||(d=d.replace(/^[\t\n\r ]+/,"")),m(n)&&f&&m(f)||(d=d.replace(/[\t\n\r ]+$/,"")),d=d.replace(/\u200B/g,""),d.length?n.nodeValue=d.replace(c?o:p," "):b.removeChild(n)}n=i}},extractContents:function(a,b){var c=this,d=c.findCommonAncestor(a,b),e=d?d[0]:null,f=!1,g=!1;return function h(d){var e=a.ownerDocument.createDocumentFragment();return c.traverse(d,function(c){if(g||c===b&&f)return g=!0,!1;c===a&&(f=!0);var d,i;f?jQuery.contains(c,b)&&1===c.nodeType?(d=h(c),i=c.cloneNode(!1),i.appendChild(d),e.appendChild(i)):e.appendChild(c):jQuery.contains(c,a)&&1===c.nodeType&&(d=h(c),i=c.cloneNode(!1),i.appendChild(d),e.appendChild(i))},!1),e}(e)},getOffset:function(a){for(var b=0,c=0;a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{left:b,top:c}}},a.sceditor.plugins={},a.sceditor.PluginManager=function(b){var c=this,d=[],e=b,f=function(a){return"signal"+a.charAt(0).toUpperCase()+a.slice(1)},g=function(a,b){a=[].slice.call(a);for(var c=d.length,g=f(a.shift());c--;)if(g in d[c]){if(b)return d[c][g].apply(e,a);d[c][g].apply(e,a)}};c.call=function(){g(arguments,!1)},c.callOnlyFirst=function(){return g(arguments,!0)},c.iter=function(a){return a=f(a),function(){var b=d.length;return{callNext:function(c){for(;b--;)if(d[b]&&a in d[b])return d[b].apply(e,c)},hasNext:function(){for(var c=b;c--;)if(d[c]&&a in d[c])return!0;return!1}}}()},c.hasHandler=function(a){var b=d.length;for(a=f(a);b--;)if(a in d[b])return!0;return!1},c.exsists=function(b){return b in a.sceditor.plugins?(b=a.sceditor.plugins[b],"function"==typeof b&&"object"==typeof b.prototype):!1},c.isRegistered=function(b){var e=d.length;if(!c.exsists(b))return!1;for(;e--;)if(d[e]instanceof a.sceditor.plugins[b])return!0;return!1},c.register=function(b){return c.exsists(b)?(b=new a.sceditor.plugins[b],d.push(b),"init"in b&&b.init.apply(e),!0):!1},c.deregister=function(b){var f,g=d.length,h=!1;if(!c.isRegistered(b))return!1;for(;g--;)d[g]instanceof a.sceditor.plugins[b]&&(f=d.splice(g,1)[0],h=!0,"destroy"in f&&f.destroy.apply(e));return h},c.destroy=function(){for(var a=d.length;a--;)"destroy"in d[a]&&d[a].destroy.apply(e);d=null,e=null}},a.sceditor.command={get:function(b){return a.sceditor.commands[b]||null},set:function(b,c){return b&&c?(c=a.extend(a.sceditor.commands[b]||{},c),c.remove=function(){a.sceditor.command.remove(b)},a.sceditor.commands[b]=c,this):!1},remove:function(b){return a.sceditor.commands[b]&&delete a.sceditor.commands[b],this}},a.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist,indent,outdent|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,parserOptions:{},dropDownCss:{}},a.fn.sceditor=function(b){var c,d=[];return b=b||{},b.runWithoutWysiwygSupport||a.sceditor.isWysiwygSupported?(this.each(function(){c=this.jquery?this:a(this),c.parents(".sceditor-container").length>0||("state"===b?d.push(!!c.data("sceditor")):"instance"===b?d.push(c.data("sceditor")):c.data("sceditor")||new a.sceditor(this,b))}),d.length?1===d.length?d[0]:a(d):this):void 0}}(jQuery,window,document);