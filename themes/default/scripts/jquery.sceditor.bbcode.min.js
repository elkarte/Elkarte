/* SCEditor v1.4.5 | (C) 2011-2013, Sam Clarke | sceditor.com/license */
!function(e,t,n){"use strict";var r=e.sceditor.escapeEntities,i=e.sceditor.escapeUriScheme,o=e.sceditor.ie,l=o&&11>o;e.sceditor.BBCodeParser=function(t){if(!(this instanceof e.sceditor.BBCodeParser))return new e.sceditor.BBCodeParser(t);var i,s,a,c,u,d,f,h,p,b,m,g,y,v,x,B=this,k={open:"open",content:"content",newline:"newline",close:"close"},w=function(e,t,n,r,i,o){var l=this;l.type=e,l.name=t,l.val=n,l.attrs=r||{},l.children=i||[],l.closing=o||null};w.prototype={clone:function(e){var t=this;return new w(t.type,t.name,t.val,t.attrs,e?t.children:[],t.closing?t.closing.clone():null)},splitAt:function(t){var n,r=this,i=0,o=r.children.length;if("number"!=typeof t&&(t=e.inArray(t,r.children)),0>t||t>o)return null;for(;o--;)t>o?o=0:i++;return n=r.clone(),n.children=r.children.splice(t,i),n}},i=function(){B.opts=e.extend({},e.sceditor.BBCodeParser.defaults,t),B.bbcodes=e.sceditor.plugins.bbcode.bbcodes},B.tokenize=function(e){var t,n,r,i=[],o=[{type:"close",regex:/^\[\/[^\[\]]+\]/},{type:"open",regex:/^\[[^\[\]]+\]/},{type:"newline",regex:/^(\r\n|\r|\n)/},{type:"content",regex:/^([^\[\r\n]+|\[)/}];o.reverse();e:for(;e.length;){for(r=o.length;r--;)if(n=o[r].type,(t=e.match(o[r].regex))&&t[0]){i.push(s(n,t[0])),e=e.substr(t[0].length);continue e}e.length&&i.push(s(k.content,e)),e=""}return i},s=function(t,n){var r,i,o;return"open"===t&&(r=n.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/))?(o=v(r[1]),r[2]&&(r[2]=e.trim(r[2]))&&(i=a(r[2]))):"close"===t&&(r=n.match(/\[\/([^\[\]]+)\]/))?o=v(r[1]):"newline"===t&&(o="#newline"),o&&("open"!==t&&"close"!==t||e.sceditor.plugins.bbcode.bbcodes[o])||(t="content",o="#"),new w(t,o,n,i)},a=function(t){var n,r=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,i=e.sceditor.plugins.bbcode.stripQuotes,o={};if("="===t.charAt(0)&&t.indexOf("=",1)<0)o.defaultattr=i(t.substr(1));else for("="===t.charAt(0)&&(t="defaultattr"+t);n=r.exec(t);)o[v(n[1])]=i(n[3])||n[4];return o},B.parse=function(e,t){var n=c(B.tokenize(e));return B.opts.fixInvalidChildren&&p(n),B.opts.removeEmptyTags&&h(n),B.opts.fixInvalidNesting&&d(n),u(n,null,t),B.opts.removeEmptyTags&&h(n),n},g=function(e,t,n){for(var r=n.length;r--;)if(n[r].type===t&&n[r].name===e)return!0;return!1},f=function(t,n){var r=t?B.bbcodes[t.name]:null,i=r?r.allowedChildren:null;return B.opts.fixInvalidChildren&&i&&i&&e.inArray(n.name||"#",i)<0?!1:!0},c=function(t){for(var n,r,i,o,l,s,a,c=[],u=[],d=[],f=function(){return x(d)},h=function(e){f()?f().children.push(e):u.push(e)},p=function(t){return f()&&(r=B.bbcodes[f().name])&&r.closedBy&&e.inArray(t,r.closedBy)>-1};n=t.shift();){switch(a=t[0],n.type){case k.open:p(n.name)&&d.pop(),h(n),r=B.bbcodes[n.name],r&&r.isSelfClosing||!r.closedBy&&!g(n.name,k.close,t)?r&&r.isSelfClosing||(n.type=k.content):d.push(n);break;case k.close:if(f()&&n.name!==f().name&&p("/"+n.name)&&d.pop(),f()&&n.name===f().name)f().closing=n,d.pop();else if(g(n.name,k.open,d)){for(;i=d.pop();){if(i.name===n.name){i.closing=n;break}o=i.clone(),c.length>1&&o.children.push(x(c)),c.push(o)}for(h(x(c)),l=c.length;l--;)d.push(c[l]);c.length=0}else n.type=k.content,h(n);break;case k.newline:f()&&a&&p((a.type===k.close?"/":"")+a.name)&&(a.type!==k.close||a.name!==f().name)&&(r=B.bbcodes[f().name],r&&r.breakAfter?d.pop():r&&r.isInline===!1&&B.opts.breakAfterBlock&&r.breakAfter!==!1&&d.pop()),h(n);break;default:h(n)}s=n}return u},u=function(e,t,n){var r,i,o,l,s,a,c,d,f=e.length,h=f;for(t&&(l=B.bbcodes[t.name]);h--;)if(r=e[h])if(r.type===k.newline){if(i=h>0?e[h-1]:null,o=f-1>h?e[h+1]:null,d=!1,!n&&l&&l.isSelfClosing!==!0&&(i?a||o||(l.isInline===!1&&B.opts.breakEndBlock&&l.breakEnd!==!1&&(d=!0),l.breakEnd&&(d=!0),a=d):(l.isInline===!1&&B.opts.breakStartBlock&&l.breakStart!==!1&&(d=!0),l.breakStart&&(d=!0))),i&&i.type===k.open&&(s=B.bbcodes[i.name])&&(n?s.isInline===!1&&(d=!0):(s.isInline===!1&&B.opts.breakAfterBlock&&s.breakAfter!==!1&&(d=!0),s.breakAfter&&(d=!0))),!n&&!c&&o&&o.type===k.open&&(s=B.bbcodes[o.name])&&(s.isInline===!1&&B.opts.breakBeforeBlock&&s.breakBefore!==!1&&(d=!0),s.breakBefore&&(d=!0),c=d,d)){e.splice(h,1);continue}d&&e.splice(h,1),c=!1}else r.type===k.open&&u(r.children,r,n)},d=function(t,n,r,i){var o,l,s,a,c,u,f=function(e){var t=B.bbcodes[e.name];return!t||t.isInline!==!1};for(n=n||[],i=i||t,l=0;l<t.length;l++)if((o=t[l])&&o.type===k.open){if(!f(o)&&r&&(s=x(n),u=s.splitAt(o),c=n.length>1?n[n.length-2].children:i,(a=e.inArray(s,c))>-1))return u.children.splice(e.inArray(o,u.children),1),void c.splice(a+1,0,o,u);n.push(o),d(o.children,n,r||f(o),i),n.pop(o)}},p=function(e,t){for(var n,r,i=e.length;i--;)(n=e[i])&&(f(t,n)||(n.name=null,n.type=k.content,f(t,n)?(r=[i+1,0].concat(n.children),n.closing&&(n.closing.name=null,n.closing.type=k.content,r.push(n.closing)),i+=r.length-1,Array.prototype.splice.apply(e,r)):t.children.splice(i,1)),n.type===k.open&&p(n.children,n))},h=function(t){var n,r,i,o=t.length;for(i=function(e){for(var t=e.length;t--;){if(e[t].type===k.open)return!1;if(e[t].type===k.close)return!1;if(e[t].type===k.content&&e[t].val&&/\S|\u00A0/.test(e[t].val))return!1}return!0};o--;)(n=t[o])&&n.type===k.open&&(r=B.bbcodes[n.name],h(n.children),i(n.children)&&r&&!r.isSelfClosing&&!r.allowsEmpty&&t.splice.apply(t,e.merge([o,1],n.children)))},B.toHTML=function(e,t){return b(B.parse(e,t),!0)},b=function(t,i){var s,a,c,u,d,f,h,p,m=[];for(h=function(e){return(!e||(void 0!==e.isHtmlInline?e.isHtmlInline:e.isInline))!==!1};t.length>0;)if(s=t.shift()){if(s.type===k.open)p=s.children[s.children.length-1]||{},a=B.bbcodes[s.name],d=i&&h(a),c=b(s.children,!1),a&&a.html?(h(a)||!h(B.bbcodes[p.name])||a.isPreFormatted||a.skipLastLineBreak||l||(c+="<br />"),e.isFunction(a.html)?u=a.html.call(B,s,s.attrs,c):(s.attrs[0]=c,u=e.sceditor.plugins.bbcode.formatBBCodeString(a.html,s.attrs))):u=s.val+c+(s.closing?s.closing.val:"");else{if(s.type===k.newline){if(!i){m.push("<br />");continue}f||(m.push("<div>"),(n.documentMode&&n.documentMode<8||8>o)&&m.push(" ")),l||m.push("<br />"),t.length||m.push("<br />"),m.push("</div>\n"),f=!1;continue}d=i,u=r(s.val,!0)}d&&!f?(m.push("<div>"),f=!0):!d&&f&&(m.push("</div>\n"),f=!1),m.push(u)}return f&&m.push("</div>\n"),m.join("")},B.toBBCode=function(e,t){return m(B.parse(e,t))},m=function(t){for(var n,r,i,o,l,s,a,c,u,d,f=[];t.length>0;)if(n=t.shift())if(i=B.bbcodes[n.name],o=!(!i||i.isInline!==!1),l=i&&i.isSelfClosing,a=o&&B.opts.breakBeforeBlock&&i.breakBefore!==!1||i&&i.breakBefore,c=o&&!l&&B.opts.breakStartBlock&&i.breakStart!==!1||i&&i.breakStart,u=o&&B.opts.breakEndBlock&&i.breakEnd!==!1||i&&i.breakEnd,d=o&&B.opts.breakAfterBlock&&i.breakAfter!==!1||i&&i.breakAfter,s=(i?i.quoteType:null)||B.opts.quoteType||e.sceditor.BBCodeParser.QuoteType.auto,i||n.type!==k.open)if(n.type===k.open){if(a&&f.push("\n"),f.push("["+n.name),n.attrs){n.attrs.defaultattr&&(f.push("="+y(n.attrs.defaultattr,s,"defaultattr")),delete n.attrs.defaultattr);for(r in n.attrs)n.attrs.hasOwnProperty(r)&&f.push(" "+r+"="+y(n.attrs[r],s,r))}f.push("]"),c&&f.push("\n"),n.children&&f.push(m(n.children)),l||i.excludeClosing||(u&&f.push("\n"),f.push("[/"+n.name+"]")),d&&f.push("\n"),n.closing&&l&&f.push(n.closing.val)}else f.push(n.val);else f.push(n.val),n.children&&f.push(m(n.children)),n.closing&&f.push(n.closing.val);return f.join("")},y=function(t,n,r){var i=e.sceditor.BBCodeParser.QuoteType,o=/\s|=/.test(t);return e.isFunction(n)?n(t,r):n===i.never||n===i.auto&&!o?t:'"'+t.replace("\\","\\\\").replace('"','\\"')+'"'},x=function(e){return e.length?e[e.length-1]:null},v=function(e){return e.toLowerCase()},i()},e.sceditor.BBCodeParser.QuoteType={always:1,never:2,auto:3},e.sceditor.BBCodeParser.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:e.sceditor.BBCodeParser.QuoteType.auto},e.sceditorBBCodePlugin=e.sceditor.plugins.bbcode=function(){var t,r,i,o,s,a,c=this;o=e.sceditor.plugins.bbcode.formatString,c.bbcodes=e.sceditor.plugins.bbcode.bbcodes,c.stripQuotes=e.sceditor.plugins.bbcode.stripQuotes;var u={},d={},f={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]};c.init=function(){c.opts=this.opts,t(),s(this),this.toBBCode=c.signalToSource,this.fromBBCode=c.signalToWysiwyg},s=function(t){var n=e.sceditor.command.get,r={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(e){var t=this;n("font")._dropDown(t,e,function(e){t.insertText("[font="+e+"]","[/font]")})}},size:{txtExec:function(e){var t=this;n("size")._dropDown(t,e,function(e){t.insertText("[size="+e+"]","[/size]")})}},color:{txtExec:function(e){var t=this;n("color")._dropDown(t,e,function(e){t.insertText("[color="+e+"]","[/color]")})}},bulletlist:{txtExec:function(n,r){var i="";e.each(r.split(/\r?\n/),function(){i+=(i?"\n":"")+"[li]"+this+"[/li]"}),t.insertText("[ul]\n"+i+"\n[/ul]")}},orderedlist:{txtExec:function(n,r){var i="";e.each(r.split(/\r?\n/),function(){i+=(i?"\n":"")+"[li]"+this+"[/li]"}),e.sceditor.plugins.bbcode.bbcode.get(""),t.insertText("[ol]\n"+i+"\n[/ol]")}},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(e,t){var n=prompt(this._("Enter the image URL:"),t);n&&this.insertText("[img]"+n+"[/img]")}},email:{txtExec:function(e,t){var n=t&&t.indexOf("@")>-1?null:t,r=prompt(this._("Enter the e-mail address:"),n?"":t),i=prompt(this._("Enter the displayed text:"),n||r)||r;r&&this.insertText("[email="+r+"]"+i+"[/email]")}},link:{txtExec:function(t,n){var r=/^[a-z]+:\/\//i.test(e.trim(n))?null:n,i=prompt(this._("Enter URL:"),r?"http://":e.trim(n)),o=prompt(this._("Enter the displayed text:"),r||i)||i;i&&this.insertText("[url="+i+"]"+o+"[/url]")}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(e){var t=this;n("youtube")._dropDown(t,e,function(e){t.insertText("[youtube]"+e+"[/youtube]")})}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}};t.commands=e.extend(!0,{},r,t.commands)},t=function(){e.each(c.bbcodes,function(t){c.bbcodes[t].tags&&e.each(c.bbcodes[t].tags,function(e,n){var r=c.bbcodes[t].isInline===!1;u[e]=u[e]||{},u[e][r]=u[e][r]||{},u[e][r][t]=n}),c.bbcodes[t].styles&&e.each(c.bbcodes[t].styles,function(e,n){var r=c.bbcodes[t].isInline===!1;d[r]=d[r]||{},d[r][e]=d[r][e]||{},d[r][e][t]=n})})},r=function(t,n,r){var i,l,s=e.sceditor.dom.getStyle;return r=!!r,d[r]?(e.each(d[r],function(r,a){i=s(t[0],r),i&&s(t.parent()[0],r)!==i&&e.each(a,function(r,s){(!s||e.inArray(""+i,s)>-1)&&(l=c.bbcodes[r].format,n=e.isFunction(l)?l.call(c,t,n):o(l,n))})}),n):n},i=function(t,n,r){var i,s,a=t[0],d=a.nodeName.toLowerCase();r=!!r,u[d]&&u[d][r]&&e.each(u[d][r],function(r,l){(!l||(i=!1,e.each(l,function(n,r){return!t.attr(n)||r&&e.inArray(t.attr(n),r)<0?void 0:(i=!0,!1)}),i))&&(s=c.bbcodes[r].format,n=e.isFunction(s)?s.call(c,t,n):o(s,n))});var f=e.sceditor.dom.isInline;if(r&&(!f(a,!0)||"br"===d)){for(var h,p,b,m=a.previousSibling;m&&(e(m).hasClass("sceditor-ignore")||1===m.nodeType&&f(m,!0)&&!m.firstChild);)m=m.previousSibling;do{for(p=a.parentNode,b=p.lastChild;e(b).hasClass("sceditor-ignore");)b=b.previousSibling;h=b===a,a=p}while(p&&h&&f(p,!0));(!h||"li"===d||"br"===d&&l)&&"blockquote"!==p.nodeName.toLowerCase()&&"blockquote"!==d&&(n+="\n"),"br"!==d&&m&&!e(m).is("br")&&f(m,!0)&&(n="\n"+n)}return n},c.signalToSource=function(t,r){var i,o,l=new e.sceditor.BBCodeParser(c.opts.parserOptions);return r||("string"==typeof t?(i=e("<div />").css("visibility","hidden").appendTo(n.body).html(t),r=i):r=e(t)),r&&r.jquery?(e.sceditor.dom.removeWhiteSpace(r[0]),o=c.elementToBbcode(r),i&&i.remove(),o=l.toBBCode(o,!0),c.opts.bbcodeTrim&&(o=e.trim(o)),o):""},c.elementToBbcode=function(t){return function n(t,o){var s="";return e.sceditor.dom.traverse(t,function(t){var a=e(t),c="",u=t.nodeType,d=t.nodeName.toLowerCase(),h=f[d],p=t.firstChild,b=!0;if("object"==typeof o&&(b=e.inArray(d,o)>-1,a.is("img")&&a.data("sceditor-emoticon")&&(b=!0),b||(h=o)),3===u||1===u)if(1===u){if(a.hasClass("sceditor-ignore"))return;if(a.hasClass("sceditor-nlf")&&(!p||!l&&1===t.childNodes.length&&/br/i.test(p.nodeName)))return;"iframe"!==d&&(c=n(t,h)),b?("code"!==d&&(c=r(a,c),c=i(a,c),c=r(a,c,!0)),s+=i(a,c,!0)):s+=c}else!t.wholeText||t.previousSibling&&3===t.previousSibling.nodeType?t.wholeText||(s+=t.nodeValue):s+=0===a.parents("code").length?t.wholeText.replace(/ +/g," "):t.wholeText},!1,!0),s}(t[0])},c.signalToWysiwyg=function(t,n){var r=new e.sceditor.BBCodeParser(c.opts.parserOptions),i=r.toHTML(c.opts.bbcodeTrim?e.trim(t):t);return n?a(i):i},a=function(t){var r,i,o,s=e("<div />").hide().appendTo(n.body),a=s[0];return o=function(t,r){if(!e.sceditor.dom.hasStyling(t)){if(l||1!==t.childNodes.length||!e(t.firstChild).is("br"))for(;i=t.firstChild;)a.insertBefore(i,t);if(r){var o=a.lastChild;t!==o&&e(o).is("div")&&t.nextSibling===o&&a.insertBefore(n.createElement("br"),t)}a.removeChild(t)}},a.innerHTML=t.replace(/<\/div>\n/g,"</div>"),(r=a.firstChild)&&e(r).is("div")&&o(r,!0),(r=a.lastChild)&&e(r).is("div")&&o(r),a=a.innerHTML,s.remove(),a}},e.sceditor.plugins.bbcode.stripQuotes=function(e){return e?e.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2"):e},e.sceditor.plugins.bbcode.formatString=function(){var e,t=arguments;return t[0].replace(/\{(\d+)\}/g,function(n,r){return t[r-0+1]!==e?t[r-0+1]:"{"+r+"}"})},e.sceditor.plugins.bbcode.formatBBCodeString=function(e,t){return e.replace(/\{([^}]+)\}/g,function(e,n){var i,o=!0;return"!"===n.charAt(0)&&(o=!1,n=n.substring(1)),"0"===n&&(o=!1),t[n]===i?e:o?r(t[n],!0):t[n]})};var s=e.sceditor.plugins.bbcode.normaliseColour=function(e){var t,n;return n=function(e){return e=parseInt(e,10),isNaN(e)?"00":(e=Math.max(0,Math.min(e,255)).toString(16),e.length<2?"0"+e:e)},e=e||"#000",(t=e.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+n(t[1])+n(t[2]-0)+n(t[3]-0):(t=e.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:e};e.sceditor.plugins.bbcode.bbcodes={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n;return"font"===e[0].nodeName.toLowerCase()&&(n=e.attr("face"))||(n=e.css("font-family")),"[font="+this.stripQuotes(n)+"]"+t+"[/font]"},html:'<font face="{defaultattr}">{0}</font>'},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(e,t){var n=e.attr("size"),r=2;return n||(n=e.css("fontSize")),n.indexOf("px")>-1?(n=n.replace("px","")-0,12>n&&(r=1),n>15&&(r=3),n>17&&(r=4),n>23&&(r=5),n>31&&(r=6),n>47&&(r=7)):r=n,"[size="+r+"]"+t+"[/size]"},html:'<font size="{defaultattr}">{!0}</font>'},color:{tags:{font:{color:null}},styles:{color:null},quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n,r=e[0];return"font"===r.nodeName.toLowerCase()&&(n=e.attr("color"))||(n=r.style.color||e.css("color")),"[color="+s(n)+"]"+t+"[/color]"},html:function(e,t,n){return'<font color="'+r(s(t.defaultattr),!0)+'">'+n+"</font>"}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(e,t){return e.data("sceditor-emoticon")+t},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},allowedChildren:["#"],quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n,r,i="",o=e[0],l=function(e){return o.style?o.style[e]:null};return e.attr("data-sceditor-emoticon")?t:(n=e.attr("width")||l("width"),r=e.attr("height")||l("height"),(o.complete&&(n||r)||n&&r)&&(i="="+e.width()+"x"+e.height()),"[img"+i+"]"+e.attr("src")+"[/img]")},html:function(e,t,n){var o,l,s,a,c="";return t.width!==o&&(l=t.width),t.height!==o&&(s=t.height),t.defaultattr&&(a=t.defaultattr.split(/x/i),l=a[0],s=2===a.length?a[1]:a[0]),l!==o&&(c+=' width="'+r(l,!0)+'"'),s!==o&&(c+=' height="'+r(s,!0)+'"'),"<img"+c+' src="'+i(n)+'" />'}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n=e.attr("href");return"mailto:"===n.substr(0,7)?'[email="'+n.substr(7)+'"]'+t+"[/email]":"[url="+n+"]"+t+"[/url]"},html:function(e,t,n){return t.defaultattr=r(t.defaultattr,!0)||n,'<a href="'+i(t.defaultattr)+'">'+n+"</a>"}},email:{quoteType:e.sceditor.BBCodeParser.QuoteType.never,html:function(e,t,n){return'<a href="mailto:'+(r(t.defaultattr,!0)||n)+'">'+n+"</a>"}},quote:{tags:{blockquote:null},isInline:!1,quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(t,n){var r="",i=e(t),o=i.children("cite").first();return(1===o.length||i.data("author"))&&(r=o.text()||i.data("author"),i.data("author",r),o.remove(),n=this.elementToBbcode(e(t)),r="="+r,i.prepend(o)),"[quote"+r+"]"+n+"[/quote]"},html:function(e,t,n){return t.defaultattr&&(n="<cite>"+r(t.defaultattr)+"</cite>"+n),"<blockquote>"+n+"</blockquote>"}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:!1,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:!1,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:!1,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:!1,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(e,t){return e=e.attr("data-youtube-id"),e?"[youtube]"+e+"[/youtube]":t},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}},e.sceditor.plugins.bbcode.bbcode={get:function(t){return e.sceditor.plugins.bbcode.bbcodes[t]||null},set:function(t,n){var r=e.sceditor.plugins.bbcode.bbcodes;return t&&n?(n=e.extend(r[t]||{},n),n.remove=function(){delete r[t]},r[t]=n,this):!1},rename:function(t,n){var r=e.sceditor.plugins.bbcode.bbcodes;return t in r?(r[n]=r[t],delete r[t],this):!1},remove:function(t){var n=e.sceditor.plugins.bbcode.bbcodes;return t in n&&delete n[t],this}},e.fn.sceditorBBCodePlugin=function(t){return t=t||{},e.isPlainObject(t)&&(t.plugins=(t.plugins?t.plugins:"")+"bbcode"),this.sceditor(t)}}(jQuery,window,document);