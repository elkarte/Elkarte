/* SCEditor v1.4.5 | (C) 2011-2013, Sam Clarke | sceditor.com/license */
!function(e,t,n){"use strict";var o={html:'<!DOCTYPE html><html><head><style>.ie * {min-height: auto !important} .ie table td {height:15px}</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" value="http://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" value="http://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{id}?wmode=opaque" data-youtube-id="{id}" frameborder="0" allowfullscreen></iframe>'},r=function(t,n,r){var i=o[t];return e.each(n,function(e,t){i=i.replace(RegExp("\\{"+e+"\\}","g"),t)}),r&&(i=e(i)),i};e.sceditor=function(o,i){var s,l,a,c,d,u,f,p,h,m,g,b,v,y,x,w,k,C,T,E,S,B,I,D,H,M,N,R,z,A,P,L,O,_,q,j,W,F,Q,V,$,U,Y,K,X,G,J,Z,et,tt,nt,ot,rt,it,st,lt,at,ct=e.sceditor.ie,dt=ct&&11>ct,ut=this,ft=o.get?o.get(0):o,pt=e(ft),ht=[],mt=[],gt=[],bt=[],vt={},yt=[];ut.commands=e.extend(!0,{},i.commands||e.sceditor.commands),ut.opts=i=e.extend({},e.sceditor.defaultOptions,i),S=function(){pt.data("sceditor",ut),e.each(i,function(t,n){e.isPlainObject(n)&&(i[t]=e.extend(!0,{},n))}),i.locale&&"en"!==i.locale&&N(),s=e('<div class="sceditor-container" />').insertAfter(pt).css("z-index",i.zIndex),ct&&s.addClass("ie ie"+ct),T=!!pt.attr("required"),pt.removeAttr("required"),M(),O(),R(),H(),P(),z(),A(),e.sceditor.isWysiwygSupported||ut.toggleSourceMode(),G();var o=function(){e(t).unbind("load",o),i.autofocus&&nt(),i.autoExpand&&ut.expandToContent(),K(),y.call("ready")};e(t).load(o),n.readyState&&"complete"===n.readyState&&o()},M=function(){var t=i.plugins;t=t?(""+t).split(","):[],y=new e.sceditor.PluginManager(ut),e.each(t,function(t,n){y.register(e.trim(n))})},N=function(){var t;g=e.sceditor.locale[i.locale],g||(t=i.locale.split("-"),g=e.sceditor.locale[t[0]]),g&&g.dateFormat&&(i.dateFormat=g.dateFormat)},H=function(){var n,o;f=e("<textarea></textarea>").hide(),a=e('<iframe frameborder="0"></iframe>'),i.spellcheck||f.attr("spellcheck","false"),"https:"===t.location.protocol&&a.attr("src","javascript:false"),s.append(a).append(f),c=a[0],p=f[0],ut.dimensions(i.width||pt.width(),i.height||pt.height()),n=_(),n.open(),n.write(r("html",{spellcheck:i.spellcheck?"":'spellcheck="false"',charset:i.charset,style:i.style})),n.close(),u=e(n),d=e(n.body),ut.readOnly(!!i.readOnly),ct&&u.find("html").addClass("ie ie"+ct),(e.sceditor.ios||ct)&&(d.height("100%"),ct||d.bind("touchend",ut.focus)),b=new e.sceditor.rangeHelper(c.contentWindow),ut.val(pt.hide().val()),o=pt.attr("tabindex"),f.attr("tabindex",o),a.attr("tabindex",o)},z=function(){i.autoUpdate&&(d.bind("blur",ut.updateOriginal),f.bind("blur",ut.updateOriginal)),null===i.rtl&&(i.rtl="rtl"===f.css("direction")),ut.rtl(!!i.rtl),i.autoExpand&&u.bind("keyup",ut.expandToContent),i.resizeEnabled&&L(),s.attr("id",i.id),ut.emoticons(i.emoticonsEnabled)},A=function(){e(n).click(Y),e(ft.form).bind("reset",V).submit(ut.updateOriginal),e(t).bind("resize orientationChanged",K),d.keypress(Q).keydown(W).keydown(F).keyup(Z).bind("blur",lt).keyup(at).bind("paste",q).bind(ct?"selectionchange":"keyup focus blur contextmenu mouseup touchend click",et).bind("keydown keyup keypress focus blur contextmenu",U),i.emoticonsCompat&&t.getSelection&&d.keyup(rt),f.bind("blur",lt).keyup(at).bind("keydown keyup keypress focus blur contextmenu",U).keydown(W),u.mousedown($).bind("blur",lt).bind(ct?"selectionchange":"focus blur contextmenu mouseup click",et).bind("beforedeactivate keyup",D).keyup(Z).focus(function(){m=null}),s.bind("selectionchanged",tt).bind("selectionchanged",G).bind("selectionchanged valuechanged nodechanged",U)},R=function(){var t,n,o,a=ut.commands,c=(i.toolbarExclude||"").split(","),d=i.toolbar.split("|");l=e('<div class="sceditor-toolbar" unselectable="on" />'),e.each(d,function(i,s){t=e('<div class="sceditor-group" />'),e.each(s.split(","),function(i,s){a[s]&&e.inArray(s,c)<=-1&&(o=a[s].shortcut?" ("+a[s].shortcut+")":"",n=r("toolbarButton",{name:s,dispName:ut._(a[s].tooltip||s)+o},!0),n.data("sceditor-txtmode",!!a[s].txtExec),n.data("sceditor-wysiwygmode",!!a[s].exec),n.click(function(){var t=e(this);return t.hasClass("disabled")||I(t,a[s]),G(),!1}),a[s].tooltip&&n.attr("title",ut._(a[s].tooltip)),a[s].exec||n.addClass("disabled"),a[s].shortcut&&(ut.addShortcut(a[s].shortcut,s),n.attr("title",n.attr("title")+o)),t.append(n))}),t[0].firstChild&&l.append(t)}),e(i.toolbarContainer||s).append(l)},P=function(){e.each(ut.commands,function(t,n){n.keyPress&&ht.push(n.keyPress),n.forceNewLineAfter&&e.isArray(n.forceNewLineAfter)&&(gt=e.merge(gt,n.forceNewLineAfter)),n.state?bt.push({name:t,state:n.state}):"string"==typeof n.exec&&bt.push({name:t,state:n.exec})}),Z()},L=function(){var o,r,l,a,c,d,u=e('<div class="sceditor-grip" />'),f=e('<div class="sceditor-resize-cover" />'),p=0,h=0,m=0,g=0,b=s.width(),v=s.height(),y=!1,x=ut.rtl();o=i.resizeMinHeight||v/1.5,r=i.resizeMaxHeight||2.5*v,l=i.resizeMinWidth||b/1.25,a=i.resizeMaxWidth||1.25*b,c=function(e){"touchmove"===e.type&&(e=t.event);var n=g+(e.pageY-h),c=x?m-(e.pageX-p):m+(e.pageX-p);a>0&&c>a&&(c=a),r>0&&n>r&&(n=r),(!i.resizeWidth||l>c||a>0&&c>a)&&(c=!1),(!i.resizeHeight||o>n||r>0&&n>r)&&(n=!1),(c||n)&&(ut.dimensions(c,n),7>ct&&s.height(n)),e.preventDefault()},d=function(t){y&&(y=!1,f.hide(),s.removeClass("resizing").height("auto"),e(n).unbind("touchmove mousemove",c),e(n).unbind("touchend mouseup",d),t.preventDefault())},s.append(u),s.append(f.hide()),u.bind("touchstart mousedown",function(o){"touchstart"===o.type&&(o=t.event),p=o.pageX,h=o.pageY,m=s.width(),g=s.height(),y=!0,s.addClass("resizing"),f.show(),e(n).bind("touchmove mousemove",c),e(n).bind("touchend mouseup",d),7>ct&&s.height(g),o.preventDefault()})},O=function(){var t,o=i.emoticons,r=i.emoticonsRoot;e.isPlainObject(o)&&i.emoticonsEnabled&&e.each(o,function(i,s){e.each(s,function(e,s){r&&(s={url:r+(s.url||s),tooltip:s.tooltip||e},o[i][e]=s),t=n.createElement("img"),t.src=s.url||s,mt.push(t)})})},nt=function(){var t,n,o,r=u[0],l=d[0],a=!!i.autofocusEnd;if(s.is(":visible")){if(ut.sourceMode())o=p.value.length,p.setSelectionRange?p.setSelectionRange(o,o):p.createTextRange&&(t=p.createTextRange(),t.moveEnd("character",o),t.moveStart("character",o),b.selectRange(t));else{if(e.sceditor.dom.removeWhiteSpace(l),a)for((n=l.lastChild)||d.append(n=r.createElement("div"));n.lastChild;)n=n.lastChild,/br/i.test(n.nodeName)&&n.previousSibling&&(n=n.previousSibling);else n=l.firstChild;r.createRange?(t=r.createRange(),/br/i.test(n.nodeName)?t.setStartBefore(n):t.selectNodeContents(n),t.collapse(!1)):(t=l.createTextRange(),t.moveToElementText(3!==n.nodeType?n:n.parentNode),t.collapse(!1)),b.selectRange(t),a&&(u.scrollTop(l.scrollHeight),d.scrollTop(l.scrollHeight))}ut.focus()}},ut.readOnly=function(e){return"boolean"!=typeof e?"readonly"===f.attr("readonly"):(d[0].contentEditable=!e,e?f.attr("readonly","readonly"):f.removeAttr("readonly"),X(e),this)},ut.rtl=function(e){var t=e?"rtl":"ltr";return"boolean"!=typeof e?"rtl"===f.attr("dir"):(d.attr("dir",t),f.attr("dir",t),s.removeClass("rtl").removeClass("ltr").addClass(t),this)},X=function(t){var n=ut.inSourceMode();l.find(".sceditor-button").removeClass("disabled").each(function(){var o=e(this);t===!0||n&&!o.data("sceditor-txtmode")?o.addClass("disabled"):n||o.data("sceditor-wysiwygmode")||o.addClass("disabled")})},ut.width=function(e,t){return e||0===e?(ut.dimensions(e,null,t),this):s.width()},ut.dimensions=function(t,o,r){var c=8>ct||n.documentMode<8?2:0;return t=t||0===t?t:!1,o=o||0===o?o:!1,t===!1&&o===!1?{width:ut.width(),height:ut.height()}:(void 0===a.data("outerWidthOffset")&&ut.updateStyleCache(),t!==!1&&(r!==!1&&(i.width=t),o===!1&&(o=s.height(),r=!1),s.width(t),t&&(""+t).indexOf("%")>-1&&(t=s.width()),a.width(t-a.data("outerWidthOffset")),f.width(t-f.data("outerWidthOffset")),e.sceditor.ios&&d&&d.width(t-a.data("outerWidthOffset")-(d.outerWidth(!0)-d.width()))),o!==!1&&(r!==!1&&(i.height=o),o&&(""+o).indexOf("%")>-1&&(o=s.height(o).height(),s.height("auto")),o-=i.toolbarContainer?0:l.outerHeight(!0),a.height(o-a.data("outerHeightOffset")),f.height(o-c-f.data("outerHeightOffset"))),this)},ut.updateStyleCache=function(){a.data("outerWidthOffset",a.outerWidth(!0)-a.width()),f.data("outerWidthOffset",f.outerWidth(!0)-f.width()),a.data("outerHeightOffset",a.outerHeight(!0)-a.height()),f.data("outerHeightOffset",f.outerHeight(!0)-f.height())},ut.height=function(e,t){return e||0===e?(ut.dimensions(null,e,t),this):s.height()},ut.maximize=function(t){return void 0===t?s.is(".sceditor-maximize"):(t=!!t,7>ct&&e("html, body").toggleClass("sceditor-maximize",t),s.toggleClass("sceditor-maximize",t),ut.width(t?"100%":i.width,!1),ut.height(t?"100%":i.height,!1),this)},ut.expandToContent=function(e){var t=s.height(),n=d[0].scrollHeight||u[0].documentElement.scrollHeight,o=t-a.height(),r=i.resizeMaxHeight||2*(i.height||pt.height());n+=o,e!==!0&&n>r&&(n=r),n>t&&ut.height(n)},ut.destroy=function(){y&&(y.destroy(),b=null,m=null,y=null,e(n).unbind("click",Y),e(t).unbind("resize orientationChanged",K),e(ft.form).unbind("reset",V).unbind("submit",ut.updateOriginal),d.unbind(),u.unbind().find("*").remove(),f.unbind().remove(),l.remove(),s.unbind().find("*").unbind().remove(),s.remove(),pt.removeData("sceditor").removeData("sceditorbbcode").show(),T&&pt.attr("required","required"))},ut.createDropDown=function(t,n,o,r){var s,l=h&&h.is(".sceditor-"+n);ut.closeDropDown(),l||(r!==!1&&e(o).find(":not(input,textarea)").filter(function(){return 1===this.nodeType}).attr("unselectable","on"),s={top:t.offset().top,left:t.offset().left,marginTop:t.outerHeight()},e.extend(s,i.dropDownCss),h=e('<div class="sceditor-dropdown sceditor-'+n+'" />').css(s).append(o).appendTo(e("body")).on("click focusin",function(e){e.stopPropagation()}))},Y=function(e){3!==e.which&&ut.closeDropDown()},q=function(e){var t,o,r,s=d[0],l=u[0],a=0,c=n.createElement("div"),f=l.createDocumentFragment();if(i.disablePasting)return!1;if(i.enablePasteFiltering){if(b.saveRange(),n.body.appendChild(c),e&&e.clipboardData&&e.clipboardData.getData&&((t=e.clipboardData.getData("text/html"))||(t=e.clipboardData.getData("text/plain"))))return c.innerHTML=t,j(s,c),!1;for(r=d.scrollTop()||u.scrollTop();s.firstChild;)f.appendChild(s.firstChild);return o=function(e,t){if(e.childNodes.length>0||a>25){for(;e.firstChild;)t.appendChild(e.firstChild);for(;f.firstChild;)e.appendChild(f.firstChild);d.scrollTop(r),u.scrollTop(r),t.childNodes.length>0?j(e,t):b.restoreRange()}else a++,setTimeout(function(){o(e,t)},20)},o(s,c),ut.focus(),!0}},j=function(t,n){e.sceditor.dom.fixNesting(n);var o=n.innerHTML;y.hasHandler("toSource")&&(o=y.callOnlyFirst("toSource",o,e(n))),n.parentNode.removeChild(n),y.hasHandler("toWysiwyg")&&(o=y.callOnlyFirst("toWysiwyg",o,!0)),b.restoreRange(),ut.wysiwygEditorInsertHtml(o,null,!0)},ut.closeDropDown=function(e){h&&(h.unbind().remove(),h=null),e===!0&&ut.focus()},_=function(){return c.contentDocument?c.contentDocument:c.contentWindow&&c.contentWindow.document?c.contentWindow.document:c.document?c.document:null},ut.wysiwygEditorInsertHtml=function(t,n,o){var r,i,s,l=a.height();ut.focus(),(o||!e(w).is("code")&&0===e(w).parents("code").length)&&(b.insertHTML(t,n),b.saveRange(),B(d[0]),r=d.find("#sceditor-end-marker").show(),i=d.scrollTop()||u.scrollTop(),s=e.sceditor.dom.getOffset(r[0]).top+1.5*r.outerHeight(!0)-l,r.hide(),(s>i||i>s+l)&&(d.scrollTop(s),u.scrollTop(s)),st(!1),b.restoreRange(),Z())},ut.wysiwygEditorInsertText=function(t,n){ut.wysiwygEditorInsertHtml(e.sceditor.escapeEntities(t),e.sceditor.escapeEntities(n))},ut.insertText=function(e,t){return ut.inSourceMode()?ut.sourceEditorInsertText(e,t):ut.wysiwygEditorInsertText(e,t),this},ut.sourceEditorInsertText=function(e,t){var o,r,i,s,l;l=p.scrollTop,p.focus(),void 0!==p.selectionStart?(r=p.selectionStart,i=p.selectionEnd,s=e.length,t&&(e+=p.value.substring(r,i)+t),p.value=p.value.substring(0,r)+e+p.value.substring(i,p.value.length),p.selectionStart=r+e.length-(t?t.length:0),p.selectionEnd=p.selectionStart):void 0!==n.selection.createRange?(o=n.selection.createRange(),t&&(e+=o.text+t),o.text=e,t&&o.moveEnd("character",0-t.length),o.moveStart("character",o.End-o.Start),o.select()):p.value+=e+t,p.scrollTop=l,p.focus(),st()},ut.getRangeHelper=function(){return b},ut.sourceEditorCaret=function(e){var t={};return void 0!==p.selectionStart?e?(p.selectionStart=e.start,p.selectionEnd=e.end):(t.start=p.selectionStart,t.end=p.selectionEnd):(range=n.selection.createRange(),e?(range.moveStart("character",e.start),range.moveEnd("character",e.end),range.select()):(t.start=range.Start,t.end=range.End)),e?this:t},ut.val=function(e,t){return"string"==typeof e?(ut.inSourceMode()?ut.setSourceEditorValue(e):(t!==!1&&y.hasHandler("toWysiwyg")&&(e=y.callOnlyFirst("toWysiwyg",e)),ut.setWysiwygEditorValue(e)),this):ut.inSourceMode()?ut.getSourceEditorValue(!1):ut.getWysiwygEditorValue()},ut.insert=function(t,n,o,r,i){if(ut.inSourceMode())ut.sourceEditorInsertText(t,n);else{if(n){var s=ut.getRangeHelper().selectedHtml(),l=e("<div>").appendTo(e("body")).hide().html(s);o!==!1&&y.hasHandler("toSource")&&(s=y.callOnlyFirst("toSource",s,l)),l.remove(),t+=s+n}o!==!1&&y.hasHandler("toWysiwyg")&&(t=y.callOnlyFirst("toWysiwyg",t,!0)),o!==!1&&i===!0&&(t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),ut.wysiwygEditorInsertHtml(t)}return this},ut.getWysiwygEditorValue=function(t){var n,o,r=b.hasSelection();return r?b.saveRange():m&&m.getBookmark&&(o=m.getBookmark()),e.sceditor.dom.fixNesting(d[0]),n=d.html(),t!==!1&&y.hasHandler("toSource")&&(n=y.callOnlyFirst("toSource",n,d)),r?(b.restoreRange(),m=null):o&&(m.moveToBookmark(o),m=null),n},ut.getBody=function(){return d},ut.getContentAreaContainer=function(){return a},ut.getSourceEditorValue=function(e){var t=f.val();return e!==!1&&y.hasHandler("toWysiwyg")&&(t=y.callOnlyFirst("toWysiwyg",t)),t},ut.setWysiwygEditorValue=function(e){e||(e="<p>"+(ct?"":"<br />")+"</p>"),d[0].innerHTML=e,B(d[0]),Z(),st()},ut.setSourceEditorValue=function(e){f.val(e),st()},ut.updateOriginal=function(){pt.val(ut.val())},B=function(t){if(i.emoticonsEnabled&&!e(t).parents("code").length){var n=t.ownerDocument,o=[],s=[],l=e.extend({},i.emoticons.more,i.emoticons.dropdown,i.emoticons.hidden);e.each(l,function(t){i.emoticonsCompat&&(s[t]=RegExp("(>|^|\\s| | | | |&nbsp;)"+e.sceditor.regexEscape(t)+"(\\s|$|<| | | | |&nbsp;)")),o.push(t)}),function a(t){for(t=t.firstChild;null!=t;){var c,d,u,f,p,h,m,g=t.parentNode,b=t.nodeValue;if(3!==t.nodeType)e(t).is("code")||a(t);else if(b)for(p=o.length;p--;)d=o[p],m=i.emoticonsCompat?b.search(s[d]):b.indexOf(d),m>-1&&(h=t.nextSibling,u=l[d],c=b.substr(m).split(d),b=b.substr(0,m)+c.shift(),t.nodeValue=b,f=e.sceditor.dom.parseHTML(r("emoticon",{key:d,url:u.url||u,tooltip:u.tooltip||d}),n),g.insertBefore(f[0],h),g.insertBefore(n.createTextNode(c.join(d)),h));t=t.nextSibling}}(t),i.emoticonsCompat&&(yt=d.find("img[data-sceditor-emoticon]"))}},ut.inSourceMode=function(){return s.hasClass("sourceMode")},ut.sourceMode=function(e){return"boolean"!=typeof e?ut.inSourceMode():((ut.inSourceMode()&&!e||!ut.inSourceMode()&&e)&&ut.toggleSourceMode(),this)},ut.toggleSourceMode=function(){var t=ut.inSourceMode();(e.sceditor.isWysiwygSupported||!t)&&(t||(b.saveRange(),b.clear()),ut.blur(),t?ut.setWysiwygEditorValue(ut.getSourceEditorValue()):ut.setSourceEditorValue(ut.getWysiwygEditorValue()),m=null,f.toggle(),a.toggle(),s.toggleClass("wysiwygMode",t).toggleClass("sourceMode",!t),X(),G())},J=function(){return p.focus(),null!=p.selectionStart?p.value.substring(p.selectionStart,p.selectionEnd):n.selection.createRange?n.selection.createRange().text:void 0},I=function(t,n){return ut.inSourceMode()?void(n.txtExec&&(e.isArray(n.txtExec)?ut.sourceEditorInsertText.apply(ut,n.txtExec):n.txtExec.call(ut,t,J()))):void(n.exec&&(e.isFunction(n.exec)?n.exec.call(ut,t):ut.execCommand(n.exec,n.hasOwnProperty("execParam")?n.execParam:null)))},D=function(){ct&&(m=b.selectedRange())},ut.execCommand=function(t,n){var o=!1,r=e(b.parentNode());if(ut.focus(),!r.is("code")&&0===r.parents("code").length){try{o=u[0].execCommand(t,!1,n)}catch(i){}!o&&ut.commands[t]&&ut.commands[t].errorMessage&&alert(ut._(ut.commands[t].errorMessage))}},et=function(){var t=function(){b&&!b.compare(k)&&(k=b.cloneSelected(),s.trigger(e.Event("selectionchanged"))),C=!1};C||(C=!0,ct?t():setTimeout(t,100))},tt=function(){var t,n=b.parentNode();x!==n&&(t=x,x=n,w=b.getFirstBlockParent(n),s.trigger(e.Event("nodechanged",{oldNode:t,newNode:x})))},ut.currentNode=function(){return x},ut.currentBlockNode=function(){return w},G=function(e){var t,n,o,r,i,s=u[0],a=bt.length,c=ut.sourceMode();if(ut.sourceMode()||ut.readOnly())l.find(".sceditor-button").removeClass("active");else for(c||(i=e?e.newNode:b.parentNode(),o=b.getFirstBlockParent(i));a--;)if(t=0,n=bt[a],r=l.find(".sceditor-button-"+n.name),c&&!r.data("sceditor-txtmode"))r.addClass("disabled");else if(c||r.data("sceditor-wysiwygmode")){if("string"==typeof n.state)try{t=s.queryCommandEnabled(n.state)?0:-1,t>-1&&(t=s.queryCommandState(n.state)?1:0)}catch(d){}else t=n.state.call(ut,i,o);0>t?r.addClass("disabled"):r.removeClass("disabled"),t>0?r.addClass("active"):r.removeClass("active")}else r.addClass("disabled")},Q=function(t){var n,o;if(!t.originalEvent.defaultPrevented){if(ut.closeDropDown(),n=e(x),13===t.which&&(n.is("code,blockquote,pre")||0!==n.parents("code,blockquote,pre").length))return m=null,ut.wysiwygEditorInsertHtml("<br />",null,!0),!1;if(!n.is("code")&&0===n.parents("code").length)for(o=ht.length;o--;)ht[o].call(ut,t,c,f)}},Z=function(){var t,n,o;e.sceditor.dom.rTraverse(d[0],function(r){return t=r.nodeName.toLowerCase(),e.inArray(t,gt)>-1&&(n=!0),3===r.nodeType&&!/^\s*$/.test(r.nodeValue)||"br"===t||dt&&!r.firstChild&&!e.sceditor.dom.isInline(r,!1)?(n&&(o=d[0].ownerDocument.createElement("div"),o.className="sceditor-nlf",o.innerHTML=dt?"":"<br />",d[0].appendChild(o)),!1):void 0})},V=function(){ut.val(pt.val())},$=function(){ut.closeDropDown(),m=null},K=function(){var e=i.height,t=i.width;ut.maximize()?ut.dimensions("100%","100%",!1):(e&&(""+e).indexOf("%")>-1||t&&(""+t).indexOf("%")>-1)&&ut.dimensions(t,e)},ut._=function(){var e,t=arguments;return g&&g[t[0]]&&(t[0]=g[t[0]]),t[0].replace(/\{(\d+)\}/g,function(n,o){return t[o-0+1]!==e?t[o-0+1]:"{"+o+"}"})},U=function(t){var n,o=e.extend({},t);y.call(o.type+"Event",t,ut),delete o.type,n=e.Event((t.target===p?"scesrc":"scewys")+t.type,o),s.trigger(n,ut),n.isDefaultPrevented()&&t.preventDefault(),n.isImmediatePropagationStopped()&&n.stopImmediatePropagation(),n.isPropagationStopped()&&n.stopPropagation()},ut.bind=function(t,n,o,r){t=t.split(" ");for(var i=t.length;i--;)e.isFunction(n)&&(o||s.bind("scewys"+t[i],n),r||s.bind("scesrc"+t[i],n),"valuechanged"===t[i]&&(st.hasHandler=!0));return this},ut.unbind=function(t,n,o,r){t=t.split(" ");for(var i=t.length;i--;)e.isFunction(n)&&(o||s.unbind("scewys"+t[i],n),r||s.unbind("scesrc"+t[i],n));return this},ut.blur=function(t,n,o){return e.isFunction(t)?ut.bind("blur",t,n,o):ut.sourceMode()?f.blur():v?v.removeAttr("disabled").show().focus().blur().hide().attr("disabled","disabled"):(v=e('<input style="position:absolute;width:0;height:0;opacity:0;border:0;padding:0;filter:alpha(opacity=0)" type="text" />').appendTo(s),v.removeAttr("disabled").show().triggerHandler("focus"),v.blur().hide().attr("disabled","disabled")),this},ut.focus=function(t,n,o){return e.isFunction(t)?ut.bind("focus",t,n,o):ut.inSourceMode()?p.focus():(c.contentWindow.focus(),d[0].focus(),m&&(b.selectRange(m),m=null)),this},ut.keyDown=function(e,t,n){return ut.bind("keydown",e,t,n)},ut.keyPress=function(e,t,n){return ut.bind("keypress",e,t,n)},ut.keyUp=function(e,t,n){return ut.bind("keyup",e,t,n)},ut.nodeChanged=function(e){return ut.bind("nodechanged",e,!1,!0)},ut.selectionChanged=function(e){return ut.bind("selectionchanged",e,!1,!0)},ut.valueChanged=function(e,t,n){return ut.bind("valuechanged",e,t,n)},ot=function(t){var n=0,o=String.fromCharCode(t.which);if(!e(w).is("code")&&!e(w).parents("code").length)return ut.emoticonsCache||(ut.emoticonsCache=[],e.each(e.extend({},i.emoticons.more,i.emoticons.dropdown,i.emoticons.hidden),function(e,t){ut.emoticonsCache[n++]=[e,r("emoticon",{key:e,url:t.url||t,tooltip:t.tooltip||e})]}),ut.emoticonsCache.sort(function(e,t){return e[0].length-t[0].length}),ut.longestEmoticonCode=ut.emoticonsCache[ut.emoticonsCache.length-1][0].length),ut.getRangeHelper().raplaceKeyword(ut.emoticonsCache,!0,!0,ut.longestEmoticonCode,i.emoticonsCompat,o)?(i.emoticonsCompat&&(yt=d.find("img[data-sceditor-emoticon]")),/^\s$/.test(o)&&i.emoticonsCompat):void 0},rt=function(){if(yt.length){var t,n,o,r,i,s,l=ut.currentBlockNode(),a=!1,c=/[^\s\xA0\u2002\u2003\u2009\u00a0]+/;yt=e.map(yt,function(d){return d&&d.parentNode?e.contains(l,d)?(t=d.previousSibling,n=d.nextSibling,i=t.nodeValue,null===i&&(i=t.innerText||""),t&&c.test(t.nodeValue.slice(-1))||n&&c.test((n.nodeValue||"")[0])?(o=d.parentNode,r=b.cloneSelected(),s=r.startContainer,i+=e(d).data("sceditor-emoticon"),s===n?a=i.length+r.startOffset:s===l&&l.childNodes[r.startOffset]===n?a=i.length:s===t&&(a=r.startOffset),n&&3===n.nodeType||(n=o.insertBefore(o.ownerDocument.createTextNode(""),n)),n.insertData(0,i),o.removeChild(t),o.removeChild(d),a!==!1&&(r.setStart(n,a),r.collapse(!0),b.selectRange(r)),null):d):d:null})}},ut.emoticons=function(t){return t||t===!1?(i.emoticonsEnabled=t,t?(d.keypress(ot),ut.sourceMode()||(b.saveRange(),B(d[0]),yt=d.find("img[data-sceditor-emoticon]"),st(!1),b.restoreRange())):(d.find("img[data-sceditor-emoticon]").replaceWith(function(){return e(this).data("sceditor-emoticon")}),yt=[],d.unbind("keypress",ot),st()),this):i.emoticonsEnabled},ut.css=function(t){return E||(E=e('<style id="#inline" />').appendTo(u.find("head"))[0]),"string"!=typeof t?E.styleSheet?E.styleSheet.cssText:E.innerHTML:(E.styleSheet?E.styleSheet.cssText=t:E.innerHTML=t,this)},W=function(e){var t=[],n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},o={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},i=e.which,s=o[i]||String.fromCharCode(i).toLowerCase();return e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&(t.push("shift"),r[i]?s=r[i]:n[s]&&(s=n[s])),s&&(16>i||i>18)&&t.push(s),t=t.join("+"),vt[t]?vt[t].call(ut):void 0},ut.addShortcut=function(e,t){return e=e.toLowerCase(),vt[e]="string"==typeof t?function(){return I(l.find(".sceditor-button-"+t),ut.commands[t]),!1}:t,this},ut.removeShortcut=function(e){return delete vt[e.toLowerCase()],this},F=function(n){var o,r,s,l,a;if(!ct&&!i.disableBlockRemove&&8===n.which&&(l=b.selectedRange())&&(t.getSelection?(o=l.startContainer,r=l.startOffset):(o=l.parentElement(),s=u[0].selection.createRange(),s.moveToElementText(o),s.setEndPoint("EndToStart",l),r=s.text.length),0===r&&(a=it()))){for(;o!==a;){for(;o.previousSibling;)if(o=o.previousSibling,3!==o.nodeType||o.nodeValue)return;if(!(o=o.parentNode))return}if(a&&!e(a).is("body"))return ut.clearBlockFormatting(a),!1}},it=function(){for(var t=w;!e.sceditor.dom.hasStyling(t);)if(!(t=t.parentNode)||e(t).is("body"))return;return t},ut.clearBlockFormatting=function(t){return t=t||it(),!t||e(t).is("body")?this:(b.saveRange(),m=null,t.className="",e(t).attr("style",""),e(t).is("p,div,td")||e.sceditor.dom.convertElement(t,"p"),b.restoreRange(),this)},st=function(t){if(y.hasHandler("valuechangedEvent")||st.hasHandler){var n,o=ut.sourceMode(),r=!o&&b.hasSelection();t=t!==!1&&!u[0].getElementById("sceditor-start-marker"),at.timer&&(clearTimeout(at.timer),at.timer=!1),r&&t&&b.saveRange(),n=d.html(),n!==st.lastHtmlValue&&(st.lastHtmlValue=n,s.trigger(e.Event("valuechanged",{rawValue:o?ut.val():n}))),r&&t&&b.removeMarkers()}},lt=function(){at.timer&&st()},at=function(e){var t=e.which,n=at.lastChar,o=13===n||32===n,r=8===n||46===n;at.lastChar=t,13===t||32===t?o?at.triggerNextChar=!0:st():8===t||46===t?r?at.triggerNextChar=!0:st():at.triggerNextChar&&(st(),at.triggerNextChar=!1),at.timer&&clearTimeout(at.timer),at.timer=setTimeout(function(){st()},1500)},S()},e.sceditor.ie=function(){var e,o=3,r=n.createElement("div"),i=r.getElementsByTagName("i");do r.innerHTML="<!--[if gt IE "+ ++o+"]><i></i><![endif]-->";while(i[0]);return n.documentMode&&n.all&&t.atob&&(o=10),4===o&&n.documentMode&&(o=11),o>4?o:e}(),e.sceditor.ios=/iPhone|iPod|iPad| wosbrowser\//i.test(navigator.userAgent),e.sceditor.isWysiwygSupported=function(){var t,n,o=e('<div contenteditable="true">')[0].contentEditable,r=void 0!==o&&"inherit"!==o,i=navigator.userAgent;return r?(n=/Opera Mobi|Opera Mini/i.test(i),/Android/i.test(i)&&(n=!0,/Safari/.test(i)&&(t=/Safari\/(\d+)/.exec(i),n=t&&t[1]?t[1]<534:!0)),/ Silk\//i.test(i)&&(t=/AppleWebKit\/(\d+)/.exec(i),n=t&&t[1]?t[1]<534:!0),e.sceditor.ios&&(n=!/OS [5-9](_\d)+ like Mac OS X/i.test(i)),/Firefox/i.test(i)&&(n=!1),/OneBrowser/i.test(i)&&(n=!1),"UCWEB"===navigator.vendor&&(n=!1),!n):!1}(),e.sceditor.regexEscape=function(e){return e.replace(/([\-.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},e.sceditor.escapeEntities=function(e,t){return e?(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ {2}/g," &nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />"),t&&(e=e.replace(/"/g,"&#34;").replace(/'/g,"&#39;")),e):e},e.sceditor.escapeUriScheme=function(e){var n,o=/^(?:https?|s?ftp|mailto|spotify|skype|ssh|teamspeak|tel):|(?:\/\/)/i,r=/^[^\/]*:/i,i=t.location;return e&&r.test(e)&&!o.test(e)?(n=i.pathname.split("/"),n.pop(),i.protocol+"://"+i.host+n.join("/")+"/"+e):e},e.sceditor.locale={},e.sceditor.commands={bold:{exec:"bold",tooltip:"Bold",shortcut:"ctrl+b"},italic:{exec:"italic",tooltip:"Italic",shortcut:"ctrl+i"},underline:{exec:"underline",tooltip:"Underline",shortcut:"ctrl+u"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(t,n,o){for(var i=t.opts.fonts.split(","),s=e("<div />"),l=function(){return o(e(this).data("font")),t.closeDropDown(!0),!1},a=0;a<i.length;a++)s.append(r("fontOpt",{font:i[a]},!0).click(l));t.createDropDown(n,"font-picker",s)},exec:function(t){var n=this;e.sceditor.command.get("font")._dropDown(n,t,function(e){n.execCommand("fontname",e)})},tooltip:"Font Name"},size:{_dropDown:function(t,n,o){for(var i=e("<div />"),s=function(n){o(e(this).data("size")),t.closeDropDown(!0),n.preventDefault()},l=1;7>=l;l++)i.append(r("sizeOpt",{size:l},!0).click(s));t.createDropDown(n,"fontsize-picker",i)},exec:function(t){var n=this;e.sceditor.command.get("size")._dropDown(n,t,function(e){n.execCommand("fontsize",e)})},tooltip:"Font Size"},color:{_dropDown:function(t,n,o){var r,i,s,l,a={r:255,g:255,b:255},c=e("<div />"),d=t.opts.colors?t.opts.colors.split("|"):Array(21),u=[],f=e.sceditor.command.get("color");if(!f._htmlCache){for(r=0;r<d.length;++r){for(l=d[r]?d[r].split(","):Array(21),u.push('<div class="sceditor-color-column">'),i=0;i<l.length;++i)s=l[i]||"#"+a.r.toString(16)+a.g.toString(16)+a.b.toString(16),u.push('<a href="#" class="sceditor-color-option" style="background-color: '+s+'" data-color="'+s+'"></a>'),i%5===0?(a.g-=51,a.b=255):a.b-=51;u.push("</div>"),r%5===0?(a.r-=51,a.g=255,a.b=255):(a.g=255,a.b=255)}f._htmlCache=u.join("")}c.append(f._htmlCache).find("a").click(function(n){o(e(this).attr("data-color")),t.closeDropDown(!0),n.preventDefault()}),t.createDropDown(n,"color-picker",c)},exec:function(t){var n=this;e.sceditor.command.get("color")._dropDown(n,t,function(e){n.execCommand("forecolor",e)})},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(e){var t,n=this,o=r("pastetext",{label:n._("Paste your text inside the following box:"),insert:n._("Insert")},!0);o.find(".button").click(function(e){t=o.find("#txt").val(),t&&n.wysiwygEditorInsertText(t),n.closeDropDown(!0),e.preventDefault()}),n.createDropDown(e,"pastetext",o)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},indent:{state:function(n,o){var r,i,s,l=e(o),a=l.parents("ul,ol,menu"),c=a.first();if(a.length>1||c.children().length>1)return 0;if(l.is("ul,ol,menu")){if(r=this.getRangeHelper().selectedRange(),!(t.Range&&r instanceof Range))return l.is("li,ul,ol,menu")?0:-1;if(i=r.startContainer.parentNode,s=r.endContainer.parentNode,i!==i.parentNode.firstElementChild||e(s).is("li")&&s!==s.parentNode.lastElementChild)return 0}return-1},exec:function(){var t=this,n=e(t.getRangeHelper().getFirstBlockParent());t.focus(),n.parents("ul,ol,menu")&&t.execCommand("indent")},tooltip:"Add indent"},outdent:{state:function(t,n){return e(n).is("ul,ol,menu")||e(n).parents("ul,ol,menu").length>0?0:-1},exec:function(){var t=this,n=e(t.getRangeHelper().getFirstBlockParent());n.parents("ul,ol,menu")&&t.execCommand("outdent")},tooltip:"Remove one indent"},table:{exec:function(t){var n=this,o=r("table",{rows:n._("Rows:"),cols:n._("Cols:"),insert:n._("Insert")},!0);
o.find(".button").click(function(t){var r=e.sceditor.ie,i=o.find("#rows").val()-0,s=o.find("#cols").val()-0,l="<table>";if(i>=1&&s>=1){for(var a=0;i>a;a++){l+="<tr>";for(var c=0;s>c;c++)l+="<td>"+(r&&11>r?"":"<br />")+"</td>";l+="</tr>"}l+="</table>",e.sceditor.ie&&(l+="<br />"),n.wysiwygEditorInsertHtml(l),n.closeDropDown(!0),t.preventDefault()}}),n.createDropDown(t,"inserttable",o)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{forceNewLineAfter:["code"],exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(e){var t=this,n=r("image",{url:t._("URL:"),width:t._("Width (optional):"),height:t._("Height (optional):"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#image").val(),r=n.find("#width").val(),i=n.find("#height").val(),s="";r&&(s+=' width="'+r+'"'),i&&(s+=' height="'+i+'"'),o&&"http://"!==o&&t.wysiwygEditorInsertHtml("<img"+s+' src="'+o+'" />'),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertimage",n)},tooltip:"Insert an image"},email:{exec:function(e){var t=this,n=r("email",{label:t._("E-mail:"),insert:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#email").val();o&&(t.focus(),t.getRangeHelper().selectedHtml()?t.execCommand("createlink","mailto:"+o):t.wysiwygEditorInsertHtml('<a href="mailto:'+o+'">'+o+"</a>")),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertemail",n)},tooltip:"Insert an email"},link:{exec:function(e){var t=this,n=r("link",{url:t._("URL:"),desc:t._("Description (optional):"),ins:t._("Insert")},!0);n.find(".button").click(function(e){var o=n.find("#link").val(),r=n.find("#des").val();o&&"http://"!==o&&(t.focus(),!t.getRangeHelper().selectedHtml()||r?(r||(r=o),t.wysiwygEditorInsertHtml('<a href="'+o+'">'+r+"</a>")):t.execCommand("createlink",o)),t.closeDropDown(!0),e.preventDefault()}),t.createDropDown(e,"insertlink",n)},tooltip:"Insert a link"},unlink:{state:function(){var t=e(this.currentNode());return t.is("a")||t.parents("a").length>0?0:-1},exec:function(){var t=e(this.currentNode()),n=t.is("a")?t:t.parents("a").first();n.length&&n.replaceWith(n.contents())},tooltip:"Unlink"},quote:{forceNewLineAfter:["blockquote"],exec:function(t,n,o){var r=e.sceditor.ie,i="<blockquote>",s="</blockquote>";n?(o=o?"<cite>"+o+"</cite>":"",i=i+o+n+s,s=null):""===this.getRangeHelper().selectedHtml()&&(s=r&&11>r?"":"<br />"+s),this.wysiwygEditorInsertHtml(i,s)},tooltip:"Insert a Quote"},emoticon:{exec:function(t){var n=this,o=function(r){var i=n.opts.emoticonsCompat,s=n.getRangeHelper(),l=i&&" "!==s.getOuterText(!0,1)?" ":"",a=i&&" "!==s.getOuterText(!1,1)?" ":"",c=e("<div />"),d=e("<div />").appendTo(c),u=e.extend({},n.opts.emoticons.dropdown,r?n.opts.emoticons.more:{}),f=0;return e.each(u,function(){f++}),f=Math.sqrt(f),e.each(u,function(t,o){d.append(e("<img />").attr({src:o.url||o,alt:t,title:o.tooltip||t}).click(function(){return n.insert(l+e(this).attr("alt")+a,null,!1).closeDropDown(!0),!1})),d.children().length<f||(d=e("<div />").appendTo(c))}),r||c.append(e(n._('<a class="sceditor-more">{0}</a>',n._("More"))).click(function(){return n.createDropDown(t,"more-emoticons",o(!0)),!1})),c};n.createDropDown(t,"emoticons",o(!1))},txtExec:function(t){e.sceditor.command.get("emoticon").exec.call(this,t)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(e,t,n){var o,i=r("youtubeMenu",{label:e._("Video URL:"),insert:e._("Insert")},!0);i.find(".button").click(function(t){var r=i.find("#link").val().replace("http://","");""!==r&&(o=r.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),o&&(r=o[1]),/^[a-zA-Z0-9_\-]{11}$/.test(r)?n(r):alert("Invalid YouTube video")),e.closeDropDown(!0),t.preventDefault()}),e.createDropDown(t,"insertlink",i)},exec:function(t){var n=this;e.sceditor.command.get("youtube")._dropDown(n,t,function(e){n.wysiwygEditorInsertHtml(r("youtube",{id:e}))})},tooltip:"Insert a YouTube video"},date:{_date:function(e){var t=new Date,n=t.getYear(),o=t.getMonth()+1,r=t.getDate();return 2e3>n&&(n=1900+n),10>o&&(o="0"+o),10>r&&(r="0"+r),e.opts.dateFormat.replace(/year/i,n).replace(/month/i,o).replace(/day/i,r)},exec:function(){this.insertText(e.sceditor.command.get("date")._date(this))},txtExec:function(){this.insertText(e.sceditor.command.get("date")._date(this))},tooltip:"Insert current date"},time:{_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds();return 10>t&&(t="0"+t),10>n&&(n="0"+n),10>o&&(o="0"+o),t+":"+n+":"+o},exec:function(){this.insertText(e.sceditor.command.get("time")._time())},txtExec:function(){this.insertText(e.sceditor.command.get("time")._time())},tooltip:"Insert current time"},ltr:{state:function(e,t){return t&&"ltr"===t.style.direction},exec:function(){var t=this,n=t.getRangeHelper().getFirstBlockParent(),o=e(n);t.focus(),(n&&!o.is("body")||(t.execCommand("formatBlock","p"),n=t.getRangeHelper().getFirstBlockParent(),o=e(n),n&&!o.is("body")))&&("ltr"===o.css("direction")?o.css("direction",""):o.css("direction","ltr"))},tooltip:"Left-to-Right"},rtl:{state:function(e,t){return t&&"rtl"===t.style.direction},exec:function(){var t=this,n=t.getRangeHelper().getFirstBlockParent(),o=e(n);t.focus(),(n&&!o.is("body")||(t.execCommand("formatBlock","p"),n=t.getRangeHelper().getFirstBlockParent(),o=e(n),n&&!o.is("body")))&&("rtl"===o.css("direction")?o.css("direction",""):o.css("direction","rtl"))},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize",shortcut:"ctrl+shift+m"},source:{exec:function(){this.toggleSourceMode()},txtExec:function(){this.toggleSourceMode()},tooltip:"View source",shortcut:"ctrl+shift+s"},ignore:{}},e.sceditor.rangeHelper=function(t,n){var o,r,i,s=n||t.contentDocument||t.document,l=t,a=!!t.getSelection,c="sceditor-start-marker",d="sceditor-end-marker",u="character",f=this;f.insertHTML=function(e,t){var n,o,r=f.selectedRange();if(a){for(t&&(e+=f.selectedHtml()+t),o=s.createElement("div"),n=s.createDocumentFragment(),o.innerHTML=e;o.firstChild;)n.appendChild(o.firstChild);f.insertNode(n)}else{if(!r)return!1;r.pasteHTML(i(e,t,!0))}},i=function(t,n,r){var i,l,a,u=s.createElement("div");if("string"==typeof t?(n&&(t+=f.selectedHtml()+n),u.innerHTML=t):(u.appendChild(t),n&&(u.appendChild(range.extractContents()),u.appendChild(n))),i=u.lastChild){if(f.removeMarkers(),l=e(i),e.sceditor.dom.canHaveChildren(i)?(i.lastChild||l.append(s.createTextNode("​")),l.append(o(d)).append(o(c))):l.after(o(c)).after(o(d)),r)return u.innerHTML;for(a=s.createDocumentFragment();u.firstChild;)a.appendChild(u.firstChild);return a}},f.insertNode=function(e,t){if(a){var n=i(e,t),o=f.selectedRange(),r=o.commonAncestorContainer;if(!n)return!1;o.deleteContents(),r&&/^(br|hr)$/i.test(r.nodeName)?r.parentNode.insertBefore(n,r):o.insertNode(n),f.restoreRange()}else f.insertHTML(e.outerHTML,t?t.outerHTML:null)},f.cloneSelected=function(){var e=f.selectedRange();return e?a?e.cloneRange():e.duplicate():void 0},f.selectedRange=function(){var e,t,n=a?l.getSelection():s.selection;if(n){if(n.getRangeAt&&n.rangeCount<=0){for(t=s.body;t.firstChild;)t=t.firstChild;e=s.createRange(),e.setStart(t,0),n.addRange(e)}return a&&(e=n.getRangeAt(0)),a||"Control"===n.type||(e=n.createRange()),r(e)?e:null}},r=function(e){var t;return e&&e.parentElement&&(t=e.parentElement())?t.ownerDocument===s:!0},f.hasSelection=function(){var e,t=a?l.getSelection():s.selection;return a||!t?t&&t.rangeCount>0:(e=t.createRange(),e&&r(e))},f.selectedHtml=function(){var e,t=f.selectedRange();return t?!a&&""!==t.text&&t.htmlText?t.htmlText:a?(e=s.createElement("div"),e.appendChild(t.cloneContents()),e.innerHTML):"":""},f.parentNode=function(){var e=f.selectedRange();return e?e.parentElement?e.parentElement():e.commonAncestorContainer:void 0},f.getFirstBlockParent=function(t){var n=function(t){return e.sceditor.dom.isInline(t,!0)?(t=t?t.parentNode:null,t?n(t):null):t};return n(t||f.parentNode())},f.insertNodeAt=function(e,t){var n=f.selectedRange(),o=f.cloneSelected();return o?(o.collapse(e),o.insertNode?o.insertNode(t):o.pasteHTML(t.outerHTML),void f.selectRange(n)):!1},o=function(e){f.removeMarker(e);var t=s.createElement("span");return t.id=e,t.style.lineHeight="0",t.style.display="none",t.className="sceditor-selection sceditor-ignore",t.innerHTML=" ",t},f.insertMarkers=function(){f.insertNodeAt(!0,o(c)),f.insertNodeAt(!1,o(d))},f.getMarker=function(e){return s.getElementById(e)},f.removeMarker=function(e){var t=f.getMarker(e);t&&t.parentNode.removeChild(t)},f.removeMarkers=function(){f.removeMarker(c),f.removeMarker(d)},f.saveRange=function(){f.insertMarkers()},f.selectRange=function(e){a?(l.getSelection().removeAllRanges(),l.getSelection().addRange(e)):e.select()},f.restoreRange=function(){var e,t=f.selectedRange(),n=f.getMarker(c),o=f.getMarker(d);return n&&o&&t?(a?(t=s.createRange(),t.setStartBefore(n),t.setEndAfter(o)):(t=s.body.createTextRange(),e=s.body.createTextRange(),e.moveToElementText(n),t.setEndPoint("StartToStart",e),t.moveStart(u,0),e.moveToElementText(o),t.setEndPoint("EndToStart",e),t.moveEnd(u,0)),f.selectRange(t),void f.removeMarkers()):!1},f.selectOuterText=function(e,t){var n=f.cloneSelected();return n?(n.collapse(!1),a?(n.setStart(n.startContainer,n.startOffset-e),n.setEnd(n.endContainer,n.endOffset+t)):(n.moveStart(u,0-e),n.moveEnd(u,t)),void f.selectRange(n)):!1},f.getOuterText=function(e,t){var n="",o=f.cloneSelected();return o?(o.collapse(!1),e?a?(n=o.startContainer.textContent.substr(0,o.startOffset),n=n.substr(Math.max(0,n.length-t))):(o.moveStart(u,0-t),n=o.text):a?n=o.startContainer.textContent.substr(o.startOffset,t):(o.moveEnd(u,t),n=o.text),n):""},f.raplaceKeyword=function(t,n,o,r,i,s){o||t.sort(function(e,t){return e.length-t.length});var l,c,d,u,p,h,m,g=t.length,b=r||t[g-1][0].length;if(i){if(!a)return!1;++b}for(l=f.getOuterText(!0,b),c=l+(null!=s?s:""),n&&(c+=f.getOuterText(!1,b));g--;)if(m=t[g][0],p=RegExp("(?:[\\s    ])"+e.sceditor.regexEscape(m)+"(?=[\\s    ])"),h=l.length-1-m.length,i&&--h,h=Math.max(0,h),(d=i?c.substr(h).search(p):c.indexOf(m,h))>-1){if(i&&(d+=h+1),d>l.length||d+m.length+(i?1:0)<l.length)continue;return u=l.length-d,f.selectOuterText(u,m.length-u-(null!=s&&/^\S/.test(s)?1:0)),f.insertHTML(t[g][1]),!0}return!1},f.compare=function(e,t){return t||(t=f.selectedRange()),e&&t?a?0===e.compareBoundaryPoints(Range.END_TO_END,t)&&0===e.compareBoundaryPoints(Range.START_TO_START,t):r(e)&&r(t)&&0===e.compareEndPoints("EndToEnd",t)&&0===e.compareEndPoints("StartToStart",t):!e&&!t},f.clear=function(){var e=a?l.getSelection():s.selection;e&&(e.removeAllRanges?e.removeAllRanges():e.empty&&e.empty())}},e.sceditor.dom={traverse:function(e,t,n,o,r){if(e)for(e=r?e.lastChild:e.firstChild;null!=e;){var i=r?e.previousSibling:e.nextSibling;if(!n&&t(e)===!1)return!1;if(!o&&this.traverse(e,t,n,o,r)===!1)return!1;if(n&&t(e)===!1)return!1;e=i}},rTraverse:function(e,t,n,o){this.traverse(e,t,n,o,!0)},parseHTML:function(t,o){var r=[],i=(o||n).createElement("div");return i.innerHTML=t,e.merge(r,i.childNodes),r},hasStyling:function(t){var n=e(t);return t&&(!n.is("p,div")||t.className||n.attr("style")||!e.isEmptyObject(n.data()))},convertElement:function(t,n){for(var o,r,i=t.attributes.length,s=t.ownerDocument.createElement(n);i--;)r=t.attributes[i],(!e.sceditor.ie||r.specified)&&(e.sceditor.ie<8&&/style/i.test(r.name)?t.style.cssText=t.style.cssText:s.setAttribute(r.name,r.value));for(;o=t.firstChild;)s.appendChild(o);return t.parentNode.replaceChild(s,t),s},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",canHaveChildren:function(e){return/11?|9/.test(e.nodeType)?"hr,br,img,input,meta,link,iframe,".indexOf(e.nodeName.toLowerCase()+",")<0:!1},isInline:function(t,n){return t&&1===t.nodeType?(t=t.tagName.toLowerCase(),"code"===t?!n:e.sceditor.dom.blockLevelList.indexOf("|"+t+"|")<0):!0},copyCSS:function(e,t){t.style.cssText=e.style.cssText+t.style.cssText},fixNesting:function(e){var t=this,n=function(e){for(;t.isInline(e.parentNode,!0);)e=e.parentNode;return e};t.traverse(e,function(e){if(1===e.nodeType&&!t.isInline(e,!0)&&t.isInline(e.parentNode,!0)){var o=n(e),r=o.parentNode,i=t.extractContents(o,e),s=e;t.copyCSS(o,s),r.insertBefore(i,o),r.insertBefore(s,o)}})},findCommonAncestor:function(t,n){return e(t).parents().has(e(n)).first()},getSibling:function(t,n){var o;return t?(o=t[n?"previousSibling":"nextSibling"])?o:e.sceditor.dom.getSibling(t.parentNode,n):null},removeWhiteSpace:function(t,n){for(var o,r,i,s,l,a,c,d,u=e.sceditor.dom.getSibling,f=e.sceditor.dom.isInline,p=t.firstChild,h=/[\t ]+/g,m=/[\t\n\r ]+/g;p;){if(a=p.nextSibling,o=p.nodeValue,r=p.nodeType,1===r&&p.firstChild&&(l=e(p).css("whiteSpace"),/pre(?:\-wrap)?$/i.test(l)||e.sceditor.dom.removeWhiteSpace(p,/line$/i.test(l))),3===r&&o){for(i=u(p),s=u(p,!0),d=s,c=!1;e(d).hasClass("sceditor-ignore");)d=u(d,!0);if(f(p)&&d){for(;d.lastChild;)d=d.lastChild;c=3===d.nodeType?/[\t\n\r ]$/.test(d.nodeValue):!f(d)}f(p)&&s&&f(s)&&!c||(o=o.replace(/^[\t\n\r ]+/,"")),f(p)&&i&&f(i)||(o=o.replace(/[\t\n\r ]+$/,"")),o=o.replace(/\u200B/g,""),o.length?p.nodeValue=o.replace(n?h:m," "):t.removeChild(p)}p=a}},extractContents:function(e,t){var n=this,o=n.findCommonAncestor(e,t),r=o?o[0]:null,i=!1,s=!1;return function l(o){var r=e.ownerDocument.createDocumentFragment();return n.traverse(o,function(n){if(s||n===t&&i)return s=!0,!1;n===e&&(i=!0);var o,a;i?jQuery.contains(n,t)&&1===n.nodeType?(o=l(n),a=n.cloneNode(!1),a.appendChild(o),r.appendChild(a)):r.appendChild(n):jQuery.contains(n,e)&&1===n.nodeType&&(o=l(n),a=n.cloneNode(!1),a.appendChild(o),r.appendChild(a))},!1),r}(r)},getOffset:function(e){for(var t=0,n=0;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return{left:t,top:n}},getStyle:function(t,n){var o,r,i,s,l=t.style;if(!l)return null;if(e.sceditor.dom._propertyCache||(e.sceditor.dom._propertyCache={}),i=e.sceditor.dom._propertyCache,i[n]||(i[n]=e.camelCase(n)),n=i[n],s=l[n],"textAlign"===n){if(o=e(t),r=l.direction,s=s||o.css(n),o.parent().css(n)===s||"block"!==o.css("display")||o.is("hr")||o.is("th"))return null;if(r&&s&&(/right/i.test(s)&&"rtl"===r||/left/i.test(s)&&"ltr"===r))return null}return s},hasStyle:function(t,n,o){var r=e.sceditor.dom.getStyle(t,n);return r?!1:!o||r===o||e.isArray(o)&&e.inArray(r,o)>-1}},e.sceditor.plugins={},e.sceditor.PluginManager=function(t){var n=this,o=[],r=t,i=function(e){return"signal"+e.charAt(0).toUpperCase()+e.slice(1)},s=function(e,t){e=[].slice.call(e);for(var n=o.length,s=i(e.shift());n--;)if(s in o[n]){if(t)return o[n][s].apply(r,e);o[n][s].apply(r,e)}};n.call=function(){s(arguments,!1)},n.callOnlyFirst=function(){return s(arguments,!0)},n.iter=function(e){return e=i(e),function(){var t=o.length;return{callNext:function(n){for(;t--;)if(o[t]&&e in o[t])return o[t].apply(r,n)},hasNext:function(){for(var n=t;n--;)if(o[n]&&e in o[n])return!0;return!1}}}()},n.hasHandler=function(e){var t=o.length;for(e=i(e);t--;)if(e in o[t])return!0;return!1},n.exists=function(t){return t in e.sceditor.plugins?(t=e.sceditor.plugins[t],"function"==typeof t&&"object"==typeof t.prototype):!1},n.isRegistered=function(t){var r=o.length;if(!n.exists(t))return!1;for(;r--;)if(o[r]instanceof e.sceditor.plugins[t])return!0;return!1},n.register=function(t){return n.exists(t)?(t=new e.sceditor.plugins[t],o.push(t),"init"in t&&t.init.apply(r),!0):!1},n.deregister=function(t){var i,s=o.length,l=!1;if(!n.isRegistered(t))return!1;for(;s--;)o[s]instanceof e.sceditor.plugins[t]&&(i=o.splice(s,1)[0],l=!0,"destroy"in i&&i.destroy.apply(r));return l},n.destroy=function(){for(var e=o.length;e--;)"destroy"in o[e]&&o[e].destroy.apply(r);o=null,r=null}},e.sceditor.command={get:function(t){return e.sceditor.commands[t]||null},set:function(t,n){return t&&n?(n=e.extend(e.sceditor.commands[t]||{},n),n.remove=function(){e.sceditor.command.remove(t)},e.sceditor.commands[t]=n,this):!1},remove:function(t){return e.sceditor.commands[t]&&delete e.sceditor.commands[t],this}},e.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist,indent,outdent|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:e("html").attr("lang")||"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,parserOptions:{},dropDownCss:{}},e.fn.sceditor=function(t){var n,o=[];return t=t||{},t.runWithoutWysiwygSupport||e.sceditor.isWysiwygSupported?(this.each(function(){n=this.jquery?this:e(this),n.parents(".sceditor-container").length>0||("state"===t?o.push(!!n.data("sceditor")):"instance"===t?o.push(n.data("sceditor")):n.data("sceditor")||new e.sceditor(this,t))}),o.length?1===o.length?o[0]:e(o):this):void 0}}(jQuery,window,document);