// http://localhost/elkarte/themes/default/elk_jquery_plugins.js script.js script_elk.js theme.js fader.js
(function($){$.fn.hoverIntent=function(handlerIn,handlerOut,selector){var cfg={interval:50,sensitivity:8,timeout:1};if(typeof handlerIn==="object"){cfg=$.extend(cfg,handlerIn)}else if($.isFunction(handlerOut)){cfg=$.extend(cfg,{over:handlerIn,out:handlerOut,selector:selector})}else cfg=$.extend(cfg,{over:handlerIn,out:handlerIn,selector:handlerOut});var cX,cY,pX,pY,track=function(ev){cX=ev.pageX;cY=ev.pageY},compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).off("mousemove.hoverIntent",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}},delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])},handleHover=function(e){var ev=jQuery.extend({},e),ob=this;if(ob.hoverIntent_t)ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).on("mousemove.hoverIntent",track);if(ob.hoverIntent_s!=1)ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}else{$(ob).off("mousemove.hoverIntent",track);if(ob.hoverIntent_s==1)ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}};return this.on({'mouseenter.hoverIntent':handleHover,'mouseleave.hoverIntent':handleHover},cfg.selector)}})(jQuery);(function($){"use strict";var methods=(function(){var c={bcClass:'sf-breadcrumb',menuClass:'sf-js-enabled',anchorClass:'sf-with-ul',menuArrowClass:'sf-arrows'},ios=(function(){var ios=/iPhone|iPad|iPod/i.test(navigator.userAgent);if(ios)$(window).load(function(){$('body').children().on('click',$.noop)});return ios})(),wp7=(function(){var style=document.documentElement.style;return('behavior'in style&&'fill'in style&&/iemobile/i.test(navigator.userAgent))})(),toggleMenuClasses=function($menu,o){var classes=c.menuClass;if(o.cssArrows)classes+=' '+c.menuArrowClass;$menu.toggleClass(classes)},setPathToCurrent=function($menu,o){return $menu.find('li.'+o.pathClass).slice(0,o.pathLevels).addClass(o.hoverClass+' '+c.bcClass).filter(function(){return($(this).children('ul').hide().show().length)}).removeClass(o.pathClass)},toggleAnchorClass=function($li){$li.children('a').toggleClass(c.anchorClass)},toggleTouchAction=function($menu){var touchAction=$menu.css('ms-touch-action');touchAction=(touchAction==='pan-y')?'auto':'pan-y';$menu.css('ms-touch-action',touchAction)},applyHandlers=function($menu,o){var targets='li:has(ul)';if($.fn.hoverIntent&&!o.disableHI){$menu.hoverIntent(over,out,targets)}else $menu.on('mouseenter.superfish',targets,over).on('mouseleave.superfish',targets,out);var touchevent='MSPointerDown.superfish';if(!ios)touchevent+=' touchend.superfish';if(wp7)touchevent+=' mousedown.superfish';$menu.on('focusin.superfish','li',over).on('focusout.superfish','li',out).on(touchevent,'a',touchHandler)},touchHandler=function(e){var $this=$(this),$ul=$this.siblings('ul');if($ul.length>0&&$ul.is(':hidden')){$this.one('click.superfish',false);if(e.type==='MSPointerDown'){$this.trigger('focus')}else $.proxy(over,$this.parent('li'))()}},over=function(){var $this=$(this),o=getOptions($this);clearTimeout(o.sfTimer);$this.siblings().superfish('hide').end().superfish('show')},out=function(){var $this=$(this),o=getOptions($this);if(ios){$.proxy(close,$this,o)()}else{clearTimeout(o.sfTimer);o.sfTimer=setTimeout($.proxy(close,$this,o),o.delay)}},close=function(o){o.retainPath=($.inArray(this[0],o.$path)>-1);this.superfish('hide');if(!this.parents('.'+o.hoverClass).length){o.onIdle.call(getMenu(this));if(o.$path.length)$.proxy(over,o.$path)()}},getMenu=function($el){return $el.closest('.'+c.menuClass)},getOptions=function($el){return getMenu($el).data('sf-options')};return{hide:function(instant){if(this.length){var $this=this,o=getOptions($this);if(!o)return this;var not=(o.retainPath===true)?o.$path:'',$ul=$this.find('li.'+o.hoverClass).add(this).not(not).removeClass(o.hoverClass).children('ul'),speed=o.speedOut;if(instant){$ul.show();speed=0};o.retainPath=false;o.onBeforeHide.call($ul);$ul.stop(true,true).animate(o.animationOut,speed,function(){var $this=$(this);o.onHide.call($this)})};return this},show:function(){var o=getOptions(this);if(!o)return this;var $this=this.addClass(o.hoverClass),$ul=$this.children('ul');o.onBeforeShow.call($ul);$ul.stop(true,true).animate(o.animation,o.speed,function(){o.onShow.call($ul)});return this},destroy:function(){return this.each(function(){var $this=$(this),o=$this.data('sf-options'),$liHasUl=$this.find('li:has(ul)');if(!o)return false;clearTimeout(o.sfTimer);toggleMenuClasses($this,o);toggleAnchorClass($liHasUl);toggleTouchAction($this);$this.off('.superfish').off('.hoverIntent');$liHasUl.children('ul').attr('style',function(i,style){return style.replace(/display[^;]+;?/g,'')});o.$path.removeClass(o.hoverClass+' '+c.bcClass).addClass(o.pathClass);$this.find('.'+o.hoverClass).removeClass(o.hoverClass);o.onDestroy.call($this);$this.removeData('sf-options')})},init:function(op){return this.each(function(){var $this=$(this);if($this.data('sf-options'))return false;var o=$.extend({},$.fn.superfish.defaults,op),$liHasUl=$this.find('li:has(ul)');o.$path=setPathToCurrent($this,o);$this.data('sf-options',o);toggleMenuClasses($this,o);toggleAnchorClass($liHasUl);toggleTouchAction($this);applyHandlers($this,o);$liHasUl.not('.'+c.bcClass).superfish('hide',true);o.onInit.call(this)})}}})();$.fn.superfish=function(method,args){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments)}else return $.error('Method '+method+' does not exist on jQuery.fn.superfish')};$.fn.superfish.defaults={hoverClass:'sfhover',pathClass:'overrideThisToUse',pathLevels:1,delay:800,animation:{opacity:'show',height:'show',width:'show'},animationOut:{opacity:'hide'},speed:'normal',speedOut:'fast',cssArrows:false,disableHI:false,onInit:$.noop,onBeforeShow:$.noop,onShow:$.noop,onBeforeHide:$.noop,onHide:$.noop,onIdle:$.noop,onDestroy:$.noop};$.fn.extend({hideSuperfishUl:methods.hide,showSuperfishUl:methods.show})})(jQuery);(function($){var methods=(function(){var c={bcClass:'sf-breadcrumb',menuClass:'sf-js-enabled',anchorClass:'sf-with-ul',menuArrowClass:'sf-arrows'},outerClick=(function(){$(window).load(function(){$('body').children().on('click.superclick',function(){var $allMenus=$('.sf-js-enabled');$allMenus.superclick('reset')})})})(),toggleMenuClasses=function($menu,o){var classes=c.menuClass;if(o.cssArrows)classes+=' '+c.menuArrowClass;$menu.toggleClass(classes)},setPathToCurrent=function($menu,o){return $menu.find('li.'+o.pathClass).slice(0,o.pathLevels).addClass(o.activeClass+' '+c.bcClass).filter(function(){return($(this).children('ul').hide().show().length)}).removeClass(o.pathClass)},toggleAnchorClass=function($li){$li.children('a').toggleClass(c.anchorClass)},toggleTouchAction=function($menu){var touchAction=$menu.css('ms-touch-action');touchAction=(touchAction==='pan-y')?'auto':'pan-y';$menu.css('ms-touch-action',touchAction)},clickHandler=function(e){var $this=$(this),$ul=$this.siblings('ul'),func;if($ul.length){func=($ul.is(':hidden'))?over:out;$.proxy(func,$this.parent('li'))();return false}},over=function(){var $this=$(this),o=getOptions($this);$this.siblings().superclick('hide').end().superclick('show')},out=function(){var $this=$(this),o=getOptions($this);$.proxy(close,$this,o)()},close=function(o){o.retainPath=($.inArray(this[0],o.$path)>-1);this.superclick('hide');if(!this.parents('.'+o.activeClass).length){o.onIdle.call(getMenu(this));if(o.$path.length)$.proxy(over,o.$path)()}},getMenu=function($el){return $el.closest('.'+c.menuClass)},getOptions=function($el){return getMenu($el).data('sf-options')};return{hide:function(instant){if(this.length){var $this=this,o=getOptions($this);if(!o)return this;var not=(o.retainPath===true)?o.$path:'',$ul=$this.find('li.'+o.activeClass).add(this).not(not).removeClass(o.activeClass).children('ul'),speed=o.speedOut;if(instant){$ul.show();speed=0};o.retainPath=false;o.onBeforeHide.call($ul);$ul.stop(true,true).animate(o.animationOut,speed,function(){var $this=$(this);o.onHide.call($this)})};return this},show:function(){var o=getOptions(this);if(!o)return this;var $this=this.addClass(o.activeClass),$ul=$this.children('ul');o.onBeforeShow.call($ul);$ul.stop(true,true).animate(o.animation,o.speed,function(){o.onShow.call($ul)});return this},destroy:function(){return this.each(function(){var $this=$(this),o=$this.data('sf-options'),$liHasUl=$this.find('li:has(ul)');if(!o)return false;toggleMenuClasses($this,o);toggleAnchorClass($liHasUl);toggleTouchAction($this);$this.off('.superclick');$liHasUl.children('ul').attr('style',function(i,style){return style.replace(/display[^;]+;?/g,'')});o.$path.removeClass(o.activeClass+' '+c.bcClass).addClass(o.pathClass);$this.find('.'+o.activeClass).removeClass(o.activeClass);o.onDestroy.call($this);$this.removeData('sf-options')})},reset:function(){return this.each(function(){var $menu=$(this),o=getOptions($menu),$openLis=$($menu.find('.'+o.activeClass).toArray().reverse());$openLis.children('a').trigger('click')})},init:function(op){return this.each(function(){var $this=$(this);if($this.data('sf-options'))return false;var o=$.extend({},$.fn.superclick.defaults,op),$liHasUl=$this.find('li:has(ul)');o.$path=setPathToCurrent($this,o);$this.data('sf-options',o);toggleMenuClasses($this,o);toggleAnchorClass($liHasUl);toggleTouchAction($this);$this.on('click.superclick','a',clickHandler);$liHasUl.not('.'+c.bcClass).superclick('hide',true);o.onInit.call(this)})}}})();$.fn.superclick=function(method,args){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments)}else return $.error('Method '+method+' does not exist on jQuery.fn.superclick')};$.fn.superclick.defaults={activeClass:'sfhover',pathClass:'overrideThisToUse',pathLevels:1,animation:{opacity:'show'},animationOut:{opacity:'hide'},speed:'normal',speedOut:'fast',cssArrows:false,onInit:$.noop,onBeforeShow:$.noop,onShow:$.noop,onBeforeHide:$.noop,onHide:$.noop,onIdle:$.noop,onDestroy:$.noop}})(jQuery);var elk_formSubmitted=false,lastKeepAliveCheck=new Date().getTime(),ajax_indicator_ele=null,ua=navigator.userAgent.toLowerCase(),is_opera=!!window.opera,is_ff=typeof InstallTrigger!=='undefined'||((ua.indexOf('iceweasel')!==-1||ua.indexOf('icecat')!==-1||ua.indexOf('shiretoko')!==-1||ua.indexOf('minefield')!==-1)&&!is_opera),is_safari=Object.prototype.toString.call(window.HTMLElement).indexOf('Constructor')>0,is_chrome=!!window.chrome,is_ie=!!document.documentMode,is_webkit=ua.indexOf('applewebkit')!==-1;if(!('getElementsByClassName'in document))document.getElementsByClassName=function(className){return $('.'+className)}
function getXMLDocument(sUrl,funcCallback){var oMyDoc=new XMLHttpRequest(),bAsync=typeof funcCallback!=='undefined',oCaller=this;if(bAsync)oMyDoc.onreadystatechange=function(){if(oMyDoc.readyState!==4)return;if(oMyDoc.responseXML!==null&&oMyDoc.status===200){funcCallback.call(oCaller,oMyDoc.responseXML)}else funcCallback.call(oCaller,false)};oMyDoc.open('GET',sUrl,bAsync);oMyDoc.send(null);return oMyDoc}
function sendXMLDocument(sUrl,sContent,funcCallback){var oSendDoc=new window.XMLHttpRequest(),oCaller=this;if(typeof funcCallback!=='undefined')oSendDoc.onreadystatechange=function(){if(oSendDoc.readyState!==4)return;if(oSendDoc.responseXML!==null&&oSendDoc.status===200){funcCallback.call(oCaller,oSendDoc.responseXML)}else funcCallback.call(oCaller,false)};oSendDoc.open('POST',sUrl,true);if('setRequestHeader'in oSendDoc)oSendDoc.setRequestHeader('Content-Type','application/x-www-form-urlencoded');oSendDoc.send(sContent);return true};String.prototype.oCharsetConversion={from:'',to:''};String.prototype.php_to8bit=function(){var n,sReturn='';for(var i=0,iTextLen=this.length;i<iTextLen;i++){n=this.charCodeAt(i);if(n<128){sReturn+=String.fromCharCode(n)}else if(n<2048){sReturn+=String.fromCharCode(192|n>>6)+String.fromCharCode(128|n&63)}else if(n<65536){sReturn+=String.fromCharCode(224|n>>12)+String.fromCharCode(128|n>>6&63)+String.fromCharCode(128|n&63)}else sReturn+=String.fromCharCode(240|n>>18)+String.fromCharCode(128|n>>12&63)+String.fromCharCode(128|n>>6&63)+String.fromCharCode(128|n&63)};return sReturn};String.prototype.php_strtr=function(sFrom,sTo){return this.replace(new RegExp('['+sFrom+']','g'),function(sMatch){return sTo.charAt(sFrom.indexOf(sMatch))})};String.prototype.php_strtolower=function(){return typeof elk_iso_case_folding==='boolean'&&elk_iso_case_folding===true?this.php_strtr('ABCDEFGHIJKLMNOPQRSTUVWXYZ\x8a\x8c\x8e\x9f\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde','abcdefghijklmnopqrstuvwxyz\x9a\x9c\x9e\xff\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe'):this.php_strtr('ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz')};String.prototype.php_urlencode=function(){return escape(this).replace(/\+/g,'%2b').replace('*','%2a').replace('/','%2f').replace('@','%40')};String.prototype.php_htmlspecialchars=function(){return this.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;')};String.prototype.php_unhtmlspecialchars=function(){return this.replace(/&quot;/g,'"').replace(/&gt;/g,'>').replace(/&lt;/g,'<').replace(/&amp;/g,'&')};String.prototype.php_addslashes=function(){return this.replace(/\\/g,'\\\\').replace(/'/g,'\\\'')};String.prototype._replaceEntities=function(sInput,sDummy,sNum){return String.fromCharCode(parseInt(sNum))};String.prototype.removeEntities=function(){return this.replace(/&(amp;)?#(\d+);/g,this._replaceEntities)};String.prototype.easyReplace=function(oReplacements){var sResult=this;for(var sSearch in oReplacements)sResult=sResult.replace(new RegExp('%'+sSearch+'%','g'),oReplacements[sSearch]);return sResult}
function php_str_repeat(sString,iTime){if(iTime<1){return''}else return sString+php_str_repeat(sString,iTime-1)}
function reqWin(desktopURL,alternateWidth,alternateHeight,noScrollbars){if((alternateWidth&&self.screen.availWidth*0.8<alternateWidth)||(alternateHeight&&self.screen.availHeight*0.8<alternateHeight)){noScrollbars=false;alternateWidth=Math.min(alternateWidth,self.screen.availWidth*0.8);alternateHeight=Math.min(alternateHeight,self.screen.availHeight*0.8)}else noScrollbars=typeof noScrollbars==='boolean'&&noScrollbars===true;window.open(desktopURL,'requested_popup','toolbar=no,location=no,status=no,menubar=no,scrollbars='+(noScrollbars?'no':'yes')+',width='+(alternateWidth?alternateWidth:480)+',height='+(alternateHeight?alternateHeight:220)+',resizable=no');return false}
function reqOverlayDiv(desktopURL,sHeader,sIcon){var sAjax_indicator='<div class="centertext"><img src="'+elk_images_url+'/loading.gif" ></div>';sIcon=elk_images_url+'/'+(typeof sIcon==='string'?sIcon:'helptopics.png'),sHeader=typeof sHeader==='string'?sHeader:help_popup_heading_text;var oContainer=new smc_Popup({heading:sHeader,content:sAjax_indicator,icon:sIcon}),oPopup_body=$('#'+oContainer.popup_id).find('.popup_content');$.ajax({url:desktopURL,type:"GET",dataType:"html"}).done(function(data,textStatus,xhr){var help_content=$('<div id="temp_help">').html(data).find('a[href$="self.close();"]').hide().prev('br').hide().parent().html();oPopup_body.html(help_content)}).fail(function(xhr,textStatus,errorThrown){oPopup_body.html(textStatus)});return false}
function smc_Popup(oOptions){this.opt=oOptions;this.popup_id=this.opt.custom_id?this.opt.custom_id:'elk_popup';this.show()};smc_Popup.prototype.show=function(){popup_class='popup_window '+(this.opt.custom_class?this.opt.custom_class:'description');icon=this.opt.icon?'<img src="'+this.opt.icon+'" class="icon" alt="" /> ':'';$('body').append('<div id="'+this.popup_id+'" class="popup_container"><div class="'+popup_class+'" style="max-height: none;"><h3 class="popup_heading"><a href="javascript:void(0);" class="hide_popup" title="Close"></a>'+icon+this.opt.heading+'</h3><div class="popup_content">'+this.opt.content+'</div></div></div>');this.popup_body=$('#'+this.popup_id).children('.popup_window');this.popup_body.parent().fadeIn(300);var popup_instance=this;$(document).mouseup(function(e){if($('#'+popup_instance.popup_id).has(e.target).length===0)popup_instance.hide()}).keyup(function(e){if(e.keyCode===27)popup_instance.hide()});$('#'+this.popup_id).find('.hide_popup').click(function(){return popup_instance.hide()});return false};smc_Popup.prototype.hide=function(){$('#'+this.popup_id).fadeOut(300,function(){$(this).remove()});return false}
function replaceText(text,oTextHandle){if('selectionStart'in oTextHandle){var begin=oTextHandle.value.substr(0,oTextHandle.selectionStart),end=oTextHandle.value.substr(oTextHandle.selectionEnd),scrollPos=oTextHandle.scrollTop,goForward=0;oTextHandle.value=begin+text+end;if(oTextHandle.setSelectionRange){oTextHandle.focus();if(is_opera&&text.match(/\n/g)!==null)goForward=text.match(/\n/g).length;oTextHandle.setSelectionRange(begin.length+text.length+goForward,begin.length+text.length+goForward)};oTextHandle.scrollTop=scrollPos}else{oTextHandle.value+=text;oTextHandle.focus(oTextHandle.value.length-1)}}
function isEmptyText(theField){var theValue;if(typeof theField==='string'){theValue=theField}else theValue=theField.value;while(theValue.length>0&&(theValue.charAt(0)===' '||theValue.charAt(0)==='\t'))theValue=theValue.substring(1,theValue.length);while(theValue.length>0&&(theValue.charAt(theValue.length-1)===' '||theValue.charAt(theValue.length-1)==='\t'))theValue=theValue.substring(0,theValue.length-1);if(theValue===''){return true}else return false}
function submitonce(theform){elk_formSubmitted=true}
function submitThisOnce(oControl){var oForm='form'in oControl?oControl.form:oControl,aTextareas=oForm.getElementsByTagName('textarea');for(var i=0,n=aTextareas.length;i<n;i++)aTextareas[i].readOnly=true;return!elk_formSubmitted}
function setInnerHTML(oElement,sToValue){if(oElement)oElement.innerHTML=sToValue}
function getInnerHTML(oElement){if(oElement)return oElement.innerHTML}
function setOuterHTML(oElement,sToValue){if('outerHTML'in oElement){oElement.outerHTML=sToValue}else{var range=document.createRange();range.setStartBefore(oElement);oElement.parentNode.replaceChild(range.createContextualFragment(sToValue),oElement)}}
function in_array(variable,theArray){for(var i in theArray)if(theArray[i]==variable)return true;return false}
function array_search(variable,theArray){for(var i in theArray)if(theArray[i]==variable)return i;return null}
function selectRadioByName(oRadioGroup,sName){if(!('length'in oRadioGroup))return oRadioGroup.checked=true;for(var i=0,n=oRadioGroup.length;i<n;i++)if(oRadioGroup[i].value===sName)return oRadioGroup[i].checked=true;return false}
function selectAllRadio(oInvertCheckbox,oForm,sMask,sValue){for(var i=0;i<oForm.length;i++)if(oForm[i].name!==undefined&&oForm[i].name.substr(0,sMask.length)==sMask&&oForm[i].value==sValue)oForm[i].checked=true}
function invertAll(oInvertCheckbox,oForm,sMask,bIgnoreDisabled){for(var i=0;i<oForm.length;i++){if(!('name'in oForm[i])||(typeof sMask==='string'&&oForm[i].name.substr(0,sMask.length)!==sMask&&oForm[i].id.substr(0,sMask.length)!==sMask))continue;if(!oForm[i].disabled||(typeof bIgnoreDisabled==='boolean'&&bIgnoreDisabled))oForm[i].checked=oInvertCheckbox.checked}};var lastKeepAliveCheck=new Date().getTime()
function elk_sessionKeepAlive(){var curTime=new Date().getTime();if(elk_scripturl&&curTime-lastKeepAliveCheck>9e5){var tempImage=new Image();tempImage.src=elk_prepareScriptUrl(elk_scripturl)+'action=keepalive;time='+curTime;lastKeepAliveCheck=curTime};window.setTimeout('elk_sessionKeepAlive();',12e5)};window.setTimeout('elk_sessionKeepAlive();',12e5)
function elk_setThemeOption(option,value,theme,cur_session_id,cur_session_var,additional_vars){if(cur_session_id===null)cur_session_id=elk_session_id;if(typeof cur_session_var==='undefined')cur_session_var='sesc';if(additional_vars===null)additional_vars='';var tempImage=new Image();tempImage.src=elk_prepareScriptUrl(elk_scripturl)+'action=jsoption;var='+option+';val='+value+';'+cur_session_var+'='+cur_session_id+additional_vars+(theme===null?'':'&th='+theme)+';time='+(new Date().getTime())}
function elk_avatarResize(){var possibleAvatars=document.getElementsByTagName('img');for(var i=0;i<possibleAvatars.length;i++){var tempAvatars=[];j=0;if(possibleAvatars[i].className!=='avatar')continue;tempAvatars[j]=new Image();tempAvatars[j].avatar=possibleAvatars[i];tempAvatars[j].onload=function(){this.avatar.width=this.width;this.avatar.height=this.height;if(elk_avatarMaxWidth!==0&&this.width>elk_avatarMaxWidth){this.avatar.height=(elk_avatarMaxWidth*this.height)/this.width;this.avatar.width=elk_avatarMaxWidth};if(elk_avatarMaxHeight!==0&&this.avatar.height>elk_avatarMaxHeight){this.avatar.width=(elk_avatarMaxHeight*this.avatar.width)/this.avatar.height;this.avatar.height=elk_avatarMaxHeight}};tempAvatars[j].src=possibleAvatars[i].src;j++};if(typeof window_oldAvatarOnload!=='undefined'&&window_oldAvatarOnload){window_oldAvatarOnload();window_oldAvatarOnload=null}}
function hashLoginPassword(doForm,cur_session_id,token){if(cur_session_id===null)cur_session_id=elk_session_id;if(typeof hex_sha1==='undefined')return;if(doForm.user.value.indexOf('@')!==-1)return;if(!('opera'in window))doForm.passwrd.autocomplete='off';doForm.hash_passwrd.value=hex_sha1(hex_sha1(doForm.user.value.php_to8bit().php_strtolower()+doForm.passwrd.value.php_to8bit())+cur_session_id+token);if(is_ff!==-1){doForm.passwrd.value=''}else doForm.passwrd.value=doForm.passwrd.value.replace(/./g,'*')}
function hashAdminPassword(doForm,username,cur_session_id,token){if(typeof hex_sha1==='undefined')return;doForm.admin_hash_pass.value=hex_sha1(hex_sha1(username.php_to8bit().php_strtolower()+doForm.admin_pass.value.php_to8bit())+cur_session_id+token);doForm.admin_pass.value=doForm.admin_pass.value.replace(/./g,'*')}
function hashModeratePassword(doForm,username,cur_session_id,token){if(typeof hex_sha1==='undefined')return;doForm.moderate_hash_pass.value=hex_sha1(hex_sha1(username.php_to8bit().php_strtolower()+doForm.moderate_pass.value.php_to8bit())+cur_session_id+token);doForm.moderate_pass.value=doForm.moderate_pass.value.replace(/./g,'*')}
function expandPages(spanNode,baseURL,firstPage,lastPage,perPage){var replacement='',i=0,oldLastPage=0,perPageLimit=50;if((lastPage-firstPage)/perPage>perPageLimit){oldLastPage=lastPage;lastPage=firstPage+perPageLimit*perPage};for(i=firstPage;i<lastPage;i+=perPage)replacement+='<a class="navPages" href="'+baseURL.replace(/%1\$d/,i).replace(/%%/g,'%')+'">'+(1+i/perPage)+'</a> ';if(oldLastPage>0)replacement+='<span class="expand_pages" role="menuitem" onclick="expandPages(this, \''+baseURL+'\', '+lastPage+', '+oldLastPage+', '+perPage+');"> ... </span> ';setOuterHTML(spanNode,replacement)}
function smc_preCacheImage(sSrc){if(!('smc_aCachedImages'in window))window.smc_aCachedImages=[];if(!in_array(sSrc,window.smc_aCachedImages)){var oImage=new Image();oImage.src=sSrc}}
function smc_Cookie(oOptions){this.opt=oOptions;this.oCookies={};this.init()};smc_Cookie.prototype.init=function(){if('cookie'in document&&document.cookie!==''){var aCookieList=document.cookie.split(';');for(var i=0,n=aCookieList.length;i<n;i++){var aNameValuePair=aCookieList[i].split('=');this.oCookies[aNameValuePair[0].replace(/^\s+|\s+$/g,'')]=decodeURIComponent(aNameValuePair[1])}}};smc_Cookie.prototype.get=function(sKey){return sKey in this.oCookies?this.oCookies[sKey]:null};smc_Cookie.prototype.set=function(sKey,sValue){document.cookie=sKey+'='+encodeURIComponent(sValue)}
function elk_Toggle(oOptions){this.opt=oOptions;this.bCollapsed=false;this.oCookie=null;this.init()};elk_Toggle.prototype.init=function(){var i=0,n=0;if('bToggleEnabled'in this.opt&&!this.opt.bToggleEnabled)return;if('oCookieOptions'in this.opt&&this.opt.oCookieOptions.bUseCookie){this.oCookie=new smc_Cookie({});var cookieValue=this.oCookie.get(this.opt.oCookieOptions.sCookieName);if(cookieValue!==null)this.opt.bCurrentlyCollapsed=cookieValue==='1'};if(this.opt.bCurrentlyCollapsed)this.changeState(true,true);if('aSwapImages'in this.opt){for(i=0,n=this.opt.aSwapImages.length;i<n;i++){var oImage=document.getElementById(this.opt.aSwapImages[i].sId);if(typeof oImage==='object'&&oImage!==null){if(oImage.style.display==='none')oImage.style.display='';oImage.instanceRef=this;oImage.onclick=function(){this.instanceRef.toggle();this.blur()};oImage.style.cursor='pointer';smc_preCacheImage(this.opt.aSwapImages[i].srcCollapsed)}}}else if('aSwapClasses'in this.opt)for(i=0,n=this.opt.aSwapClasses.length;i<n;i++){var oContainer=document.getElementById(this.opt.aSwapClasses[i].sId);if(typeof oContainer==='object'&&oContainer!==null){if(oContainer.style.display==='none')oContainer.style.display='';oContainer.instanceRef=this;oContainer.onclick=function(){this.instanceRef.toggle();this.blur()};oContainer.style.cursor='pointer'}};if('aSwapLinks'in this.opt)for(i=0,n=this.opt.aSwapLinks.length;i<n;i++){var oLink=document.getElementById(this.opt.aSwapLinks[i].sId);if(typeof oLink==='object'&&oLink!==null){if(oLink.style.display==='none')oLink.style.display='';oLink.instanceRef=this;oLink.onclick=function(){this.instanceRef.toggle();this.blur();return false}}}};elk_Toggle.prototype.changeState=function(bCollapse,bInit){var i=0,n=0,oContainer;bInit=typeof bInit==='undefined'?false:true;if(!bInit&&bCollapse&&'funcOnBeforeCollapse'in this.opt){this.tmpMethod=this.opt.funcOnBeforeCollapse;this.tmpMethod();delete this.tmpMethod}else if(!bInit&&!bCollapse&&'funcOnBeforeExpand'in this.opt){this.tmpMethod=this.opt.funcOnBeforeExpand;this.tmpMethod();delete this.tmpMethod};if('aSwapImages'in this.opt){for(i=0,n=this.opt.aSwapImages.length;i<n;i++){var oImage=document.getElementById(this.opt.aSwapImages[i].sId);if(typeof oImage==='object'&&oImage!==null){var sTargetSource=bCollapse?this.opt.aSwapImages[i].srcCollapsed:this.opt.aSwapImages[i].srcExpanded;if(oImage.src!=sTargetSource)oImage.src=sTargetSource;oImage.alt=oImage.title=bCollapse?this.opt.aSwapImages[i].altCollapsed:this.opt.aSwapImages[i].altExpanded}}}else if('aSwapClasses'in this.opt)for(i=0,n=this.opt.aSwapClasses.length;i<n;i++){oContainer=document.getElementById(this.opt.aSwapClasses[i].sId);if(typeof oContainer==='object'&&oContainer!==null){var sTargetClass=bCollapse?this.opt.aSwapClasses[i].classCollapsed:this.opt.aSwapClasses[i].classExpanded;if(oContainer.className!==sTargetClass)oContainer.className=sTargetClass;oContainer.title=oContainer.title=bCollapse?this.opt.aSwapClasses[i].titleCollapsed:this.opt.aSwapClasses[i].titleExpanded}};if('aSwapLinks'in this.opt)for(i=0,n=this.opt.aSwapLinks.length;i<n;i++){var oLink=document.getElementById(this.opt.aSwapLinks[i].sId);if(typeof oLink==='object'&&oLink!==null)oLink.innerHTML=bCollapse?this.opt.aSwapLinks[i].msgCollapsed:this.opt.aSwapLinks[i].msgExpanded};for(i=0,n=this.opt.aSwappableContainers.length;i<n;i++){if(this.opt.aSwappableContainers[i]===null)continue;oContainer=document.getElementById(this.opt.aSwappableContainers[i]);if(typeof oContainer==='object'&&oContainer!==null)if(bCollapse){$(oContainer).slideUp()}else $(oContainer).slideDown()};this.bCollapsed=bCollapse;if('oCookieOptions'in this.opt&&this.opt.oCookieOptions.bUseCookie)this.oCookie.set(this.opt.oCookieOptions.sCookieName,this.bCollapsed?'1':'0');if(!bInit&&'oThemeOptions'in this.opt&&this.opt.oThemeOptions.bUseThemeSettings)elk_setThemeOption(this.opt.oThemeOptions.sOptionName,this.bCollapsed?'1':'0','sThemeId'in this.opt.oThemeOptions?this.opt.oThemeOptions.sThemeId:null,elk_session_id,elk_session_var,'sAdditionalVars'in this.opt.oThemeOptions?this.opt.oThemeOptions.sAdditionalVars:null)};elk_Toggle.prototype.toggle=function(){this.changeState(!this.bCollapsed)}
function ajax_indicator(turn_on){if(ajax_indicator_ele===null){ajax_indicator_ele=document.getElementById('ajax_in_progress');if(ajax_indicator_ele===null&&typeof ajax_notification_text!==null)create_ajax_indicator_ele()};if(ajax_indicator_ele!==null)ajax_indicator_ele.style.display=turn_on?'block':'none'}
function create_ajax_indicator_ele(){ajax_indicator_ele=document.createElement('div');ajax_indicator_ele.id='ajax_in_progress';var cancel_link=document.createElement('a');cancel_link.href='javascript:ajax_indicator(false)';var cancel_img=document.createElement('img');cancel_img.src=elk_images_url+'/icons/quick_remove.png';if(typeof ajax_notification_cancel_text!=='undefined'){cancel_img.alt=ajax_notification_cancel_text;cancel_img.title=ajax_notification_cancel_text};cancel_link.appendChild(cancel_img);ajax_indicator_ele.appendChild(cancel_link);ajax_indicator_ele.innerHTML+=ajax_notification_text;document.body.appendChild(ajax_indicator_ele)}
function createEventListener(oTarget){if(!('addEventListener'in oTarget))if(oTarget.attachEvent){oTarget.addEventListener=function(sEvent,funcHandler,bCapture){oTarget.attachEvent('on'+sEvent,funcHandler)};oTarget.removeEventListener=function(sEvent,funcHandler,bCapture){oTarget.detachEvent('on'+sEvent,funcHandler)}}else{oTarget.addEventListener=function(sEvent,funcHandler,bCapture){oTarget['on'+sEvent]=funcHandler};oTarget.removeEventListener=function(sEvent,funcHandler,bCapture){oTarget['on'+sEvent]=null}}}
function grabJumpToContent(elem){var oXMLDoc=getXMLDocument(elk_prepareScriptUrl(elk_scripturl)+'action=xmlhttp;sa=jumpto;xml'),aBoardsAndCategories=[],i=0,n=0;if(oXMLDoc.responseXML){var items=oXMLDoc.responseXML.getElementsByTagName('elk')[0].getElementsByTagName('item');for(i=0,n=items.length;i<n;i++)aBoardsAndCategories[aBoardsAndCategories.length]={id:parseInt(items[i].getAttribute('id')),isCategory:items[i].getAttribute('type')==='category',name:items[i].firstChild.nodeValue.removeEntities(),is_current:false,childLevel:parseInt(items[i].getAttribute('childlevel'))}};for(i=0,n=aJumpTo.length;i<n;i++)aJumpTo[i].fillSelect(aBoardsAndCategories);elem.style.width='auto';elem.focus()};var aJumpTo=[]
function JumpTo(oJumpToOptions){this.opt=oJumpToOptions;this.dropdownList=null;this.showSelect()};JumpTo.prototype.showSelect=function(){var sChildLevelPrefix='';for(var i=this.opt.iCurBoardChildLevel;i>0;i--)sChildLevelPrefix+=this.opt.sBoardChildLevelIndicator;if(sChildLevelPrefix!='')sChildLevelPrefix=sChildLevelPrefix+this.opt.sBoardPrefix;document.getElementById(this.opt.sContainerId).innerHTML=this.opt.sJumpToTemplate.replace(/%select_id%/,this.opt.sContainerId+'_select').replace(/%dropdown_list%/,'<select '+(this.opt.bDisabled===true?'disabled="disabled" ':0)+(this.opt.sClassName!==undefined?'class="'+this.opt.sClassName+'" ':'')+'name="'+(this.opt.sCustomName!==undefined?this.opt.sCustomName:this.opt.sContainerId+'_select')+'" id="'+this.opt.sContainerId+'_select" '+('implementation'in document?'':'onmouseover="grabJumpToContent(this);" ')+('onbeforeactivate'in document?'onbeforeactivate':'onfocus')+'="grabJumpToContent(this);"><option value="'+(this.opt.bNoRedirect!==undefined&&this.opt.bNoRedirect===true?this.opt.iCurBoardId:'?board='+this.opt.iCurBoardId+'.0')+'">'+sChildLevelPrefix+this.opt.sCurBoardName.removeEntities()+'</option></select>&nbsp;'+(this.opt.sGoButtonLabel!==undefined?'<input type="button" class="button_submit" value="'+this.opt.sGoButtonLabel+'" onclick="window.location.href = \''+elk_prepareScriptUrl(elk_scripturl)+'board='+this.opt.iCurBoardId+'.0\';" />':''));this.dropdownList=document.getElementById(this.opt.sContainerId+'_select')};JumpTo.prototype.fillSelect=function(aBoardsAndCategories){if('onbeforeactivate'in document){this.dropdownList.onbeforeactivate=null}else this.dropdownList.onfocus=null;if(this.opt.bNoRedirect)this.dropdownList.options[0].disabled='disabled';var oListFragment=document.createDocumentFragment(),oOptgroupFragment=document.createElement('optgroup');for(var i=0,n=aBoardsAndCategories.length;i<n;i++){var j,sChildLevelPrefix='',oOption,oText;if(!aBoardsAndCategories[i].isCategory&&aBoardsAndCategories[i].id===this.opt.iCurBoardId){this.dropdownList.insertBefore(oOptgroupFragment,this.dropdownList.options[0]);continue};if(aBoardsAndCategories[i].isCategory){oOptgroupFragment=document.createElement('optgroup');oOptgroupFragment.label=aBoardsAndCategories[i].name;oListFragment.appendChild(oOptgroupFragment);continue}else{for(j=aBoardsAndCategories[i].childLevel,sChildLevelPrefix='';j>0;j--)sChildLevelPrefix+=this.opt.sBoardChildLevelIndicator;if(sChildLevelPrefix!='')sChildLevelPrefix=sChildLevelPrefix+this.opt.sBoardPrefix};oOption=document.createElement('option');oText=document.createElement('span');oText.innerHTML=(aBoardsAndCategories[i].isCategory?this.opt.sCatPrefix:sChildLevelPrefix)+aBoardsAndCategories[i].name;if(aBoardsAndCategories[i].isCategory&&this.opt.sCatClass)oOption.className=this.opt.sCatClass;oOption.appendChild(oText);if(!this.opt.bNoRedirect){oOption.value=aBoardsAndCategories[i].isCategory?'#c'+aBoardsAndCategories[i].id:'?board='+aBoardsAndCategories[i].id+'.0'}else if(aBoardsAndCategories[i].isCategory){oOption.disabled='disabled'}else oOption.value=aBoardsAndCategories[i].id;oOptgroupFragment.appendChild(oOption)};this.dropdownList.appendChild(oListFragment);if(!this.opt.bNoRedirect)this.dropdownList.onchange=function(){if(this.selectedIndex>0&&this.options[this.selectedIndex].value)window.location.href=elk_scripturl+this.options[this.selectedIndex].value.substr(elk_scripturl.indexOf('?')===-1||this.options[this.selectedIndex].value.substr(0,1)!=='?'?0:1)}};var aIconLists=[]
function IconList(oOptions){this.opt=oOptions;this.bListLoaded=false;this.oContainerDiv=null;this.funcMousedownHandler=null;this.funcParent=this;this.iCurMessageId=0;this.iCurTimeout=0;if(!('sSessionVar'in this.opt))this.opt.sSessionVar='sesc';if(!('sAction'in this.opt)||this.opt.sAction===null)this.opt.sAction='messageicons;board='+this.opt.iBoardId;this.initIcons()};IconList.prototype.initIcons=function(){for(var i=document.images.length-1,iPrefixLength=this.opt.sIconIdPrefix.length;i>=0;i--)if(document.images[i].id.substr(0,iPrefixLength)===this.opt.sIconIdPrefix)setOuterHTML(document.images[i],'<div title="'+this.opt.sLabelIconList+'" onclick="'+this.opt.sBackReference+'.openPopup(this, '+document.images[i].id.substr(iPrefixLength)+')" onmouseover="'+this.opt.sBackReference+'.onBoxHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onBoxHover(this, false)" style="background: '+this.opt.sBoxBackground+'; cursor: pointer; padding: 0 2px; margin: 0 auto; vertical-align: top"><img src="'+document.images[i].src+'" alt="'+document.images[i].alt+'" id="'+document.images[i].id+'" style="vertical-align: top; margin: 0 auto; padding: '+(is_ie?'0 2px':'0 2px')+';" /></div>')};IconList.prototype.onBoxHover=function(oDiv,bMouseOver){oDiv.style.border=bMouseOver?this.opt.iBoxBorderWidthHover+'px solid '+this.opt.sBoxBorderColorHover:'';oDiv.style.background=bMouseOver?this.opt.sBoxBackgroundHover:this.opt.sBoxBackground;oDiv.style.padding=bMouseOver?(2-this.opt.iBoxBorderWidthHover)+'px':'2px'};IconList.prototype.openPopup=function(oDiv,iMessageId){this.iCurMessageId=iMessageId;if(!this.bListLoaded&&this.oContainerDiv===null){this.oContainerDiv=document.createElement('div');this.oContainerDiv.id='iconList';this.oContainerDiv.style.display='none';this.oContainerDiv.style.cursor='pointer';this.oContainerDiv.style.position='absolute';this.oContainerDiv.style.background=this.opt.sContainerBackground;this.oContainerDiv.style.border=this.opt.sContainerBorder;this.oContainerDiv.style.padding='6px 0px';document.body.appendChild(this.oContainerDiv);ajax_indicator(true);sendXMLDocument.call(this,elk_prepareScriptUrl(elk_scripturl)+'action=xmlhttp;sa='+this.opt.sAction+';xml','',this.onIconsReceived);createEventListener(document.body)};var aPos=elk_itemPos(oDiv);this.oContainerDiv.style.top=(aPos[1]+oDiv.offsetHeight)+'px';this.oContainerDiv.style.left=(aPos[0]-1)+'px';this.oClickedIcon=oDiv;if(this.bListLoaded)this.oContainerDiv.style.display='block';document.body.addEventListener('mousedown',this.onWindowMouseDown,false)};IconList.prototype.onIconsReceived=function(oXMLDoc){var icons=oXMLDoc.getElementsByTagName('elk')[0].getElementsByTagName('icon'),sItems='';for(var i=0,n=icons.length;i<n;i++)sItems+='<span onmouseover="'+this.opt.sBackReference+'.onItemHover(this, true)" onmouseout="'+this.opt.sBackReference+'.onItemHover(this, false);" onmousedown="'+this.opt.sBackReference+'.onItemMouseDown(this, \''+icons[i].getAttribute('value')+'\');" style="padding: 2px 3px; line-height: 20px; border: '+this.opt.sItemBorder+'; background: '+this.opt.sItemBackground+'"><img src="'+icons[i].getAttribute('url')+'" alt="'+icons[i].getAttribute('name')+'" title="'+icons[i].firstChild.nodeValue+'" style="vertical-align: middle" /></span>';this.oContainerDiv.innerHTML=sItems;this.oContainerDiv.style.display='block';this.bListLoaded=true;if(is_ie)this.oContainerDiv.style.width=this.oContainerDiv.clientWidth+'px';ajax_indicator(false)};IconList.prototype.onItemHover=function(oDiv,bMouseOver){oDiv.style.background=bMouseOver?this.opt.sItemBackgroundHover:this.opt.sItemBackground;oDiv.style.border=bMouseOver?this.opt.sItemBorderHover:this.opt.sItemBorder;if(this.iCurTimeout!==0)window.clearTimeout(this.iCurTimeout);if(bMouseOver){this.onBoxHover(this.oClickedIcon,true)}else this.iCurTimeout=window.setTimeout(this.opt.sBackReference+'.collapseList();',500)};IconList.prototype.onItemMouseDown=function(oDiv,sNewIcon){if(this.iCurMessageId!==0){ajax_indicator(true);this.tmpMethod=getXMLDocument;var oXMLDoc=this.tmpMethod(elk_prepareScriptUrl(elk_scripturl)+'action=jsmodify;topic='+this.opt.iTopicId+';msg='+this.iCurMessageId+';'+elk_session_var+'='+elk_session_id+';icon='+sNewIcon+';xml');delete this.tmpMethod;ajax_indicator(false);var oMessage=oXMLDoc.responseXML.getElementsByTagName('elk')[0].getElementsByTagName('message')[0];if(oMessage.getElementsByTagName('error').length===0){if((this.opt.bShowModify&&oMessage.getElementsByTagName('modified').length!==0)&&(document.getElementById('modified_'+this.iCurMessageId)!==null))document.getElementById('modified_'+this.iCurMessageId).innerHTML=oMessage.getElementsByTagName('modified')[0].childNodes[0].nodeValue;this.oClickedIcon.getElementsByTagName('img')[0].src=oDiv.getElementsByTagName('img')[0].src}}else{this.oClickedIcon.getElementsByTagName('img')[0].src=oDiv.getElementsByTagName('img')[0].src;if('sLabelIconBox'in this.opt)document.getElementById(this.opt.sLabelIconBox).value=sNewIcon}};IconList.prototype.onWindowMouseDown=function(){for(var i=aIconLists.length-1;i>=0;i--){aIconLists[i].funcParent.tmpMethod=aIconLists[i].collapseList;aIconLists[i].funcParent.tmpMethod();delete aIconLists[i].funcParent.tmpMethod}};IconList.prototype.collapseList=function(){this.onBoxHover(this.oClickedIcon,false);this.oContainerDiv.style.display='none';this.iCurMessageId=0;document.body.removeEventListener('mousedown',this.onWindowMouseDown,false)}
function elk_itemPos(itemHandle){var itemX=0,itemY=0;if('offsetParent'in itemHandle){itemX=itemHandle.offsetLeft;itemY=itemHandle.offsetTop;while(itemHandle.offsetParent&&typeof(itemHandle.offsetParent)==='object'){itemHandle=itemHandle.offsetParent;itemX+=itemHandle.offsetLeft;itemY+=itemHandle.offsetTop}}else if('x'in itemHandle){itemX=itemHandle.x;itemY=itemHandle.y};return[itemX,itemY]}
function elk_prepareScriptUrl(sUrl){return sUrl.indexOf('?')===-1?sUrl+'?':sUrl+(sUrl.charAt(sUrl.length-1)==='?'||sUrl.charAt(sUrl.length-1)==='&'||sUrl.charAt(sUrl.length-1)===';'?'':';')};var aOnloadEvents=[]
function addLoadEvent(fNewOnload){if(typeof fNewOnload==='function'&&(!('onload'in window)||typeof(window.onload)!=='function')){window.onload=fNewOnload}else if(aOnloadEvents.length===0){aOnloadEvents[0]=window.onload;aOnloadEvents[1]=fNewOnload;window.onload=function(){for(var i=0,n=aOnloadEvents.length;i<n;i++)if(typeof(aOnloadEvents[i])==='function'){aOnloadEvents[i]()}else if(typeof(aOnloadEvents[i])==='string')eval(aOnloadEvents[i])}}else aOnloadEvents[aOnloadEvents.length]=fNewOnload}
function elkSelectText(oCurElement,bActOnElement){var oCodeArea=null;if(typeof bActOnElement==='boolean'&&bActOnElement){oCodeArea=document.getElementById(oCurElement)}else oCodeArea=oCurElement.parentNode.nextSibling;if(typeof oCodeArea!=='object'||oCodeArea===null)return false;if('createTextRange'in document.body){var oCurRange=document.body.createTextRange();oCurRange.moveToElementText(oCodeArea);oCurRange.select()}else if(window.getSelection){var oCurSelection=window.getSelection();if(oCurSelection.setBaseAndExtent){var oLastChild=oCodeArea.lastChild;oCurSelection.setBaseAndExtent(oCodeArea,0,oLastChild,'innerText'in oLastChild?oLastChild.innerText.length:oLastChild.textContent.length)}else{var curRange=document.createRange();curRange.selectNodeContents(oCodeArea);oCurSelection.removeAllRanges();oCurSelection.addRange(curRange)}};return false}
function smc_saveEntities(sFormName,aElementNames,sMask){var i=0,n=0;if(typeof sMask==='string')for(i=0,n=document.forms[sFormName].elements.length;i<n;i++)if(document.forms[sFormName].elements[i].id.substr(0,sMask.length)==sMask)aElementNames[aElementNames.length]=document.forms[sFormName].elements[i].name;for(i=0,n=aElementNames.length;i<n;i++)if(aElementNames[i]in document.forms[sFormName])document.forms[sFormName][aElementNames[i]].value=document.forms[sFormName][aElementNames[i]].value.replace(/&#/g,'&#38;#')}
function applyWindowClasses(oList){var bAlternate=false;oListItems=oList.getElementsByTagName("li");for(i=0;i<oListItems.length;i++){if(oListItems[i].id==="")continue;oListItems[i].className="windowbg"+(bAlternate?"2":"");bAlternate=!bAlternate}}
function pollOptions(){var expire_time=document.getElementById('poll_expire');if(isEmptyText(expire_time)||expire_time.value===0){document.forms[form_name].poll_hide[2].disabled=true;if(document.forms[form_name].poll_hide[2].checked)document.forms[form_name].poll_hide[1].checked=true}else document.forms[form_name].poll_hide[2].disabled=false}
function generateDays(offset){offset=typeof offset!=='undefined'?offset:'';var days=0,selected=0,dayElement=document.getElementById("day"+offset),yearElement=document.getElementById("year"+offset),monthElement=document.getElementById("month"+offset),monthLength=[31,28,31,30,31,30,31,31,30,31,30,31];monthLength[1]=28;if(yearElement.options[yearElement.selectedIndex].value%4===0)monthLength[1]=29;selected=dayElement.selectedIndex;while(dayElement.options.length)dayElement.options[0]=null;days=monthLength[monthElement.value-1];for(i=1;i<=days;i++)dayElement.options[dayElement.length]=new Option(i,i);if(selected<days)dayElement.selectedIndex=selected}
function toggleLinked(form){form.board.disabled=!form.link_to_board.checked}
function initSearch(){if(document.forms.searchform.search.value.indexOf("%u")!==-1)document.forms.searchform.search.value=decodeURI(document.forms.searchform.search.value)}
function selectBoards(ids,aFormID){var toggle=true,aForm=document.getElementById(aFormID);for(i=0;i<ids.length;i++)toggle=toggle&&aForm["brd"+ids[i]].checked;for(i=0;i<ids.length;i++)aForm["brd"+ids[i]].checked=!toggle}
function expandCollapse(id,icon,speed){var oId=$('#'+id);icon=icon||false;speed=speed||300;if(icon)$('#'+icon).attr("src",elk_images_url+(oId.is(":hidden")!==true?"/selected.png":"/selected_open.png"));oId.slideToggle(speed)}
function updateRuleDef(optNum){if(document.getElementById("ruletype"+optNum).value==="gid"){document.getElementById("defdiv"+optNum).style.display="none";document.getElementById("defseldiv"+optNum).style.display=""}else if(document.getElementById("ruletype"+optNum).value==="bud"||document.getElementById("ruletype"+optNum).value===""){document.getElementById("defdiv"+optNum).style.display="none";document.getElementById("defseldiv"+optNum).style.display="none"}else{document.getElementById("defdiv"+optNum).style.display="";document.getElementById("defseldiv"+optNum).style.display="none"}}
function highlightSelected(box){if(prevClass!=="")prevDiv.className=prevClass;prevDiv=document.getElementById(box);prevClass=prevDiv.className;prevDiv.className="highlight2"}
function doAutoSubmit(){var formID=typeof formName!=='undefined'?formName:"autoSubmit";if(countdown===0){document.forms[formID].submit()}else if(countdown===-1)return;document.forms[formID].cont.value=txt_message+' ('+countdown+')';countdown--;setTimeout("doAutoSubmit();",1e3)}
function elk_codefix(){$('.bbc_code').each(function(){$(this).height("auto");if($(this).height()>200)$(this).css('height','20em')})}
function toggleButtonAJAX(btn,confirmation_msg_variable){$.ajax({type:'GET',url:btn.href+';xml;api',context:document.body,beforeSend:ajax_indicator(true)}).done(function(request){if(request==='')return;var oElement=$(request).find('elk')[0];if(oElement.getElementsByTagName('error').length===0){var text=oElement.getElementsByTagName('text'),url=oElement.getElementsByTagName('url'),confirm_elem=oElement.getElementsByTagName('confirm');if(confirm_elem.length===1)var confirm_text=confirm_elem[0].firstChild.nodeValue.removeEntities();$('.'+btn.className.replace(/(list|link)level\d/g,'').trim()).each(function(){if(text.length===1)$(this).html('<span>'+text[0].firstChild.nodeValue.removeEntities()+'</span>');if(url.length===1)$(this).attr('href',url[0].firstChild.nodeValue.removeEntities());if(typeof confirm_text!=='undefined')eval(confirmation_msg_variable+'= \''+confirm_text.replace(/[\\']/g,'\\$&')+'\'')})}else{if(oElement.getElementsByTagName('text').length!==0)alert(oElement.getElementsByTagName('text')[0].firstChild.nodeValue.removeEntities());if(oElement.getElementsByTagName('url').length!==0)window.location.href=oElement.getElementsByTagName('url')[0].firstChild.nodeValue}}).fail(function(){}).always(function(){ajax_indicator(false)});return false}
function toggleHeaderAJAX(btn,container_id){ajax_indicator(true);var text_template='<h3 class="category_header centertext">{text}</h3>';$.ajax({type:'GET',url:btn.href+';xml;api',context:document.body,beforeSend:ajax_indicator(true)}).done(function(request){var oElement=$(request).find('elk')[0];if(oElement.getElementsByTagName('error').length===0){var text=oElement.getElementsByTagName('text')[0].firstChild.nodeValue.removeEntities();$('#'+container_id+' .pagesection').remove();$('#'+container_id+' .category_header').remove();$('#'+container_id+' .topic_listing').remove();$(text_template.replace('{text}',text)).insertBefore('#topic_icons')}}).fail(function(){}).always(function(){ajax_indicator(false)})}
function notifyButton(btn){if(typeof notification_topic_notice!=='undefined'&&!confirm(notification_topic_notice))return false;return toggleButtonAJAX(btn,'notification_topic_notice')}
function notifyboardButton(btn){if(typeof notification_board_notice!=='undefined'&&!confirm(notification_board_notice))return false;toggleButtonAJAX(btn,'notification_board_notice');return false}
function unwatchButton(btn){toggleButtonAJAX(btn);return false}
function markboardreadButton(btn){toggleButtonAJAX(btn);$('.new_posts').remove();return false}
function markallreadButton(btn){toggleButtonAJAX(btn);$('.new_posts').remove();$('.board_icon').each(function(){$(this).removeClass('on_board on2_board').addClass('off_board')});$('.board_new_posts').removeClass('board_new_posts');return false}
function markunreadButton(btn){toggleHeaderAJAX(btn,'main_content_section');return false};var relative_time_refresh=0
function updateRelativeTime(){relative_time_refresh=36e5;$('time').each(function(){var oRelativeTime=new relativeTime($(this).data('timestamp')),time_text='';if(oRelativeTime.seconds()){$(this).text(oRttime.now);relative_time_refresh=Math.min(relative_time_refresh,1e4)}else if(oRelativeTime.minutes()){time_text=oRelativeTime.deltaTime>1?oRttime.minutes:oRttime.minute;$(this).text(time_text.replace('%s',oRelativeTime.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,6e4)}else if(oRelativeTime.hours()){time_text=oRelativeTime.deltaTime>1?oRttime.hours:oRttime.hour;$(this).text(time_text.replace('%s',oRelativeTime.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,36e5)}else if(oRelativeTime.days()){time_text=oRelativeTime.deltaTime>1?oRttime.days:oRttime.day;$(this).text(time_text.replace('%s',oRelativeTime.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,36e5)}else if(oRelativeTime.weeks()){time_text=oRelativeTime.deltaTime>1?oRttime.weeks:oRttime.week;$(this).text(time_text.replace('%s',oRelativeTime.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,36e5)}else if(oRelativeTime.months()){time_text=oRelativeTime.deltaTime>1?oRttime.months:oRttime.month;$(this).text(time_text.replace('%s',oRelativeTime.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,36e5)}else if(oRelativeTime.years()){time_text=oRelativeTime.deltaTime>1?oRttime.years:oRttime.year;$(this).text(time_text.replace('%s',oRelativeTime.deltaTime));relative_time_refresh=Math.min(relative_time_refresh,36e5)}});setTimeout('updateRelativeTime()',relative_time_refresh)}
function relativeTime(sFrom,sTo){if(typeof sTo==='undefined'){if(typeof oRttime.currentTime==='undefined'){this.dateTo=new Date()}else this.dateTo=new Date(oRttime.currentTime*1e3)}else if(parseInt(sTo)=='NaN'){sToSplit=sTo.split(/\D/);this.dateTo=new Date(sToSplit[0],--sToSplit[1],sToSplit[2],sToSplit[3],sToSplit[4])}else this.dateTo=new Date(sTo*1e3);if(parseInt(sFrom)=='NaN'){sFromSplit=sFrom.split(/\D/);this.dateFrom=new Date(sFromSplit[0],--sFromSplit[1],sFromSplit[2],sFromSplit[3],sFromSplit[4])}else this.dateFrom=new Date(sFrom*1e3);this.time_text='';this.past_time=(this.dateTo-this.dateFrom)/1e3;this.deltaTime=0};relativeTime.prototype.seconds=function(){if(this.past_time<60){this.deltaTime=this.past_time;return true};return false};relativeTime.prototype.minutes=function(){if(this.past_time>=60&&Math.round(this.past_time/60)<60){this.deltaTime=Math.round(this.past_time/60);return true};return false};relativeTime.prototype.hours=function(){if(Math.round(this.past_time/60)>=60&&Math.round(this.past_time/3600)<24){this.deltaTime=Math.round(this.past_time/3600);return true};return false};relativeTime.prototype.days=function(){if(Math.round(this.past_time/3600)>=24&&Math.round(this.past_time/(24*3600))<7){this.deltaTime=Math.round(this.past_time/(24*3600));return true};return false};relativeTime.prototype.weeks=function(){if(Math.round(this.past_time/(24*3600))>=7&&Math.round(this.past_time/(24*3600))<30){this.deltaTime=Math.round(this.past_time/(24*3600)/7);return true};return false};relativeTime.prototype.months=function(){if(Math.round(this.past_time/(24*3600))>=30&&Math.round(this.past_time/(30*24*3600))<12){this.deltaTime=Math.round(this.past_time/(30*24*3600));return true};return false};relativeTime.prototype.years=function(){if(Math.round(this.past_time/(30*24*3600))>=12){this.deltaTime=this.dateTo.getFullYear()-this.dateFrom.getFullYear();return true};return false}
function revalidateMentions(sForm,sInput){var cached_names,cached_queries,body,mentions,pos=-1,boundaries_pattern=/[ \.,;!\?'-\\\/="]/i;for(var i=0,count=all_elk_mentions.length;i<count;i++)if(all_elk_mentions[i].selector===sInput||all_elk_mentions[i].selector==='#'+sInput){if(all_elk_mentions[i].oOptions.isPlugin){var $editor=$('#'+all_elk_mentions[i].selector).data("sceditor");cached_names=$editor.opts.mentionOptions.cache.names;cached_queries=$editor.opts.mentionOptions.cache.queries;body=$editor.getText().replace(/[\u00a0\r\n]/g,' ');mentions=$($editor.opts.mentionOptions.cache.mentions)}else{cached_names=all_elk_mentions[i].oMention.cached_names;cached_queries=all_elk_mentions[i].oMention.cached_queries;body=document.forms[sForm][sInput].value.replace(/[\u00a0\r\n]/g,' ');mentions=$(all_elk_mentions[i].oMention.mentions)};body=' '+body+' ';$(mentions).find('input').each(function(idx,elem){var name=$(elem).data('name'),next_char,prev_char,index=body.indexOf(name);if(typeof name!=='undefined')if(index===-1){$(elem).remove()}else{next_char=body.charAt(index+name.length);prev_char=body.charAt(index-1);if(next_char!==''&&next_char.search(boundaries_pattern)!==0){$(elem).remove()}else if(prev_char!==''&&prev_char.search(boundaries_pattern)!==0)$(elem).remove()}});for(var k=0,ccount=cached_queries.length;k<ccount;k++){names=cached_names[cached_queries[k]];for(var l=0,ncount=names.length;l<ncount;l++){pos=body.indexOf(' @'+names[l].name);if(pos!==-1&&body.charAt(pos+2+names[l].name.length+1).search(boundaries_pattern)===0)mentions.append($('<input type="hidden" name="uid[]" />').val(names[l].id))}}}};var all_elk_mentions=[]
function add_elk_mention(selector,oOptions){if(all_elk_mentions.hasOwnProperty(selector))return;if(typeof oOptions==='undefined')oOptions={};oOptions.selector=selector;all_elk_mentions[all_elk_mentions.length]={selector:selector,oOptions:oOptions}};(function($){'use strict';$.fn.elkSortable=function(oInstanceSettings){$.fn.elkSortable.oDefaultsSettings={opacity:0.7,cursor:'move',axis:'y',scroll:true,containment:'parent',delay:150,href:'',tolerance:'intersect',setorder:'serialize',placeholder:'',preprocess:'',tag:'#table_grid_sortable',connect:'',sa:'',title:'',error:'',token:''};var oSettings=$.extend({},$.fn.elkSortable.oDefaultsSettings,oInstanceSettings||{}),ajax_infobar=document.createElement('div'),ajax_errorbox=document.createElement('div');$(ajax_infobar).css({position:'fixed',top:'0',left:'0',width:'100%'});$("body").append(ajax_infobar);$(ajax_infobar).slideUp();$(ajax_errorbox).css({display:'none'});$("body").append(ajax_errorbox).attr('id','errorContainer');$(oSettings.tag).sortable({opacity:oSettings.opacity,cursor:oSettings.cursor,axis:oSettings.axis,containment:oSettings.containment,connectWith:oSettings.connect,placeholder:oSettings.placeholder,tolerance:oSettings.tolerance,delay:oSettings.delay,scroll:oSettings.scroll,helper:function(e,ui){var $originals=ui.children(),$helper=ui.clone(),$clone;$helper.children().each(function(){$(this).replaceWith(function(){return $("<span />",{html:$(this).html()})})});$helper.children().each(function(index){return $(this).width($originals.eq(index).width()).css('display','inline-block')});$('body').append('<div id="clone" class="'+oSettings.placeholder+'">'+$helper.html()+'</div>');$clone=$('#clone');$clone.hide();setTimeout(function(){$clone.appendTo(ui.parent());$clone.show()},1);return $clone},update:function(e,ui){var postdata='',moved=ui.item.attr('id'),order=[],receiver=ui.item.parent().attr('id');if(oSettings.preprocess!=='')window[oSettings.preprocess]();if(oSettings.setorder==='inorder'){$(oSettings.tag).find('li').each(function(){var aid=$(this).attr('id').split('_');order.push({name:aid[0]+'[]',value:aid[1]})});postdata=$.param(order)}else $(oSettings.tag).each(function(){if(postdata===""){postdata+=$(this).sortable(oSettings.setorder)}else postdata+="&"+$(this).sortable(oSettings.setorder)});postdata+='&'+elk_session_var+'='+elk_session_id;postdata+='&order=reorder';postdata+='&moved='+moved;postdata+='&received='+receiver;if(oSettings.token!=='')postdata+='&'+oSettings.token['token_var']+'='+oSettings.token['token_id'];$.ajax({type:"POST",url:elk_scripturl+"?action=xmlhttp;sa="+oSettings.sa+";xml",dataType:"xml",data:postdata}).fail(function(jqXHR,textStatus,errorThrown){$(ajax_infobar).attr('class','errorbox');$(ajax_infobar).html(textStatus).slideDown('fast');setTimeout(function(){$(ajax_infobar).slideUp()},3500);if(oSettings.href!=='')setTimeout(function(){window.location.href=elk_scripturl+oSettings.href},1e3)}).done(function(data,textStatus,jqXHR){if($(data).find("error").length!==0){$('#errorContainer').append('<p id="errorContent"></p>');$('#errorContent').html($(data).find("error").text());$('#errorContent').dialog({autoOpen:true,title:oSettings.title,modal:true,close:function(event,ui){if(oSettings.href!=='')window.location.href=elk_scripturl+oSettings.href}})}else if($(data).find("elk").length!==0){$(ajax_infobar).attr('class','infobox');$(ajax_infobar).html($(data).find('elk > orders > order').text()).slideDown('fast');setTimeout(function(){$(ajax_infobar).slideUp()},3500)}else{$('#errorContainer').append('<p id="errorContent"></p>');$('#errorContent').html(oSettings.error+' : '+textStatus);$('#errorContent').dialog({autoOpen:true,title:oSettings.title,modal:true})}}).always(function(data,textStatus,jqXHR){if(textStatus==='success'&&$(data).find("elk > tokens > token").length!==0){oSettings.token['token_id']=$(data).find("tokens").find('[type="token"]').text();oSettings.token['token_var']=$(data).find("tokens").find('[type="token_var"]').text()}})}})}})(jQuery)
function setBoardIds(){$("[id^=category_]").each(function(){var cat=$(this).attr('id').split('category_'),uls=$(this).find("ul");if(uls.length===1){if($(uls).find("li").length===0){$(uls).append('<li id="cbp_'+cat+',-1,-1"></li>')}else $(uls).find("li:not(:has(ul))").append('<ul class="nolist"></ul>')}else $(uls).find("li:not(:has(ul))").append('<ul class="nolist"></ul>');$(this).find('ul:parent').each(function(i,ul){var parentList=$(this).parent('li').attr('id'),pli=0;if(typeof parentList!=="undefined"){pli=parentList.split(",");pli=pli[1]};$(this).find('li').each(function(i,el){var currentList=$(el).attr('id'),myid=currentList.split(",");$(el).removeAttr("id");myid="cbp_"+cat[1]+","+myid[1]+","+pli;$(el).attr('id',myid)})})})};(function($){$.fn.expand_pages=function(){var $container,lastPositions=new Array()
function hover_expand($element){var $expanded_pages_li=$element,baseurl=eval($element.data('baseurl')),perpage=$element.data('perpage'),firstpage=$element.data('firstpage'),lastpage=$element.data('lastpage'),$exp_pages=$('<li id="expanded_pages" />'),pages=0,container_width=$element.outerWidth()*2,width_elements=3,$scroll_left=null,$scroll_right=null,aModel=$element.closest('.linavPages').prev().find('a').clone();if(typeof(lastPositions[firstpage])==='undefined')lastPositions[firstpage]=0;$container=$('<ul id="expanded_pages_container">');for(var i=firstpage;i<lastpage;i+=perpage){pages++;var bElem=aModel.clone();bElem.attr('href',baseurl.replace('%1$d',i)).text(i/perpage+1);$exp_pages.append(bElem)};if(pages>width_elements)$container.append($('<li />').append(aModel.clone().attr('id','pages_scroll_left').attr('href','#').text('<').click(function(ev){ev.stopPropagation();ev.preventDefault()}).hover(function(){$exp_pages.animate({'margin-left':0},200*pages)},function(){$exp_pages.stop();lastPositions[firstpage]=$exp_pages.css('margin-left')})));$container.append($exp_pages);$element.parent().superfish({delay:300,speed:175,speedOut:50,onHide:function(){$container.remove()}});$element.append($container);if(pages>width_elements)$container.append($('<li />').append(aModel.clone().attr('id','pages_scroll_right').attr('href','#').text('>').click(function(ev){ev.stopPropagation();ev.preventDefault()}).hover(function(){var $pages=$exp_pages.find('a'),move=0;for(var i=0,count=$exp_pages.find('a').length;i<count;i++)move+=$($pages[i]).outerWidth();move=(move+$container.find('#pages_scroll_left').outerWidth())-($container.outerWidth()-$container.find('#pages_scroll_right').outerWidth());$exp_pages.animate({'margin-left':-move},200*pages)},function(){$exp_pages.stop();lastPositions[firstpage]=$exp_pages.css('margin-left')})));$exp_pages.find('a').each(function(){if(width_elements>-1)container_width+=$element.outerWidth();if(width_elements<=0||pages>=width_elements)$container.css({'margin-left':-container_width/2}).width(container_width);if(width_elements<0)return false;width_elements--}).click(function(ev){$expanded_pages_li.attr('onclick','').off('click')});$exp_pages.css({height:$element.outerHeight(),'padding-left':$container.find('#pages_scroll_left').outerWidth(),'margin-left':lastPositions[firstpage]})}
function expand_pages($element){var $baseAppend=$($element.closest('.linavPages')),boxModel=$baseAppend.prev().clone(),aModel=boxModel.find('a').clone(),expandModel=$element.clone(),perPage=$element.data('perpage'),firstPage=$element.data('firstpage'),lastPage=$element.data('lastpage'),rawBaseurl=$element.data('baseurl'),baseurl=eval($element.data('baseurl')),first,i=0,oldLastPage=0,perPageLimit=10;if((lastPage-firstPage)/perPage>perPageLimit){oldLastPage=lastPage;lastPage=firstPage+perPageLimit*perPage};for(i=lastPage;i>firstPage;i-=perPage){var bElem=aModel.clone(),boxModelClone=boxModel.clone();bElem.attr('href',baseurl.replace('%1$d',i-perPage)).text(i/perPage);boxModelClone.find('a').each(function(){$(this).replaceWith(bElem[0])});$baseAppend.after(boxModelClone);if(typeof first==='undefined')first=boxModelClone};$baseAppend.remove();if(oldLastPage>0){expandModel.find('#expanded_pages_container').each(function(){$(this).remove()});expandModel.click(function(e){var $zhis=$(this);e.preventDefault();expand_pages($zhis);$zhis.off('mouseenter focus')}).on('mouseenter focus',function(){hover_expand($(this))}).data('perpage',perPage).data('firstpage',lastPage).data('lastpage',oldLastPage).data('baseurl',rawBaseurl);first.after(expandModel)}};this.attr('tabindex',0).click(function(e){var $zhis=$(this);e.preventDefault();expand_pages($zhis);$zhis.off('mouseenter focus')}).on('mouseenter focus',function(){hover_expand($(this))})}})(jQuery);(function($){'use strict';$.fn.SiteTooltip=function(oInstanceSettings){$.fn.SiteTooltip.oDefaultsSettings={followMouse:1,hoverIntent:{sensitivity:10,interval:750,timeout:50},positionTop:12,positionLeft:12,tooltipID:'site_tooltip',tooltipTextID:'site_tooltipText',tooltipClass:'tooltip',tooltipSwapClass:'site_swaptip',tooltipContent:'html'};var oSettings=$.extend({},$.fn.SiteTooltip.oDefaultsSettings,oInstanceSettings||{});$(this).each(function(){var sTitle=$('<span class="'+oSettings.tooltipSwapClass+'">'+htmlspecialchars(this.title)+'</span>').hide();$(this).append(sTitle).attr('title','')});var positionTooltip=function(event){var iPosx=0,iPosy=0;if(!event)event=window.event;if(event.pageX||event.pageY){iPosx=event.pageX;iPosy=event.pageY}else if(event.clientX||event.clientY){iPosx=event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;iPosy=event.clientY+document.body.scrollTop+document.documentElement.scrollTop};var oPosition={x:iPosx+oSettings.positionLeft,y:iPosy+oSettings.positionTop,w:$('#'+oSettings.tooltipID).width(),h:$('#'+oSettings.tooltipID).height()},oLimits={x:$(window).scrollLeft(),y:$(window).scrollTop(),w:$(window).width()-24,h:$(window).height()-24};if((oPosition.y+oPosition.h>oLimits.y+oLimits.h)&&(oPosition.x+oPosition.w>oLimits.x+oLimits.w)){oPosition.x=(oPosition.x-oPosition.w)-45;oPosition.y=(oPosition.y-oPosition.h)-45}else if((oPosition.x+oPosition.w)>(oLimits.x+oLimits.w)){oPosition.x=oPosition.x-(((oPosition.x+oPosition.w)-(oLimits.x+oLimits.w))+24)}else if(oPosition.y+oPosition.h>oLimits.y+oLimits.h)oPosition.y=oPosition.y-(((oPosition.y+oPosition.h)-(oLimits.y+oLimits.h))+24);$('#'+oSettings.tooltipID).css({left:oPosition.x+'px',top:oPosition.y+'px'})},showTooltip=function(){$('#'+oSettings.tooltipID+' #'+oSettings.tooltipTextID).show()},hideTooltip=function(){$('#'+oSettings.tooltipID).fadeOut('slow').trigger("unload").remove()}
function htmlspecialchars(string){return $('<span>').text(string).html()};return this.each(function(){if($.fn.hoverIntent){$(this).hoverIntent({sensitivity:oSettings.hoverIntent.sensitivity,interval:oSettings.hoverIntent.interval,over:site_tooltip_on,timeout:oSettings.hoverIntent.timeout,out:site_tooltip_off})}else $(this).hover(site_tooltip_on,site_tooltip_off)
function site_tooltip_on(event){if($(this).children('.'+oSettings.tooltipSwapClass).text()){$('body').append('<div id="'+oSettings.tooltipID+'" class="'+oSettings.tooltipClass+'"><div id="'+oSettings.tooltipTextID+'" style="display:none;"></div></div>');var tt=$('#'+oSettings.tooltipID),ttContent=$('#'+oSettings.tooltipID+' #'+oSettings.tooltipTextID);if(oSettings.tooltipContent==='html'){ttContent.html($(this).children('.'+oSettings.tooltipSwapClass).html())}else ttContent.text($(this).children('.'+oSettings.tooltipSwapClass).text());tt.show();showTooltip();positionTooltip(event)};return false}
function site_tooltip_off(event){hideTooltip(this);return false};if(oSettings.followMouse)$(this).on("mousemove",function(event){positionTooltip(event);return false});$(this).on("click",function(){hideTooltip(this);return true})})}})(jQuery);var error_txts={}
function errorbox_handler(oOptions){this.opt=oOptions;this.oError_box=null;this.oErrorHandle=window;this.evaluate=false;this.init()};errorbox_handler.prototype.init=function(){if(this.opt.check_id!==undefined){this.oChecks_on=$(document.getElementById(this.opt.check_id))}else if(this.opt.selector!==undefined){this.oChecks_on=this.opt.selector}else if(this.opt.editor!==undefined){this.oChecks_on=eval(this.opt.editor);this.evaluate=true};this.oErrorHandle.instanceRef=this;if(this.oError_box===null)this.oError_box=$(document.getElementById(this.opt.error_box_id));if(this.evaluate===false){this.oChecks_on.attr('onblur',this.opt.self+'.checkErrors()');this.oChecks_on.attr('onkeyup',this.opt.self+'.checkErrors()')}else{var current_error_handler=this.opt.self;$(document).ready(function(){var current_error=eval(current_error_handler);$('#'+current_error.opt.editor_id).data("sceditor").addEvent(current_error.opt.editor_id,'keyup',function(){current_error.checkErrors()})})}};errorbox_handler.prototype.boxVal=function(){if(this.evaluate===false){return this.oChecks_on.val()}else return this.oChecks_on()};errorbox_handler.prototype.checkErrors=function(){var num=this.opt.error_checks.length;if(num!==0){for(var i=0;i<num;i++){var $elem=$(document.getElementById(this.opt.error_box_id+"_"+this.opt.error_checks[i].code));if(this.opt.error_checks[i].efunction(this.boxVal())){this.addError($elem,this.opt.error_checks[i].code)}else this.removeError(this.oError_box,$elem)};this.oError_box.attr("class","noticebox")};if(this.oError_box.find("li").length===0){this.oError_box.slideUp()}else this.oError_box.slideDown()};errorbox_handler.prototype.addError=function(error_elem,error_code){if(error_elem.length===0){if($.trim(this.oError_box.children("#"+this.opt.error_box_id+"_list").html())==='')this.oError_box.append("<ul id='"+this.opt.error_box_id+"_list'></ul>");$(document.getElementById(this.opt.error_box_id+"_list")).append("<li style=\"display:none\" id='"+this.opt.error_box_id+"_"+error_code+"' class='error'>"+error_txts[error_code]+"</li>");$(document.getElementById(this.opt.error_box_id+"_"+error_code)).slideDown()}};errorbox_handler.prototype.removeError=function(error_box,error_elem){if(error_elem.length!==0)error_elem.slideUp(function(){error_elem.remove();if(error_box.find("li").length===0)error_box.slideUp()})}
function addAnotherOption(parent,oDtName,oDdName,oData){oDtName.type=oDtName.type||'text';oDtName['class']=oDtName['class']||'input_text';oDtName.size=oDtName.size||'20';oDdName.type=oDdName.type||'text';oDdName['class']=oDdName['class']||'input_text';oDdName.size=oDdName.size||'20';oData=oData||'';var newDT=document.createElement('dt'),newInput=document.createElement('input');newInput.name=oDtName.name;newInput.type=oDtName.type;newInput.setAttribute('class',oDtName['class']);newInput.size=oDtName.size;newDT.appendChild(newInput);var newDD=document.createElement('dd');if(oData===''){newInput=document.createElement('input')}else newInput=document.createElement('select');newInput.name=oDdName.name;newInput.type=oDdName.type;newInput.size=oDdName.size;newInput.setAttribute('class',oDdName['class']);newDD.appendChild(newInput);if(oData!==''){var opt=null,key=null,obj={};for(key in oData){obj=oData[key];opt=document.createElement("option");opt.name="option";opt.value=obj.id;opt.innerHTML=obj.name;newInput.appendChild(opt)}};var placeHolder=document.getElementById(parent);placeHolder.parentNode.insertBefore(newDT,placeHolder);placeHolder.parentNode.insertBefore(newDD,placeHolder)};$(document).ready(function(){if(use_click_menu){$('#main_menu, ul.admin_menu, ul.sidebar_menu, ul.poster, ul.quickbuttons, #sort_by').superclick({speed:150,animation:{opacity:'show',height:'toggle'}})}else $('#main_menu, ul.admin_menu, ul.sidebar_menu, ul.poster, ul.quickbuttons, #sort_by').superfish({delay:300,speed:175});$("a[href=#top]").on("click",function(e){e.preventDefault();$("html,body").animate({scrollTop:0},1200)});$("a[href=#bot]").on("click",function(e){e.preventDefault();var link=$('#bot'),link_y=link.height();$("html,body").animate({scrollTop:link.offset().top+link_y-$(window).height()},1200)});$('.preview').SiteTooltip({hoverIntent:{sensitivity:10,interval:750,timeout:50}});$('a.bbc_link img.bbc_img').parent().css('border','0');if(typeof elk_codefix==='function')elk_codefix();$('.expand_pages').expand_pages();$('legend').click(function(){$(this).siblings().slideToggle("fast");$(this).parent().toggleClass("collapsed")}).each(function(){if($(this).data('collapsed')){$(this).siblings().css({display:"none"});$(this).parent().toggleClass("collapsed")}});$('.spoilerheader').click(function(){$(this).next().children().slideToggle("fast")});$('img').each(function(){if($(this).hasClass('bbc_img resized')===false)return true;$(this).css({cursor:'pointer'});$(this).click(function(){var $this=$(this);if($.isEmptyObject($this.data())){$this.data("bbc_img",{width:$this.css('width'),height:$this.css('height')});$this.css({width:$this.css('width')==='auto'?null:'auto'});$this.css({height:$this.css('width')==='auto'?null:'auto'})}else{$this.css({width:$this.data("bbc_img").width});$this.css({height:$this.data("bbc_img").height});$this.removeData()}})})})
function elk_addButton(sButtonStripId,bUseImage,oOptions){var oButtonStrip=document.getElementById(sButtonStripId),aItems=oButtonStrip.getElementsByTagName('span');if(aItems.length>0){var oLastSpan=aItems[aItems.length-1];oLastSpan.className=oLastSpan.className.replace(/\s*last/,'position_holder')};var oButtonStripList=oButtonStrip.getElementsByTagName('ul')[0],oNewButton=document.createElement('li'),oRole=document.createAttribute('role');oRole.value='menuitem';oNewButton.setAttributeNode(oRole);if('sId'in oOptions)oNewButton.id=oOptions.sId;oNewButton.innerHTML='<a class="linklevel1" href="'+oOptions.sUrl+'" '+('sCustom'in oOptions?oOptions.sCustom:'')+'><span class="last"'+('sId'in oOptions?' id="'+oOptions.sId+'_text"':'')+'>'+oOptions.sText+'</span></a>';oButtonStripList.appendChild(oNewButton)}
function loadAddNewPoll(button,id_board,form_name){if(typeof id_board=='undefined')return true;var $form=$('#post_header').closest("form");if($(button).val()==poll_add){$(button).val(poll_remove);if($('#icon').val()=='xx')$('#icon').val('poll').change();$form.attr('action',$form.attr('action')+';poll');if($('#poll_main').length>0){$('#poll_main, #poll_options').find('input').each(function(){if($(this).data('required')=='required')$(this).attr('required','required')});$('#poll_main, #poll_options').toggle();return false}}else{if($('#icon').val()=='poll')$('#icon').val('xx').change();$form.attr('action',$form.attr('action').replace(';poll',''));$('#poll_main, #poll_options').hide().find('input').each(function(){if($(this).attr('required')=='required'){$(this).data('required','required');$(this).removeAttr('required')}});$(button).val(poll_add);return false};$.ajax({url:elk_scripturl+'?action=poll;sa=interface;xml;board='+id_board,type:"GET",dataType:"html",beforeSend:ajax_indicator(true)}).done(function(data,textStatus,xhr){var max_tabIndex=0;for(var i=0,n=document.forms[form_name].elements.length;i<n;i++)max_tabIndex=Math.max(max_tabIndex,document.forms[form_name].elements[i].tabIndex);$('#post_header').after(data);$('#poll_main input, #poll_options input').each(function(){$(this).attr('tabindex',++max_tabIndex)});$('#poll_main legend, #poll_options legend').click(function(){$(this).siblings().slideToggle("fast");$(this).parent().toggleClass("collapsed")}).each(function(){if($(this).data('collapsed')){$(this).siblings().css({display:"none"});$(this).parent().toggleClass("collapsed")}})}).always(function(){ajax_indicator(false)});return false}
function elk_NewsFader(oOptions){var aFaderItems=oOptions.aFaderItems||[],iFadeIndex=0,iFadeDelay=oOptions.iFadeDelay||5e3,iFadeSpeed=oOptions.iFadeSpeed||650,sItemTemplate=oOptions.sItemTemplate||'%1$s',sControlId='#'+oOptions.sFaderControlId,fadeIn=function(){iFadeIndex++;if(iFadeIndex>=aFaderItems.length)iFadeIndex=0;$(sControlId+' li').html(sItemTemplate.replace('%1$s',aFaderItems[iFadeIndex])).fadeTo(iFadeSpeed,0.99,function(){this.style.filter='';fadeOut()})},fadeOut=function(){setTimeout(function(){$(sControlId+' li').fadeTo(iFadeSpeed,0,fadeIn)},iFadeDelay)};if(!aFaderItems.length)$(sControlId+' li').each(function(){aFaderItems.push($(this).html())});$(sControlId).html('<li>'+sItemTemplate.replace('%1$s',aFaderItems[0])+'</li>');fadeOut()}