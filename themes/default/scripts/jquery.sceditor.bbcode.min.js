/* SCEditor v1.4.6 | (C) 2011-2013, Sam Clarke | sceditor.com/license */
(function(e,t,n){"use strict";var r=e.sceditor.escapeEntities;var i=e.sceditor.escapeUriScheme;var s=e.sceditor.ie;var o=s&&s<11;e.sceditor.BBCodeParser=function(t){if(!(this instanceof e.sceditor.BBCodeParser))return new e.sceditor.BBCodeParser(t);var i=this;var u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;var S={open:"open",content:"content",newline:"newline",close:"close"};var x=function(e,t,n,r,i,s){var o=this;o.type=e;o.name=t;o.val=n;o.attrs=r||{};o.children=i||[];o.closing=s||null};x.prototype={clone:function(e){var t=this;return new x(t.type,t.name,t.val,t.attrs,e?t.children:[],t.closing?t.closing.clone():null)},splitAt:function(t){var n,r=this,i=0,s=r.children.length;if(typeof t!=="number")t=e.inArray(t,r.children);if(t<0||t>s)return null;while(s--){if(s>=t)i++;else s=0}n=r.clone();n.children=r.children.splice(t,i);return n}};u=function(){i.opts=e.extend({},e.sceditor.BBCodeParser.defaults,t);i.bbcodes=e.sceditor.plugins.bbcode.bbcodes};i.tokenize=function(e){var t,n,r,i=[],s=[{type:"close",regex:/^\[\/[^\[\]]+\]/},{type:"open",regex:/^\[[^\[\]]+\]/},{type:"newline",regex:/^(\r\n|\r|\n)/},{type:"content",regex:/^([^\[\r\n]+|\[)/}];s.reverse();e:while(e.length){r=s.length;while(r--){n=s[r].type;if(!(t=e.match(s[r].regex))||!t[0])continue;i.push(a(n,t[0]));e=e.substr(t[0].length);continue e}if(e.length)i.push(a(S.content,e));e=""}return i};a=function(t,n){var r,i,s;if(t==="open"&&(r=n.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/))){s=w(r[1]);if(r[2]&&(r[2]=e.trim(r[2])))i=f(r[2])}else if(t==="close"&&(r=n.match(/\[\/([^\[\]]+)\]/)))s=w(r[1]);else if(t==="newline")s="#newline";if(!s||(t==="open"||t==="close")&&!e.sceditor.plugins.bbcode.bbcodes[s]){t="content";s="#"}return new x(t,s,n,i)};f=function(t){var n,r=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,i=e.sceditor.plugins.bbcode.stripQuotes,s={};if(t.charAt(0)==="="&&t.indexOf("=",1)<0)s.defaultattr=i(t.substr(1));else{if(t.charAt(0)==="=")t="defaultattr"+t;while(n=r.exec(t))s[w(n[1])]=i(n[3])||n[4]}return s};i.parse=function(e,t){var n=l(i.tokenize(e));if(i.opts.fixInvalidChildren)v(n);if(i.opts.removeEmptyTags)d(n);if(i.opts.fixInvalidNesting)h(n);c(n,null,t);if(i.opts.removeEmptyTags)d(n);return n};y=function(e,t,n){var r=n.length;while(r--)if(n[r].type===t&&n[r].name===e)return true;return false};p=function(t,n){var r=t?i.bbcodes[t.name]:null,s=r?r.allowedChildren:null;if(!i.opts.fixInvalidChildren||!s)return true;if(s&&e.inArray(n.name||"#",s)<0)return false;return true};l=function(t){var n,r,s,o,u,a,f,l=[],c=[],h=[],p=function(){return E(h)},d=function(e){if(p())p().children.push(e);else c.push(e)},v=function(t){return p()&&(r=i.bbcodes[p().name])&&r.closedBy&&e.inArray(t,r.closedBy)>-1};while(n=t.shift()){f=t[0];switch(n.type){case S.open:if(v(n.name))h.pop();d(n);r=i.bbcodes[n.name];if((!r||!r.isSelfClosing)&&(r.closedBy||y(n.name,S.close,t)))h.push(n);else if(!r||!r.isSelfClosing)n.type=S.content;break;case S.close:if(p()&&n.name!==p().name&&v("/"+n.name))h.pop();if(p()&&n.name===p().name){p().closing=n;h.pop()}else if(y(n.name,S.open,h)){while(s=h.pop()){if(s.name===n.name){s.closing=n;break}o=s.clone();if(l.length>1)o.children.push(E(l));l.push(o)}d(E(l));u=l.length;while(u--)h.push(l[u]);l.length=0}else{n.type=S.content;d(n)}break;case S.newline:if(p()&&f&&v((f.type===S.close?"/":"")+f.name)){if(!(f.type===S.close&&f.name===p().name)){r=i.bbcodes[p().name];if(r&&r.breakAfter)h.pop();else if(r&&r.isInline===false&&i.opts.breakAfterBlock&&r.breakAfter!==false)h.pop()}}d(n);break;default:d(n);break}a=n}return c};c=function(e,t,n){var r,s,o,u,a,f,l,h,p=e.length,d=p;if(t)u=i.bbcodes[t.name];while(d--){if(!(r=e[d]))continue;if(r.type===S.newline){s=d>0?e[d-1]:null;o=d<p-1?e[d+1]:null;h=false;if(!n&&u&&u.isSelfClosing!==true){if(!s){if(u.isInline===false&&i.opts.breakStartBlock&&u.breakStart!==false)h=true;if(u.breakStart)h=true}else if(!f&&!o){if(u.isInline===false&&i.opts.breakEndBlock&&u.breakEnd!==false)h=true;if(u.breakEnd)h=true;f=h}}if(s&&s.type===S.open){if(a=i.bbcodes[s.name]){if(!n){if(a.isInline===false&&i.opts.breakAfterBlock&&a.breakAfter!==false)h=true;if(a.breakAfter)h=true}else if(a.isInline===false)h=true}}if(!n&&!l&&o&&o.type===S.open){if(a=i.bbcodes[o.name]){if(a.isInline===false&&i.opts.breakBeforeBlock&&a.breakBefore!==false)h=true;if(a.breakBefore)h=true;l=h;if(h){e.splice(d,1);continue}}}if(h)e.splice(d,1);l=false}else if(r.type===S.open)c(r.children,r,n)}};h=function(t,n,r,s){var o,u,a,f,l,c,p=function(e){var t=i.bbcodes[e.name];return!t||t.isInline!==false};n=n||[];s=s||t;for(u=0;u<t.length;u++){if(!(o=t[u])||o.type!==S.open)continue;if(!p(o)&&r){a=E(n);c=a.splitAt(o);l=n.length>1?n[n.length-2].children:s;if((f=e.inArray(a,l))>-1){c.children.splice(e.inArray(o,c.children),1);l.splice(f+1,0,o,c);return}}n.push(o);h(o.children,n,r||p(o),s);n.pop(o)}};v=function(e,t){var n,r,i=e.length;while(i--){if(!(n=e[i]))continue;if(!p(t,n)){n.name=null;n.type=S.content;if(p(t,n)){r=[i+1,0].concat(n.children);if(n.closing){n.closing.name=null;n.closing.type=S.content;r.push(n.closing)}i+=r.length-1;Array.prototype.splice.apply(e,r)}else t.children.splice(i,1)}if(n.type===S.open)v(n.children,n)}};d=function(t){var n,r,s,o=t.length;s=function(e){var t=e.length;while(t--){if(e[t].type===S.open)return false;if(e[t].type===S.close)return false;if(e[t].type===S.content&&e[t].val&&/\S|\u00A0/.test(e[t].val))return false}return true};while(o--){if(!(n=t[o])||n.type!==S.open)continue;r=i.bbcodes[n.name];d(n.children);if(s(n.children)&&r&&!r.isSelfClosing&&!r.allowsEmpty)t.splice.apply(t,e.merge([o,1],n.children))}};i.toHTML=function(e,t){return m(i.parse(e,t),true)};m=function(t,u){var a,f,l,c,h,p,d,v,g=[];d=function(e){return(!e||(typeof e.isHtmlInline!=="undefined"?e.isHtmlInline:e.isInline))!==false};while(t.length>0){if(!(a=t.shift()))continue;if(a.type===S.open){v=a.children[a.children.length-1]||{};f=i.bbcodes[a.name];h=u&&d(f);l=m(a.children,false);if(f&&f.html){if(!d(f)&&d(i.bbcodes[v.name])&&!f.isPreFormatted&&!f.skipLastLineBreak){if(!o)l+="<br />"}if(!e.isFunction(f.html)){a.attrs["0"]=l;c=e.sceditor.plugins.bbcode.formatBBCodeString(f.html,a.attrs)}else c=f.html.call(i,a,a.attrs,l)}else c=a.val+l+(a.closing?a.closing.val:"")}else if(a.type===S.newline){if(!u){g.push("<br />");continue}if(!p){g.push("<div>");if(n.documentMode&&n.documentMode<8||s<8)g.push(" ")}if(!o)g.push("<br />");if(!t.length)g.push("<br />");g.push("</div>\n");p=false;continue}else{h=u;c=r(a.val,true)}if(h&&!p){g.push("<div>");p=true}else if(!h&&p){g.push("</div>\n");p=false}g.push(c)}if(p)g.push("</div>\n");return g.join("")};i.toBBCode=function(e,t){return g(i.parse(e,t))};g=function(t){var n,r,s,o,u,a,f,l,c,h,p=[];while(t.length>0){if(!(n=t.shift()))continue;s=i.bbcodes[n.name];o=!(!s||s.isInline!==false);u=s&&s.isSelfClosing;f=o&&i.opts.breakBeforeBlock&&s.breakBefore!==false||s&&s.breakBefore;l=o&&!u&&i.opts.breakStartBlock&&s.breakStart!==false||s&&s.breakStart;c=o&&i.opts.breakEndBlock&&s.breakEnd!==false||s&&s.breakEnd;h=o&&i.opts.breakAfterBlock&&s.breakAfter!==false||s&&s.breakAfter;a=(s?s.quoteType:null)||i.opts.quoteType||e.sceditor.BBCodeParser.QuoteType.auto;if(!s&&n.type===S.open){p.push(n.val);if(n.children)p.push(g(n.children));if(n.closing)p.push(n.closing.val)}else if(n.type===S.open){if(f)p.push("\n");p.push("["+n.name);if(n.attrs){if(n.attrs.defaultattr){p.push("="+b(n.attrs.defaultattr,a,"defaultattr"));delete n.attrs.defaultattr}for(r in n.attrs)if(n.attrs.hasOwnProperty(r))p.push(" "+r+"="+b(n.attrs[r],a,r))}p.push("]");if(l)p.push("\n");if(n.children)p.push(g(n.children));if(!u&&!s.excludeClosing){if(c)p.push("\n");p.push("[/"+n.name+"]")}if(h)p.push("\n");if(n.closing&&u)p.push(n.closing.val)}else p.push(n.val)}return p.join("")};b=function(t,n,r){var i=e.sceditor.BBCodeParser.QuoteType,s=/\s|=/.test(t);if(e.isFunction(n))return n(t,r);if(n===i.never||n===i.auto&&!s)return t;return'"'+t.replace("\\","\\\\").replace('"','\\"')+'"'};E=function(e){if(e.length)return e[e.length-1];return null};w=function(e){return e.toLowerCase()};u()};e.sceditor.BBCodeParser.QuoteType={always:1,never:2,auto:3};e.sceditor.BBCodeParser.defaults={breakBeforeBlock:false,breakStartBlock:false,breakEndBlock:false,breakAfterBlock:true,removeEmptyTags:true,fixInvalidNesting:true,fixInvalidChildren:true,quoteType:e.sceditor.BBCodeParser.QuoteType.auto};e.sceditorBBCodePlugin=e.sceditor.plugins.bbcode=function(){var t=this;var r,i,s,u,a,f;u=e.sceditor.plugins.bbcode.formatString;t.bbcodes=e.sceditor.plugins.bbcode.bbcodes;t.stripQuotes=e.sceditor.plugins.bbcode.stripQuotes;var l={};var c={};var h={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]};t.init=function(){t.opts=this.opts;r();a(this);this.toBBCode=t.signalToSource;this.fromBBCode=t.signalToWysiwyg};a=function(t){var n=e.sceditor.command.get;var r={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(e){var t=this;n("font")._dropDown(t,e,function(e){t.insertText("[font="+e+"]","[/font]")})}},size:{txtExec:function(e){var t=this;n("size")._dropDown(t,e,function(e){t.insertText("[size="+e+"]","[/size]")})}},color:{txtExec:function(e){var t=this;n("color")._dropDown(t,e,function(e){t.insertText("[color="+e+"]","[/color]")})}},bulletlist:{txtExec:function(n,r){var i="";e.each(r.split(/\r?\n/),function(){i+=(i?"\n":"")+"[li]"+this+"[/li]"});t.insertText("[ul]\n"+i+"\n[/ul]")}},orderedlist:{txtExec:function(n,r){var i="";e.each(r.split(/\r?\n/),function(){i+=(i?"\n":"")+"[li]"+this+"[/li]"});e.sceditor.plugins.bbcode.bbcode.get("");t.insertText("[ol]\n"+i+"\n[/ol]")}},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(e,t){var n=prompt(this._("Enter the image URL:"),t);if(n)this.insertText("[img]"+n+"[/img]")}},email:{txtExec:function(e,t){var n=t&&t.indexOf("@")>-1?null:t,r=prompt(this._("Enter the e-mail address:"),n?"":t),i=prompt(this._("Enter the displayed text:"),n||r)||r;if(r)this.insertText("[email="+r+"]"+i+"[/email]")}},link:{txtExec:function(t,n){var r=/^[a-z]+:\/\//i.test(e.trim(n))?null:n,i=prompt(this._("Enter URL:"),r?"http://":e.trim(n)),s=prompt(this._("Enter the displayed text:"),r||i)||i;if(i)this.insertText("[url="+i+"]"+s+"[/url]")}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(e){var t=this;n("youtube")._dropDown(t,e,function(e){t.insertText("[youtube]"+e+"[/youtube]")})}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}};t.commands=e.extend(true,{},r,t.commands)};r=function(){e.each(t.bbcodes,function(n){if(t.bbcodes[n].tags)e.each(t.bbcodes[n].tags,function(e,r){var i=t.bbcodes[n].isInline===false;l[e]=l[e]||{};l[e][i]=l[e][i]||{};l[e][i][n]=r});if(t.bbcodes[n].styles)e.each(t.bbcodes[n].styles,function(e,r){var i=t.bbcodes[n].isInline===false;c[i]=c[i]||{};c[i][e]=c[i][e]||{};c[i][e][n]=r})})};i=function(n,r,i){var s,o,a=e.sceditor.dom.getStyle;i=!!i;if(!c[i])return r;e.each(c[i],function(i,f){s=a(n[0],i);if(!s||a(n.parent()[0],i)===s)return;e.each(f,function(i,a){if(!a||e.inArray(s.toString(),a)>-1){o=t.bbcodes[i].format;if(e.isFunction(o))r=o.call(t,n,r);else r=u(o,r)}})});return r};s=function(n,r,i){var s,a,f=n[0],c=f.nodeName.toLowerCase();i=!!i;if(l[c]&&l[c][i]){e.each(l[c][i],function(i,o){if(o){s=false;e.each(o,function(t,r){if(!n.attr(t)||r&&e.inArray(n.attr(t),r)<0)return;s=true;return false});if(!s)return}a=t.bbcodes[i].format;if(e.isFunction(a))r=a.call(t,n,r);else r=u(a,r)})}var h=e.sceditor.dom.isInline;if(i&&(!h(f,true)||c==="br")){var p=f.parentNode,d=p.lastChild,v=f.previousSibling,m=h(p,true);while(v&&(e(v).hasClass("sceditor-ignore")||v.nodeType===1&&h(v,true)&&!v.firstChild)){v=v.previousSibling}while(e(d).hasClass("sceditor-ignore"))d=d.previousSibling;if(m||d!==f||c==="li"||c==="br"&&o)r+="\n";if("br"!==c&&v&&v.nodeName.toLowerCase()!=="br"&&h(v,true))r="\n"+r}return r};t.signalToSource=function(r,i){var s,o,u=new e.sceditor.BBCodeParser(t.opts.parserOptions);if(!i){if(typeof r==="string"){s=e("<div />").css("visibility","hidden").appendTo(n.body).html(r);i=s}else i=e(r)}if(!i||!i.jquery)return"";e.sceditor.dom.removeWhiteSpace(i[0]);o=t.elementToBbcode(i);if(s)s.remove();o=u.toBBCode(o,true);if(t.opts.bbcodeTrim)o=e.trim(o);return o};t.elementToBbcode=function(t){return function n(t,r){var u="";e.sceditor.dom.traverse(t,function(t){var a=e(t),f="",l=t.nodeType,c=t.nodeName.toLowerCase(),p=h[c],d=t.firstChild,v=true;if(typeof r==="object"){v=e.inArray(c,r)>-1;if(a.is("img")&&a.data("sceditor-emoticon"))v=true;if(!v)p=r}if(l!==3&&l!==1)return;if(l===1){if(a.hasClass("sceditor-ignore"))return;if(a.hasClass("sceditor-nlf")){if(!d||!o&&t.childNodes.length===1&&/br/i.test(d.nodeName)){return}}if(c!=="iframe")f=n(t,p);if(v){if(c!=="code"){f=i(a,f);f=s(a,f);f=i(a,f,true)}u+=s(a,f,true)}else u+=f}else if(t.wholeText&&(!t.previousSibling||t.previousSibling.nodeType!==3)){if(a.parents("code").length===0)u+=t.wholeText.replace(/ +/g," ");else u+=t.wholeText}else if(!t.wholeText)u+=t.nodeValue},false,true);return u}(t[0])};t.signalToWysiwyg=function(n,r){var i=new e.sceditor.BBCodeParser(t.opts.parserOptions),s=i.toHTML(t.opts.bbcodeTrim?e.trim(n):n);return r?f(s):s};f=function(t){var r,i,s,u=e("<div />").hide().appendTo(n.body),a=u[0];s=function(t,r){if(e.sceditor.dom.hasStyling(t))return;if(o||t.childNodes.length!==1||!e(t.firstChild).is("br")){while(i=t.firstChild)a.insertBefore(i,t)}if(r){var s=a.lastChild;if(t!==s&&e(s).is("div")&&t.nextSibling===s)a.insertBefore(n.createElement("br"),t)}a.removeChild(t)};a.innerHTML=t.replace(/<\/div>\n/g,"</div>");if((r=a.firstChild)&&e(r).is("div"))s(r,true);if((r=a.lastChild)&&e(r).is("div"))s(r);a=a.innerHTML;u.remove();return a}};e.sceditor.plugins.bbcode.stripQuotes=function(e){return e?e.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2"):e};e.sceditor.plugins.bbcode.formatString=function(){var e,t=arguments;return t[0].replace(/\{(\d+)\}/g,function(n,r){return t[r-0+1]!==e?t[r-0+1]:"{"+r+"}"})};e.sceditor.plugins.bbcode.formatBBCodeString=function(e,t){return e.replace(/\{(!?[^}]+)\}/g,function(e,n){var i,s=true;if(n[0]==="!"){s=false;n=n.substring(1)}if(n[0]==="0")s=false;if(t[n]===i)return e;return s?r(t[n],true):t[n]})};var u=e.sceditor.plugins.bbcode.normaliseColour=function(e){var t,n;n=function(e){e=parseInt(e,10);if(isNaN(e))return"00";e=Math.max(0,Math.min(e,255)).toString(16);return e.length<2?"0"+e:e};e=e||"#000";if(t=e.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))return"#"+n(t[1])+n(t[2]-0)+n(t[3]-0);if(t=e.match(/#([0-f])([0-f])([0-f])\s*?$/i))return"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3];return e};e.sceditor.plugins.bbcode.bbcodes={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n;if(e[0].nodeName.toLowerCase()!=="font"||!(n=e.attr("face")))n=e.css("font-family");return"[font="+this.stripQuotes(n)+"]"+t+"[/font]"},html:'<font face="{defaultattr}">{0}</font>'},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(e,t){var n=e.attr("size"),r=2;if(!n)n=e.css("fontSize");if(n.indexOf("px")>-1){n=n.replace("px","")-0;if(n<12)r=1;if(n>15)r=3;if(n>17)r=4;if(n>23)r=5;if(n>31)r=6;if(n>47)r=7}else r=n;return"[size="+r+"]"+t+"[/size]"},html:'<font size="{defaultattr}">{!0}</font>'},color:{tags:{font:{color:null}},styles:{color:null},quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n,r=e[0];if(r.nodeName.toLowerCase()!=="font"||!(n=e.attr("color")))n=r.style.color||e.css("color");return"[color="+u(n)+"]"+t+"[/color]"},html:function(e,t,n){return'<font color="'+r(u(t.defaultattr),true)+'">'+n+"</font>"}},ul:{tags:{ul:null},breakStart:true,isInline:false,skipLastLineBreak:true,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:true,isInline:false,skipLastLineBreak:true,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:true,isInline:false,skipLastLineBreak:true,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:false,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:false,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:false,isHtmlInline:true,skipLastLineBreak:true,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:false,skipLastLineBreak:true,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:true,isInline:false,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:true,isInline:false,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:true,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(e,t){return e.data("sceditor-emoticon")+t},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:true,isSelfClosing:true,isInline:false,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:true,tags:{img:{src:null}},allowedChildren:["#"],quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n,r,i="",s=e[0],o=function(e){return s.style?s.style[e]:null};if(e.attr("data-sceditor-emoticon"))return t;n=e.attr("width")||o("width");r=e.attr("height")||o("height");if(s.complete&&(n||r)||n&&r)i="="+e.width()+"x"+e.height();return"[img"+i+"]"+e.attr("src")+"[/img]"},html:function(e,t,n){var s,o,u,a,f="";if(t.width!==s)o=t.width;if(t.height!==s)u=t.height;if(t.defaultattr){a=t.defaultattr.split(/x/i);o=a[0];u=a.length===2?a[1]:a[0]}if(o!==s)f+=' width="'+r(o,true)+'"';if(u!==s)f+=' height="'+r(u,true)+'"';return"<img"+f+' src="'+i(n)+'" />'}},url:{allowsEmpty:true,tags:{a:{href:null}},quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(e,t){var n=e.attr("href");if(n.substr(0,7)==="mailto:")return'[email="'+n.substr(7)+'"]'+t+"[/email]";return"[url="+n+"]"+t+"[/url]"},html:function(e,t,n){t.defaultattr=r(t.defaultattr,true)||n;return'<a href="'+i(t.defaultattr)+'">'+n+"</a>"}},email:{quoteType:e.sceditor.BBCodeParser.QuoteType.never,html:function(e,t,n){return'<a href="mailto:'+(r(t.defaultattr,true)||n)+'">'+n+"</a>"}},quote:{tags:{blockquote:null},isInline:false,quoteType:e.sceditor.BBCodeParser.QuoteType.never,format:function(t,n){var r="",i=e(t),s=i.children("cite").first();if(s.length===1||i.data("author")){r=s.text()||i.data("author");i.data("author",r);s.remove();n=this.elementToBbcode(e(t));r="="+r;i.prepend(s)}return"[quote"+r+"]"+n+"[/quote]"},html:function(e,t,n){if(t.defaultattr)n="<cite>"+r(t.defaultattr)+"</cite>"+n;return"<blockquote>"+n+"</blockquote>"}},code:{tags:{code:null},isInline:false,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:false,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:false,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:false,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:false,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:true,tags:{iframe:{"data-youtube-id":null}},format:function(e,t){e=e.attr("data-youtube-id");return e?"[youtube]"+e+"[/youtube]":t},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque'+'" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}};e.sceditor.plugins.bbcode.bbcode={get:function(t){return e.sceditor.plugins.bbcode.bbcodes[t]||null},set:function(t,n){var r=e.sceditor.plugins.bbcode.bbcodes;if(!t||!n)return false;n=e.extend(r[t]||{},n);n.remove=function(){delete r[t]};r[t]=n;return this},rename:function(t,n){var r=e.sceditor.plugins.bbcode.bbcodes;if(t in r){r[n]=r[t];delete r[t]}else return false;return this},remove:function(t){var n=e.sceditor.plugins.bbcode.bbcodes;if(t in n)delete n[t];return this}};e.fn.sceditorBBCodePlugin=function(t){t=t||{};if(e.isPlainObject(t))t.plugins=(t.plugins?t.plugins:"")+"bbcode";return this.sceditor(t)}})(jQuery,window,document);